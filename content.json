{"meta":{"title":"å­™ç¥çš„åšå®¢","subtitle":null,"description":null,"author":"å­™ç¥","url":"https://sensitivemix.github.io"},"pages":[{"title":"404 Not Foundï¼šè¯¥é¡µæ— æ³•æ˜¾ç¤º","date":"2019-04-14T02:29:42.000Z","updated":"2019-04-14T02:29:42.000Z","comments":false,"path":"/404.html","permalink":"https://sensitivemix.github.io//404.html","excerpt":"","text":""},{"title":"å…³äº","date":"2019-04-14T02:29:42.000Z","updated":"2019-04-14T02:29:42.000Z","comments":false,"path":"about/index.html","permalink":"https://sensitivemix.github.io/about/index.html","excerpt":"","text":"åç«¯å·¥ç¨‹å¸ˆä¸€æšï¼Œç›®å‰åœ¨åš Node.js æœåŠ¡ç«¯å¼€å‘ã€‚"},{"title":"åˆ†ç±»","date":"2019-04-14T02:29:42.000Z","updated":"2019-04-14T02:29:42.000Z","comments":false,"path":"categories/index.html","permalink":"https://sensitivemix.github.io/categories/index.html","excerpt":"","text":""},{"title":"Repositories","date":"2019-04-14T02:29:42.000Z","updated":"2019-04-14T02:29:42.000Z","comments":false,"path":"repository/index.html","permalink":"https://sensitivemix.github.io/repository/index.html","excerpt":"","text":""},{"title":"ä¹¦å•","date":"2019-04-14T02:29:42.000Z","updated":"2019-04-14T02:29:42.000Z","comments":false,"path":"books/index.html","permalink":"https://sensitivemix.github.io/books/index.html","excerpt":"","text":""},{"title":"å‹æƒ…é“¾æ¥","date":"2019-04-14T02:29:42.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"links/index.html","permalink":"https://sensitivemix.github.io/links/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2019-04-14T02:29:42.000Z","updated":"2019-04-14T02:29:42.000Z","comments":false,"path":"tags/index.html","permalink":"https://sensitivemix.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"å¦‚ä½•ä¹¦å†™ Node DEV API æ–‡æ¡£ ","slug":"å¦‚ä½•ä¹¦å†™-Node-DEV-API-æ–‡æ¡£","date":"2019-04-16T09:02:20.000Z","updated":"2019-04-16T09:03:02.000Z","comments":true,"path":"2019/04/16/å¦‚ä½•ä¹¦å†™-Node-DEV-API-æ–‡æ¡£/","link":"","permalink":"https://sensitivemix.github.io/2019/04/16/å¦‚ä½•ä¹¦å†™-Node-DEV-API-æ–‡æ¡£/","excerpt":"","text":"ä¸ºä»€ä¹ˆéœ€è¦ API æ–‡æ¡£ç›®å‰å¤§çš„ç¯å¢ƒä¸‹é¢ï¼ŒåŸºæœ¬æœåŠ¡éƒ½ä»¥å•ä½“æœåŠ¡è½¬æ¢æˆå‰åç«¯åˆ†ç¦»çš„æœåŠ¡ï¼Œå®¢æˆ·ç«¯ä½œä¸ºè°ƒç”¨æ–¹ï¼ŒæœåŠ¡ç«¯ä½œä¸ºæä¾›æ–¹éœ€è¦ç»™äºˆåˆ°è°ƒç”¨æ–¹é€šä¿—æ˜“æ‡‚çš„æ–‡æ¡£ã€‚ å¸¸è§ API æ–‡æ¡£æœ‰å“ªäº› gitbook Modern documentation format and toolchain using Git and Markdown Usage ä¼˜ç‚¹ï¼š ç±»ä¼¼ä¹¦ç±çš„ç®¡ç†æ–¹å¼ï¼ˆé€‚åˆå†™ä¹¦ï¼‰ æ”¯æŒå¤šäººåä½œï¼Œæ”¯æŒä¿å­˜åœ¨ Github ä¸­ æ”¯æŒ Build æˆé™æ€ç½‘é¡µï¼Œéƒ¨ç½²æ–¹ä¾¿ ç¼ºç‚¹ï¼š éœ€è¦ç†Ÿæ‚‰ Markdown è¯­æ³•ï¼Œä¸æ˜¯å®æ—¶ç”Ÿæˆï¼Œéœ€è¦ä½¿ç”¨ Git-cli æ‰“åŒ…æ–‡ä»¶ ä»¥ä¸€æœ¬ä¹¦ç±ä½œä¸ºèµ·ç‚¹ï¼Œåªèƒ½æ”¾åˆ°å•ä¸ªé¡¹ç›®ä¸­ æ€»ç»“ï¼šé€‚åˆå†™ä¹¦ç±ï¼Œä¸å¤ªé€‚åˆ API å¼€å‘æ–‡æ¡£ jsdoc An API documentation generator for JavaScript. Usage ä¼˜ç‚¹ï¼š åŠŸèƒ½ä¸°å¯Œï¼Œæ”¯æŒå¼•å…¥å—çŠ¶æ³¨é‡Šï¼ˆBlock Tagsï¼‰ åŠŸèƒ½ä¸°å¯Œï¼Œæ”¯æŒå†…è”æ³¨é‡Šï¼ˆInline Tagsï¼‰ å¼ºå¤§çš„ç¤¾åŒºæ”¯æŒï¼Œå„ä¸ªå¹³å°æ”¯æŒ jsdocs æ’ä»¶ ç¼ºç‚¹ï¼š æœ‰ä¸€å®šçš„å­¦ä¹ æˆæœ¬ï¼Œéœ€è¦å­¦ä¹ å®ƒçš„å—çŠ¶æ³¨é‡Šä½¿ç”¨æ–¹å¼ UI åªèƒ½å•é¡¹ç›®ä½¿ç”¨ï¼Œæ¯ä¸ªé¡¹ç›®çš„ DOC UI ç‹¬ç«‹ åœ¨çº¿æ ·ä¾‹ï¼ˆbetter-docs tui-jsdoc-template) æ€»ç»“ï¼šé€‚åˆæ·±åº¦å®šåˆ¶é¡¹ç›®ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬å¯¹å¤–å¼€æ”¾ API ç»™å¼€å‘è€…ä½¿ç”¨ã€‚ swagger-jsdoc Generates swagger doc based on JSDoc. Usage ä¼˜ç‚¹ï¼š é›†åˆ Swaggerï¼Œæ”¯æŒæŒ‰ç…§ç±»ä¼¼ JSDoc æ–¹å¼ç”Ÿæˆæ–‡æ¡£ æ”¯æŒé”™è¯¯å®šä½ï¼Œå¦‚æœæ³¨é‡Šä¹¦å†™é”™è¯¯ï¼Œèƒ½å¤ŸæŠ›å‡ºå…·ä½“çš„é”™è¯¯æ ˆ æ”¯æŒ CLIï¼Œè‡ªç”±é€‰æ‹©æ–‡ä»¶è¾“å‡ºä½ç½® ç¼ºç‚¹ï¼š ä¹¦å†™æ ¼å¼ä¸å‹å¥½ï¼Œå¼ºæ ¼å¼è¦æ±‚ï¼Œå¯¹äºæ–°æ‰‹æ¥è¯´ä¸å®¹æ˜“ä¸Šæ‰‹ï¼Œå®˜æ–¹æ ·ä¾‹è¾ƒå°‘ï¼Œå¾ˆå¤šè¯­æ³•éœ€è¦å¯¹äº Swagger YAML æ ¼å¼ï¼Œè‡ªå·±ç†è§£è¿›è¡Œæ˜ å°„ æ²¡æœ‰èƒ½å¤Ÿå®Œæˆå®‰è£… JSDoc æ ¼å¼æ¥ä¹¦å†™æ³¨é‡Šï¼Œæ›´å€¾å‘äº YAML æ–‡ä»¶ doc-generators simple generator handler for swagger 1234567891011121314151617181920212223242526/** * @typedef Product * @property &#123;integer&#125; id * @property &#123;string&#125; name.required - Some description for product * @property &#123;Array.&lt;Point&gt;&#125; Point *//** * This function comment is parsed by doctrine * sdfkjsldfkj * @route POST /users * @param &#123;Point.model&#125; point.body.required - the new point * @group foo - Operations about user * @param &#123;string&#125; email.query.required - username or email * @param &#123;string&#125; password.query.required - user&apos;s password. * @param &#123;enum&#125; status.query.required - Status values that need to be considered for filter - eg: available,pending * @operationId retrieveFooInfo * @produces application/json application/xml * @consumes application/json application/xml * @returns &#123;Response.model&#125; 200 - An array of user info * @returns &#123;Product.model&#125; default - Unexpected error * @returns &#123;Array.&lt;Point&gt;&#125; Point - Some description for point * @headers &#123;integer&#125; 200.X-Rate-Limit - calls per hour allowed by the user * @headers &#123;string&#125; 200.X-Expires-After - date in UTC when token expires * @security JWT */ Usage ä¼˜ç‚¹ï¼š æ”¯æŒé›†æˆ Swaggerï¼Œæ”¯æŒæŒ‰ç…§ç±»ä¼¼ JSDoc æ–¹å¼ç”Ÿæˆæ–‡æ¡£ å‹å¥½çš„æ–‡æ¡£çš„æ³¨é‡Šï¼Œè´´åˆ IDE å‡½æ•°æ³¨é‡Š ç¼ºç‚¹ï¼š å®ç°å¯ç”¨çš„åŸºç¡€ä¸Šï¼Œéœ€è¦æ”¯æŒåˆ° IDEï¼Œæ–¹ä¾¿ä¸€é”®ç”Ÿæˆï¼Œæ”¯æŒè‡ªåŠ¨åŒ–Example12345678910111213141516/** * verify quarantine site * @route POST /ui/quarantine/v1/verify_od_dedicated_quarantine_site * @group quarantine * @param &#123;QuarantineJSON.model&#125; body.body.required - post body * @returns &#123;object&#125; 200 - An array of handler info * @returns &#123;Error&#125; 400 - invalid site * @returns &#123;Error&#125; 500 - internal error *//** * JSON parameters require a model. This one just has &quot;name&quot; * @typedef QuarantineJSON * @property &#123;string&#125; site.required - quarantine site info */ server.post(&apos;/ui/quarantine/v1/verify_od_dedicated_quarantine_site&apos;, middleware.other.verifyLoginInfo, rbac.quarantine.write, quarantine.verifyOdDedicatedQuarantineSite); 1234567891011121314151617181920212223/** * HTTP API statistics * @route GET /monit/v1/metric * @group monit * @param &#123;string&#125; sort.query - asc | desc * @param &#123;string&#125; direction.query - count | avarageMillisecondCost | routeName * @returns &#123;object&#125; 200 - An array of user info * @returns &#123;metrics.model&#125; default - Unexpected error *//** * @typedef metrics * @property &#123;string&#125; routeName.required - &apos;getuiadminv1company_plans&apos; * @property &#123;number&#125; count.required - route invoke times * @property &#123;number&#125; avarageMillisecondCost.required - route avg second cost */server.get(&quot;/monit/v1/metric&quot;, validator.query(&#123; type: &apos;object&apos;, properties: &#123; sort: &#123; type: &apos;string&apos;, enum: [&apos;count&apos;] &#125;, direction: &#123; type: &apos;string&apos;, enum: [&apos;asc&apos;, &apos;desc&apos;] &#125; &#125;&#125;), monitService.apiMetricHandlers); é¡¹ç›®åœ°å€ï¼šhttps://github.com/SensitiveMix/doc-generatorså–œæ¬¢çš„åŒå­¦è¯·ç‚¹ä¸ª Star ğŸ˜†","categories":[],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"https://sensitivemix.github.io/tags/Node-js/"},{"name":"Swagger Doc","slug":"Swagger-Doc","permalink":"https://sensitivemix.github.io/tags/Swagger-Doc/"}]},{"title":"æ•°æ®åº“åŸç†","slug":"æ•°æ®åº“åŸç†","date":"2019-01-07T14:08:33.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2019/01/07/æ•°æ®åº“åŸç†/","link":"","permalink":"https://sensitivemix.github.io/2019/01/07/æ•°æ®åº“åŸç†/","excerpt":"","text":"äº‹åŠ¡æ¦‚å¿µï¼šäº‹åŠ¡æŒ‡çš„æ˜¯æ»¡è¶³ ACID ç‰¹æ€§åˆ°ä¸€ç»„æ“ä½œï¼Œå¯ä»¥é€šè¿‡ commit æäº¤äº‹åŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ rollback è¿›è¡Œå›æ»šã€‚ 1. åŸå­æ€§ï¼ˆAtomicityï¼‰äº‹åŠ¡è¢«è§†ä¸ºä¸å¯åˆ†å‰²çš„æœ€å°å•å…ƒï¼Œäº‹åŠ¡çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æäº¤æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šã€‚å›æ»šå¯ä»¥ç”¨å›æ»šæ—¥å¿—æ¥å®ç°ï¼Œå›æ»šæ—¥å¿—è®°å½•ç€äº‹åŠ¡æ‰€æ‰§è¡Œçš„ä¿®æ”¹æ“ä½œï¼Œåœ¨å›æ»šæ—¶åå‘æ‰§è¡Œè¿™äº›ä¿®æ”¹æ“ä½œå³å¯ã€‚ 2. ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰æ•°æ®åº“åœ¨äº‹åŠ¡æ‰§è¡Œå‰åéƒ½ä¿æŒä¸€è‡´æ€§çŠ¶æ€ã€‚åœ¨ä¸€è‡´æ€§çŠ¶æ€ä¸‹ï¼Œæ‰€æœ‰äº‹åŠ¡å¯¹ä¸€ä¸ªæ•°æ®çš„è¯»å–ç»“æœéƒ½æ˜¯ç›¸åŒçš„ã€‚ 3. éš”ç¦»æ€§ï¼ˆIsolationï¼‰ä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æœ€ç»ˆæäº¤ä»¥å‰ï¼Œå¯¹å…¶å®ƒäº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚ 4. æŒä¹…æ€§ï¼ˆDurabilityï¼‰ä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œåˆ™å…¶æ‰€åšçš„ä¿®æ”¹å°†ä¼šæ°¸è¿œä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚å³ä½¿ç³»ç»Ÿå‘ç”Ÿå´©æºƒï¼Œäº‹åŠ¡æ‰§è¡Œçš„ç»“æœä¹Ÿä¸èƒ½ä¸¢å¤±ã€‚ ä½¿ç”¨é‡åšæ—¥å¿—æ¥ä¿è¯æŒä¹…æ€§ã€‚ AUTOCOMMIT Mysql é‡‡ç”¨è‡ªåŠ¨æäº¤çš„æ–¹å¼ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šè®¾ç½®äº‹åŠ¡çº§åˆ«ï¼Œæ¯ä¸ªæŸ¥è¯¢éƒ½ä¼šå½“åšä¸€ä¸ªäº‹åŠ¡æ¥æäº¤ã€‚ å¹¶å‘ä¸€è‡´æ€§é—®é¢˜ ä¸¢å¤±ä¿®æ”¹ T1 å’Œ T2 ä¸¤ä¸ªäº‹åŠ¡éƒ½å¯¹æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼ŒT1 å…ˆä¿®æ”¹ï¼ŒT2 å†ä¿®å¤ï¼Œè¿™æ · T2 å°±å¯èƒ½è¦†ç›– T1 çš„æ•°æ® è„è¯» T1 é€šè¿‡äº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œäº†æ›´æ”¹ï¼ŒT2 è¯»å–äº†æ•°æ®ï¼Œè¿™æ—¶å€™ T1 æ’¤é”€äº†æ›´æ”¹ï¼Œè¿™æ · T2 è¯»å–çš„æ•°æ®å°±æ˜¯è„æ•°æ® ä¸å¯é‡å¤è¯» T2 è¯»å–äº†æ•°æ®ï¼ŒT1 å¯¹è¯¥æ•°æ®åšäº†ä¿®æ”¹ã€‚å¦‚æœ T2 å†æ¬¡è¯»å–è¿™ä¸ªæ•°æ®ï¼Œæ­¤æ—¶è¯»å–çš„ç»“æœå’Œç¬¬ä¸€æ¬¡è¯»å–çš„ç»“æœä¸ä¸€æ ·ã€‚ å¹»å½±è¯» T1 è¯»å–æŸä¸ªèŒƒå›´çš„æ•°æ®ï¼ŒT2 å¾€è¿™ä¸ªèŒƒå›´ä¸­æ’å…¥æ•°æ®ï¼ŒT1 å†æ¬¡è¯»å–çš„æ—¶å€™å’Œç¬¬ä¸€æ¬¡è¯»å–çš„ç»“æœä¸ä¸€æ ·ã€‚äº§ç”Ÿå¹¶å‘ä¸ä¸€è‡´çš„ä¸»è¦åŸå› æ˜¯ç ´åäº†äº‹åŠ¡çš„éš”ç¦»æ€§ï¼Œè§£å†³åŠæ³•æ˜¯é€šè¿‡å¯¹å¹¶å‘è¿›è¡Œæ§åˆ¶æ¥ä¿è¯éš”ç¦»æ€§ã€‚å¹¶å‘æ§åˆ¶å¯ä»¥é€šè¿‡å°é”æ¥å®ç°ï¼Œä½†æ˜¯å°é”å®ç°éœ€è¦ç”¨æˆ·è‡ªå·±æ§åˆ¶ï¼Œç›¸å½“çš„è´Ÿè´£ã€‚æ‰€ä»¥æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæä¾›äº†äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼Œè®©ç”¨æˆ·ä»¥ä¸€ç§æ›´è½»æ¾çš„æ–¹å¼å¤„ç†å¹¶å‘ä¸€è‡´æ€§é—®é¢˜ã€‚","categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://sensitivemix.github.io/categories/æ•°æ®åº“/"}],"tags":[{"name":"Database","slug":"Database","permalink":"https://sensitivemix.github.io/tags/Database/"}]},{"title":"å¦‚ä½•è®¾è®¡å…³ç³»å‹æ•°æ®åº“","slug":"å¦‚ä½•è®¾è®¡å…³ç³»å‹æ•°æ®åº“","date":"2019-01-06T07:33:07.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2019/01/06/å¦‚ä½•è®¾è®¡å…³ç³»å‹æ•°æ®åº“/","link":"","permalink":"https://sensitivemix.github.io/2019/01/06/å¦‚ä½•è®¾è®¡å…³ç³»å‹æ•°æ®åº“/","excerpt":"","text":"RDBMSä» 0 åˆ° 1 è®¾è®¡å…³ç³»å‹æ•°æ®åº“ï¼Œæ€»å…±åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š ç¨‹åºå®ä¾‹ å­˜å‚¨ç®¡ç†æ¨¡å— ç¼“å­˜æ¨¡å—ï¼ˆéœ€è¦è®¾è®¡æ·˜æ±°æœºåˆ¶ SQL è§£æ æ—¥å¿—ç®¡ç†ï¼ˆè®°å½•æ‰€æœ‰æ“ä½œï¼‰ æƒé™åˆ’åˆ†ï¼ˆæˆæƒæ¨¡å—ï¼‰ å®¹ç¾æœºåˆ¶ï¼ˆä¿è¯æ•°æ®åº“é«˜å¯ç”¨ï¼‰ ç´¢å¼•ç®¡ç†ï¼ˆä¿è¯æ•°æ®æŸ¥è¯¢æ‰§è¡Œæ•ˆç‡ï¼‰ é”ç®¡ç†ï¼ˆä¿è¯æ•°æ® ACIDï¼‰ å­˜å‚¨æ¨¡å— æ–‡ä»¶ç³»ç»Ÿï¼ˆä¿è¯æ•°æ®æŒä¹…åŒ–ï¼‰ ç´¢å¼•æ¨¡å—ä¸ºä»€ä¹ˆä½¿ç”¨ç´¢å¼• å¿«é€ŸæŸ¥è¯¢æ•°æ®ï¼Œé¿å…å…¨è¡¨æ‰«æï¼Œæå‡æ£€ç´¢æ•ˆç‡ ä»€ä¹ˆæ ·çš„ä¿¡æ¯å¯ä»¥æˆä¸ºç´¢å¼• ä¸»é”®å’Œå”¯ä¸€é”®å¯ä»¥ä½œä¸ºç´¢å¼• ç´¢å¼•çš„æ•°æ®ç»“æ„ ç”Ÿæˆç´¢å¼•ï¼Œå»ºç«‹äºŒå‰æŸ¥æ‰¾æ ‘è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ ç”Ÿæˆç´¢å¼•ï¼Œå»ºç«‹ B-Tr ee ç»“æ„è¿›è¡ŒæŸ¥æ‰¾ æ ¹ç»“ç‚¹è‡³å°‘åŒ…å«ä¸¤ä¸ªå­©å­ã€ç»ˆç«¯èŠ‚ç‚¹ä½äºåŒä¸€å±‚ã€æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå«æœ‰ m ä¸ªå­©å­ï¼ˆm &gt;+ 2ï¼‰ã€é™¤äº†æ ¹èŠ‚ç‚¹å’Œå¶èŠ‚ç‚¹å¤–ï¼Œå…¶ä»–æ¯ä¸ªèŠ‚ç‚¹è‡³å°‘æœ‰ ceil(m/2) ä¸ªå­©å­ï¼‰é€šè¿‡åˆå¹¶ã€åˆ†è£‚æ¥ä¿æŒç»“æ„ï¼Œå±‚æ•°ä¸ä¼šå˜æ·± ç”Ÿæˆç´¢å¼•ï¼Œå»ºç«‹ B+- Tree è¿›è¡ŒæŸ¥æ‰¾ éå¶å­èŠ‚ç‚¹å…³é”®å­—å’ŒæŒ‡é’ˆä¸ªæ•°ä¸€æ · éå¶å­èŠ‚ç‚¹çš„å­æ•°æŒ‡é’ˆ P[i]ï¼ŒæŒ‡å‘å…³é”®å­—å€¼[K[i], K[i+1]] çš„å­æ ‘ éå¶å­èŠ‚ç‚¹ä»…ç”¨æ¥ç´¢å¼•ï¼Œæ•°æ®éƒ½ä¿å­˜åœ¨å¶å­èŠ‚ç‚¹ä¸­ æ‰€æœ‰å¶å­èŠ‚ç‚¹å‡æœ‰ä¸€ä¸ªé“¾æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼ˆæ–¹ä¾¿ç»Ÿè®¡å’ŒæŸ¥è¯¢ï¼‰ ä¼˜ç‚¹ ç£ç›˜è¯»å†™ä»£ä»·æ›´ä½ æŸ¥è¯¢æ•ˆç‡æ›´åŠ ç¨³å®š logn æœ‰åˆ©äºå¯¹æ•°æ®åº“çš„æ‰«æ ç”Ÿæˆç´¢å¼•ï¼Œå»ºç«‹ Hash ç»“æ„è¿›è¡ŒæŸ¥æ‰¾ æ— æ³•é¿å…å…¨è¡¨æ‰«æ åªèƒ½åš â€˜=â€™ â€˜inâ€™ ç­‰æ“ä½œï¼Œæ— æ³•åšèŒƒå›´æŸ¥è¯¢ï¼ˆhash ä¹‹åæ— æ³•ä¿è¯å€¼çš„å¤§å°ï¼‰ æ— æ³•ç”¨äºæ’åºæ“ä½œ ä¸èƒ½åˆ©ç”¨éƒ¨åˆ†ç´¢å¼•é”®åšæŸ¥è¯¢ hash å€¼é‡å¤ç‡è¾ƒé«˜çš„æƒ…å†µä¸‹ï¼Œæ•ˆç‡æ²¡æœ‰ B Tree æ•ˆç‡é«˜ï¼ˆä¸ç¨³å®šï¼‰ bitMap ï¼ˆä½å›¾ï¼‰ åªæœ‰å‡ ç§å€¼çš„æ—¶å€™ï¼ˆç”·ï¼Œå¥³ï¼‰ï¼Œçº¯ CPU å åŠ æ“ä½œ ç¼ºç‚¹ï¼Œé”çš„ç²’åº¦å¤§ï¼Œä¸é€‚ç”¨é«˜å¹¶å‘çš„ç³»ç»Ÿï¼Œé€‚åˆç»Ÿè®¡è¾ƒå¤šçš„ç³»ç»Ÿ å¯†é›†ç´¢å¼•å’Œç¨€ç–ç´¢å¼•çš„åŒºåˆ« å¯†é›†ç´¢å¼•çš„æ–‡ä»¶ä¸­æ¯ä¸ªæœç´¢ç å€¼éƒ½å¯¹åº”ä¸€ä¸ªç´¢å¼•å€¼ ç¨€ç–ç´¢å¼•æ–‡ä»¶åªä¸ºç´¢å¼•ç çš„æŸäº›å€¼å»ºç«‹ç´¢å¼•é¡¹ InnoDB è‹¥ä¸€ä¸ªç´¢å¼•è¢«å®šä¹‰ï¼Œåˆ™è¿™ä¸ªç´¢å¼•è¢«å®šä¹‰ä¸ºå¯†é›†ç´¢å¼• è‹¥æ²¡æœ‰ç´¢å¼•è¢«å®šä¹‰ï¼Œè¯¥è¡¨çš„ç¬¬ä¸€ä¸ªå”¯ä¸€éç©ºç´¢å¼•åˆ™ä½œä¸ºå¯†é›†ç´¢å¼• è‹¥ä¸æ»¡è¶³ä¸Šè¿°æ¡ä»¶ï¼Œå†…éƒ¨ä¼šè‡ªå·±ç”Ÿæˆä¸€ä¸ªéšè—ä¸»é”®","categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://sensitivemix.github.io/categories/æ•°æ®åº“/"}],"tags":[{"name":"Database","slug":"Database","permalink":"https://sensitivemix.github.io/tags/Database/"},{"name":"MongoDB","slug":"MongoDB","permalink":"https://sensitivemix.github.io/tags/MongoDB/"}]},{"title":"Redis çš„æŒä¹…å’Œå–èˆ","slug":"Redis-çš„æŒä¹…å’Œå–èˆ","date":"2019-01-01T13:32:37.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2019/01/01/Redis-çš„æŒä¹…å’Œå–èˆ/","link":"","permalink":"https://sensitivemix.github.io/2019/01/01/Redis-çš„æŒä¹…å’Œå–èˆ/","excerpt":"","text":"ä¸»è¦å†…å®¹ï¼š æŒä¹…åŒ–çš„ä½œç”¨ ä»€ä¹ˆæ˜¯æŒä¹…åŒ– æ‰€æœ‰çš„æ•°æ®éƒ½ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œé‡å¯ä¼šé€ æˆæ•°æ®ä¸¢å¤±ï¼Œæ‰€ä»¥éœ€è¦å¯¹æ•°æ®çš„æ›´æ–°å°†å¼‚æ­¥ä¿å­˜åœ¨ç£ç›˜ä¸­ ä¸»æµæ•°æ®åº“çš„æŒä¹…åŒ–æ–¹å¼ å¿«ç…§ï¼ˆmysql dumpï¼‰ å†™æ—¥å¿—ï¼ˆMysql Binlogã€MongoDB oplogã€HBase Hlogï¼‰ RDB ä»€ä¹ˆæ˜¯ RDB Redis å­˜å–å¿«ç…§ï¼Œä¸€èˆ¬æ˜¯ RDB äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå½“é‡å¯çš„æ—¶å€™ï¼ŒRedis é‡æ–°è½½å…¥è¿™ä¸ªå¿«ç…§ï¼Œåšåˆ°æ•°æ®ä¸ä¸¢å¤± ç¼“å­˜åç§°ï¼Œ dbfilename dump.rdbï¼Œå¸¸ç”¨å‘½å dbfilename dump-${port}.rdb å­˜å‚¨ä½ç½®ï¼Œdir ./ï¼Œéœ€è¦è€ƒè™‘åˆ°åˆ†ç›˜ è§¦å‘æœºåˆ¶ - ä¸»è¦ä¸‰ç§æ–¹å¼ saveï¼ŒåŒæ­¥å‘½ä»¤ï¼Œæ’é˜Ÿæ‰§è¡Œï¼Œå®¹æ˜“é€ æˆé˜»å¡ï¼›æ–‡ä»¶ç­–ç•¥ï¼Œæ–°æ–‡ä»¶æ›¿æ¢è€çš„æ–‡ä»¶ï¼Œå¤æ‚åº¦ O(n)ï¼Œä¸æ¶ˆè€—é¢å¤–å†…å­˜ï¼› bgsaveï¼Œå¼‚æ­¥å‘½ä»¤ï¼Œåå°æ‰§è¡Œï¼›forkï¼ˆé˜»å¡å‘ç”Ÿåœ¨ forkï¼‰ å­è¿›ç¨‹æ¥æ‰§è¡Œæ“ä½œï¼›æ–‡ä»¶ç­–ç•¥ï¼Œæ–°æ–‡ä»¶æ›¿æ¢è€çš„æ–‡ä»¶ï¼Œå¤æ‚åº¦ O(n)ï¼Œç¼ºç‚¹æ˜¯æ¶ˆè€—é¢å¤–å†…å­˜ç”¨äº fork autoï¼Œè‡ªåŠ¨æ‰§è¡Œï¼ˆsave 60 10000ï¼‰60 ç§’é’Ÿæ”¹å˜ 10000 æ•°æ®ï¼Œè‡ªåŠ¨ç”Ÿæˆ RDB æ–‡ä»¶ï¼› è§¦å‘æœºåˆ¶ - ä¸å¯å¿½ç•¥çš„æ–¹å¼ å…¨é‡å¤åˆ¶ï¼Œé€‚ç”¨äºä¸»ä»å¤åˆ¶åœºæ™¯ï¼Œä¸»ä¼šè‡ªåŠ¨ç”Ÿæˆ RDB æ–‡ä»¶ debug reloadï¼Œä¸éœ€è¦æ¸…ç©ºé‡å¯ï¼Œè§¦å‘ RDB æ–‡ä»¶ç”Ÿæˆ shutdownï¼Œshutdown save ç”Ÿæˆ RDB æ–‡ä»¶ AOF RDB ç°å­˜é—®é¢˜ è€—æ—¶è€—æ€§èƒ½ï¼ŒOï¼ˆnï¼‰æ•°æ®ï¼Œfork() æ¶ˆè€—å†…å­˜ï¼›copy-on-write ç­–ç•¥ï¼›Disk I/O æ€§èƒ½æŸè€— ä¸å¯æ§ï¼Œæ˜“ä¸¢å¤±æ•°æ®ï¼Œå®•æœºä¸¢å¤±æ•°æ® ä»€ä¹ˆæ˜¯AOF æ ¹æ®å†™å…¥å‘½ä»¤å†™å…¥æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œå®æ—¶ç›‘æ§å†™å…¥ ä¸‰ç§ç­–ç•¥ alwaysï¼Œå†™åœ¨ç¼“å†²åŒºä¸­ï¼Œæ¯æ¡å‘½ä»¤ fsync åˆ°ç£ç›˜ï¼Œç¼ºç‚¹ IO å¼€é”€å¤§ï¼Œä¼˜ç‚¹ä¸ä¸¢å¤±æ•°æ® everysecï¼Œæ¯ç§’å†™å…¥ç£ç›˜ä¸­ï¼Œå®¹æ˜“ä¸¢å¤±ä¸€ç§’çš„æ•°æ® noï¼Œæ“ä½œç³»ç»Ÿæ¥å†³å®šä»€ä¹ˆæ—¶å€™è¯¥ fsync åˆ°ç£ç›˜ï¼Œç¼ºç‚¹ä¸å¯æ§ï¼Œä¼˜ç‚¹å°±æ˜¯ä¸ç”¨ç®¡ é‡å†™ è€çš„æ–¹å¼å‡ºç°æ–‡ä»¶é€æ¸å˜å¤§çš„é—®é¢˜ï¼Œé‡å†™å› REDIS ä¼šéå¸¸æ…¢ï¼Œé’ˆå¯¹è¿™ä¸ªé—®é¢˜æä¾›äº†é‡å†™çš„åŠŸèƒ½ï¼Œåˆå¹¶å‘½ä»¤ï¼Œå‡ æ¡å‘½ä»¤åˆå¹¶æˆä¸€æ¡å‘½ä»¤ï¼›è¿‡æœŸçš„ä¹Ÿä¸ä¼šå†™å…¥æ–°çš„æ–‡ä»¶ï¼›ä¼˜ç‚¹å‡å°‘ç£ç›˜å ç”¨é‡ï¼ŒåŠ é€Ÿæ¢å¤é€Ÿåº¦ bgwriteofï¼Œfork å‡ºå­è¿›ç¨‹æ¥é‡å†™ï¼Œåœ¨å†…å­˜è¿›è¡Œé‡å†™ é…ç½® auto-aof-rewrite-min-sizeï¼ˆé‡å†™å°ºå¯¸) auto-aof-rewrite-percentage ï¼ˆæ–‡ä»¶å¢é•¿ç‡ï¼‰ aof_current_size ï¼ˆå½“å‰å°ºå¯¸ï¼‰ aof_base_size ï¼ˆä¸Šæ¬¡å¯åŠ¨å’Œé‡å†™çš„å°ºå¯¸ï¼‰ RDB å’Œ AOF æŠ‰æ‹© æ¯”è¾ƒ å‘½ä»¤ RDB AOF å¯åŠ¨ä¼˜å…ˆçº§ ä½ é«˜ ä½“ç§¯ å° å¤§ æ¢å¤é€Ÿåº¦ å¿« æ…¢ æ•°æ®å®‰å…¨æ€§ ä¸¢æ•°æ® æ ¹æ®ç­–ç•¥å†³å®š è½»é‡ é‡ è½» RDB æœ€ä½³ç­–ç•¥ â€œå…³â€ï¼Œé»˜è®¤ä¸å¼€å¯ï¼ˆä¸»ä»å…³é—­æ‰ï¼‰ï¼Œå…¨é‡å¤åˆ¶éœ€è¦è¿™ä¸ªç­–ç•¥ é›†ä¸­ç®¡ç†ï¼Œå¯¹æ•°æ®å¤‡ä»½æœ‰ä¸€å®šä½œç”¨ ä¸»ä»ï¼Œä»å¼€ï¼Œä¿å­˜å†å²æ–‡ä»¶ï¼ˆä»èŠ‚ç‚¹ä¸è¿›è¡Œè¯»å†™ï¼‰ï¼Œä¸é€‚åˆé¢‘ç¹è¯»å†™ï¼Œå¯¹ç£ç›˜å­˜åœ¨å½±å“ AOF æœ€ä½³ç­–ç•¥ â€œå¼€â€ ç¼“å­˜å’Œå­˜å‚¨ï¼Œå¯¹æ•°æ®æºæ²¡æœ‰å¾ˆå¤§ é‡å†™é›†ä¸­ç®¡ç†ï¼Œå•æœºå¤šéƒ¨ç½²ï¼Œ60-70% å†…å­˜ç»™ Redis everysec æœ€ä½³ç­–ç•¥ å°åˆ†ç‰‡ï¼ŒmaxMemory ç¼“å­˜æˆ–è€…å­˜å‚¨ ç›‘æ§ï¼ˆç£ç›˜ã€å†…å­˜ã€è´Ÿè½½ã€ç½‘ç»œï¼‰ è¶³å¤Ÿå†…å­˜ï¼ˆä¸éœ€è¦å…¨é‡ç»™ Redisï¼‰ å¸¸è§è¿ç»´é—®é¢˜ï¼š fork æ“ä½œï¼ˆå†…å­˜é¡µçš„æ‹·è´ï¼‰ åŒæ­¥æ“ä½œ ä¸å†…å­˜é‡æ¯æ¯ç›¸å…³ï¼Œå†…å­˜è¶Šå¤§ï¼Œè€—æ—¶è¶Šé•¿ï¼ˆä¸æœºå™¨ç±»å‹ç›¸å…³ï¼‰ info: latest_fork_usec ä¸Šä¸ªæ‰§è¡Œ fork å¾®ç§’æ•° æ”¹å–„ fork ä¼˜å…ˆä½¿ç”¨ç‰©ç†æœºæˆ–è€…é«˜æ•ˆæ”¯æŒ fork æ“ä½œçš„è™šæ‹ŸåŒ–æŠ€æœ¯ æ§åˆ¶ Redis å®ä¾‹æœ€å¤§çš„å¯ç”¨å†…å­˜ åˆç†é…ç½® Linux å†…å­˜åˆ†é…ç­–ç•¥ï¼švm.overcommit_memory=1 é™ä½ fork é¢‘ç‡ï¼šæ”¾å®½ AOF é‡å†™è§¦å‘æ—¶æœºï¼Œä¸å¿…è¦çš„å…¨é‡å¤åˆ¶ è¿›ç¨‹å¤–å¼€é”€å’Œä¼˜åŒ– CPU å¼€é”€ï¼šRDB å’Œ AOF æ–‡ä»¶ç”Ÿæˆï¼Œå±äº CPU å¯†é›†å‹ ä¼˜åŒ–ï¼šä¸åš CPU ç»‘å®šï¼Œä¸å’Œ CPU å¯†é›†å‹é¡¹ç›®ä¸€èµ·éƒ¨ç½² å†…å­˜ å¼€é”€ï¼šfork å†…å­˜å¼€é”€ï¼Œcopy-on-write ä¼˜åŒ–ï¼šecho never &gt; /sys/kernel/mm/transparent_hugepage/enabled ç¡¬ç›˜ å¼€é”€ï¼šAOF å’Œ RDB æ–‡ä»¶å†™å…¥ ä¼˜åŒ–ï¼š ä¸è¦å’Œé«˜ç¡¬ç›˜è´Ÿè½½æœåŠ¡éƒ¨ç½²åœ¨ä¸€èµ·ï¼šå­˜å‚¨æœåŠ¡ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ no-apendfsync-on-rewrite = yes æ ¹æ®å†™å…¥é‡å†³å®šç£ç›˜ç±»å‹ï¼šä¾‹å¦‚ SSD å•æœºå¤šéƒ¨ç½²æŒä¹…åŒ–ç›®å½•å¯ä»¥è€ƒè™‘åˆ†ç›˜ AOF è¿½åŠ é˜»å¡ å®šä½ Redis æ—¥å¿— asynchronous AOF fsync is take too long Redis å‘½ä»¤ï¼Œinfo Persistenceï¼ˆæŸ¥çœ‹å†å²ç´¯è®¡é˜»å¡ï¼‰ï¼› Linux ç³»ç»Ÿå‘½ä»¤ Top æ¥æŸ¥çœ‹èµ„æºå ç”¨ å•æœºå¤šå®ä¾‹éƒ¨ç½²","categories":[],"tags":[{"name":"Redis","slug":"Redis","permalink":"https://sensitivemix.github.io/tags/Redis/"}]},{"title":"è·¨åŸŸä¸å®‰å…¨","slug":"è·¨åŸŸä¸å®‰å…¨","date":"2018-12-02T14:03:24.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/12/02/è·¨åŸŸä¸å®‰å…¨/","link":"","permalink":"https://sensitivemix.github.io/2018/12/02/è·¨åŸŸä¸å®‰å…¨/","excerpt":"","text":"å…³äºè·¨åŸŸï¼Œæœ‰ä¸¤ä¸ªè¯¯åŒºï¼š âœ• åŠ¨æ€è¯·æ±‚å°±ä¼šæœ‰è·¨åŸŸçš„é—®é¢˜ âœ” è·¨åŸŸåªå­˜åœ¨äºæµè§ˆå™¨ç«¯ï¼Œä¸å­˜åœ¨äºå®‰å“/ios/Node.js/python/ javaç­‰å…¶å®ƒç¯å¢ƒ âœ• è·¨åŸŸå°±æ˜¯è¯·æ±‚å‘ä¸å‡ºå»äº† âœ” è·¨åŸŸè¯·æ±‚èƒ½å‘å‡ºå»ï¼ŒæœåŠ¡ç«¯èƒ½æ”¶åˆ°è¯·æ±‚å¹¶æ­£å¸¸è¿”å›ç»“æœï¼Œåªæ˜¯ç»“æœè¢«æµè§ˆå™¨æ‹¦æˆªäº† ä¹‹æ‰€ä»¥ä¼šè·¨åŸŸï¼Œæ˜¯å› ä¸ºå—åˆ°äº†åŒæºç­–ç•¥çš„é™åˆ¶ï¼ŒåŒæºç­–ç•¥è¦æ±‚æºç›¸åŒæ‰èƒ½æ­£å¸¸è¿›è¡Œé€šä¿¡ï¼Œå³åè®®ã€åŸŸåã€ç«¯å£å·éƒ½å®Œå…¨ä¸€è‡´ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Screenshot-0.png è¿™ä¸‰ä¸ªæºåˆ†åˆ«ç”±äºåŸŸåã€åè®®å’Œç«¯å£å·ä¸ä¸€è‡´ï¼Œå¯¼è‡´ä¼šå—åˆ°åŒæºç­–ç•¥çš„é™åˆ¶ã€‚ åŒæºç­–ç•¥å…·ä½“é™åˆ¶äº›ä»€ä¹ˆå‘¢ï¼Ÿ ä¸èƒ½å‘å·¥ä½œåœ¨ä¸åŒæºçš„çš„æœåŠ¡è¯·æ±‚æ•°æ®ï¼ˆclient to serverï¼‰ è¿™é‡Œæœ‰ä¸ªé—®é¢˜ä¹‹å‰ä¹Ÿå›°æ‰°äº†æˆ‘å¾ˆä¹…ï¼Œå°±æ˜¯ä¸ºä»€ä¹ˆhome.comåŠ è½½çš„cdn.home.com/index.jså¯ä»¥å‘home.comå‘è¯·æ±‚è€Œä¸ä¼šè·¨åŸŸå‘¢ï¼Ÿå…¶å®home.comåŠ è½½çš„JSæ˜¯å·¥ä½œåœ¨home.comçš„ï¼Œå®ƒçš„æºä¸æ˜¯æä¾›JSçš„cdnï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™æ˜¯æ²¡æœ‰è·¨åŸŸçš„é—®é¢˜çš„ï¼Œå¹¶ä¸”scriptæ ‡ç­¾èƒ½å¤ŸåŠ è½½éåŒæºçš„èµ„æºï¼Œä¸å—åŒæºç­–ç•¥çš„å½±å“ã€‚ æ— æ³•è·å–ä¸åŒæºçš„document/cookieç­‰BOMå’ŒDOMï¼Œå¯ä»¥è¯´ä»»ä½•æœ‰å…³å¦å¤–ä¸€ä¸ªæºçš„ä¿¡æ¯éƒ½æ— æ³•å¾—åˆ° ï¼ˆclient to clientï¼‰ ä¸ºä»€ä¹ˆä¼šæœ‰åŒæºç­–ç•¥å‘¢ï¼Ÿ ä¸ºä»€ä¹ˆè¦é™åˆ¶ä¸åŒæºå‘è¯·æ±‚ï¼Ÿ å‡è®¾ç”¨æˆ·ç™»é™†äº†bank.comï¼ŒåŒæ—¶æ‰“å¼€äº†evil.comï¼Œå¦‚æœæ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œevil.comå¯ä»¥å‘bank.comè¯·æ±‚åˆ°ä»»ä½•ä¿¡æ¯ï¼Œè¿›è€Œå°±å¯ä»¥åœ¨evil.comå‘bank.comå‘è½¬è´¦è¯·æ±‚ç­‰ã€‚ å¦‚æœè¿™æ ·ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥é™åˆ¶å†™ï¼Œåªé™åˆ¶è¯»ï¼Ÿ å› ä¸ºå¦‚æœè¿è¯·æ±‚éƒ½å‘ä¸å‡ºå»äº†ï¼Œé‚£å°±ä¸èƒ½åšè·¨åŸŸèµ„æºå…±äº«äº†ï¼Œæ— æ³•è¯»å–è¿”å›ç»“æœï¼Œevil.comå°±æ— æ³•ç»§ç»­ä¸‹ä¸€æ­¥çš„æ“ä½œï¼Œå¦‚è·å–è½¬è´¦è¯·æ±‚çš„ä¸€äº›å¿…è¦çš„éªŒè¯ä¿¡æ¯ã€‚ ä¸ºä»€ä¹ˆé™åˆ¶è·¨åŸŸçš„DOMè¯»å–ï¼Ÿ å¦‚æœä¸é™åˆ¶çš„è¯ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“å°±å¯ä»¥ä¼ªè£…å…¶å®ƒçš„ç½‘ç«™ï¼Œå¦‚å¥—ä¸€ä¸ªiframeæˆ–è€…é€šè¿‡window.opençš„æ–¹æ³•ï¼Œä»è€Œå¾—åˆ°ç”¨æˆ·çš„æ“ä½œå’Œè¾“å…¥ï¼Œå¦‚è´¦æˆ·ã€å¯†ç ã€‚ å¦å¤–ï¼Œæ·»åŠ è¿™ä¸ªhttpå¤´å¯ä»¥é™åˆ¶åˆ«äººæŠŠä½ çš„ç½‘ç«™å¥—æˆå®ƒçš„iframeï¼š X-Frame-Options: SAMEORIGIN åŒæºç­–ç•¥æä¾›äº†å®‰å…¨çš„åŒæ—¶ä¹Ÿé€ æˆäº†ä¸æ–¹ä¾¿ï¼Œå› ä¸ºæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è·¨åŸŸè¯·æ±‚ï¼Œå¦‚è·å–ç¬¬ä¸‰æ–¹æä¾›çš„æœåŠ¡ä¿¡æ¯ï¼Œç”±äºç¬¬ä¸‰æ–¹çš„æºå’Œæœ¬ç½‘ç«™çš„æºä¸ä¸€æ ·ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™å°±å—åˆ°è·¨åŸŸçš„é™åˆ¶ã€‚ è·¨åŸŸæœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œåº”å½“å±CORSï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Screenshot-1.png åªè¦æµè§ˆå™¨æ£€æµ‹åˆ°å“åº”å¤´å¸¦ä¸Šäº†CORSï¼Œå¹¶ä¸”å…è®¸çš„æºåŒ…æ‹¬äº†æœ¬ç½‘ç«™ï¼Œé‚£ä¹ˆå°±ä¸ä¼šæ‹¦æˆªè¯·æ±‚å“åº”ã€‚ CORSæŠŠè¯·æ±‚åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯ç®€å•è¯·æ±‚ï¼Œå¦ä¸€ç§æ˜¯éœ€è¦è§¦å‘é¢„æ£€è¯·æ±‚ï¼Œè¿™ä¸¤è€…æ˜¯ç›¸å¯¹çš„ï¼Œæ€æ ·æ‰ç®—â€œä¸ç®€å•â€ï¼Ÿåªè¦å±äºä¸‹é¢çš„å…¶ä¸­ä¸€ç§å°±ä¸æ˜¯ç®€å•è¯·æ±‚ï¼š ï¼ˆ1ï¼‰ä½¿ç”¨äº†é™¤GET/POST/HEADä¹‹å¤–çš„è¯·æ±‚æ–¹å¼ï¼Œå¦‚PUT/DELETE ï¼ˆ2ï¼‰ä½¿ç”¨äº†é™¤Content-Type/Acceptç­‰å‡ ä¸ªå¸¸ç”¨çš„httpå¤´ è¿™ä¸ªæ—¶å€™å°±è®¤ä¸ºéœ€è¦å…ˆå‘ä¸ªé¢„æ£€è¯·æ±‚ï¼Œé¢„æ£€è¯·æ±‚ä½¿ç”¨OPTIONSæ–¹å¼å»æ£€æŸ¥å½“å‰è¯·æ±‚æ˜¯å¦å®‰å…¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Screenshot-3.png ä»£ç é‡Œé¢åªå‘äº†ä¸€ä¸ªè¯·æ±‚ï¼Œä½†åœ¨æ§åˆ¶å°çœ‹åˆ°äº†ä¸¤ä¸ªè¯·æ±‚ï¼Œç¬¬ä¸€ä¸ªæ˜¯OPTIONSï¼ŒæœåŠ¡ç«¯è¿”å›ï¼š Screenshot-4.png è¿”å›å¤´é‡Œé¢åŒ…å«äº†å…è®¸çš„è¯·æ±‚å¤´ã€è¯·æ±‚æ–¹å¼ã€æºï¼Œä»¥åŠé¢„æ£€è¯·æ±‚çš„æœ‰æ•ˆæœŸï¼Œä¸Šå›¾æ˜¯è®¾ç½®äº†20å¤©ï¼Œåœ¨è¿™ä¸ªæœ‰æ•ˆæœŸå†…å°±ä¸ç”¨å†å‘ä¸€ä¸ªoptionsçš„è¯·æ±‚ï¼Œå®é™…ä¸Šæµè§ˆå™¨æœ‰ä¸€ä¸ªæœ€é•¿æ—¶é—´ï¼Œå¦‚Chromeæ˜¯5åˆ†é’Ÿã€‚å¦‚æœåœ¨é¢„æ£€è¯·æ±‚æ£€æµ‹åˆ°å½“å‰è¯·æ±‚ä¸ç¬¦åˆæœåŠ¡ç«¯è®¾å®šçš„è¦æ±‚ï¼Œåˆ™ä¸ä¼šå‘å‡ºå»äº†ç›´æ¥æŠ›å¼‚å¸¸ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¸ç”¨å»å‘â€œå¤æ‚â€çš„è¯·æ±‚äº†ã€‚ å¦‚æœ¬æºä¸åœ¨å…è®¸çš„æºèŒƒå›´å†…ï¼Œåˆ™ä¼šæŠ›å¼‚å¸¸ï¼Œæ— æ³•è·å–è¿”å›ç»“æœï¼š Screenshot-5.png location / { if ($request_method = â€˜OPTIONSâ€™) { add_header â€˜Access-Control-Allow-Originâ€™ â€˜â€˜; add_header â€˜Access-Control-Allow-Methodsâ€™ â€˜GET, POST, OPTIONSâ€™; add_header â€˜Access-Control-Max-Ageâ€™ 1728000; add_header â€˜Content-Typeâ€™ â€˜text/plain; charset=utf-8â€™; add_header â€˜Content-Lengthâ€™ 0; return 204; } add_header â€˜Access-Control-Allow-Originâ€™ â€˜â€˜; add_header â€˜Access-Control-Allow-Methodsâ€™ â€˜GET, POST, OPTIONS, PUT, DELETEâ€™; add_header â€˜Access-Control-Allow-Headersâ€™ â€˜DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Content-Range,Rangeâ€™; add_header â€˜Access-Control-Expose-Headersâ€™ â€˜DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Content-Range,Rangeâ€™;}ç¬¬äºŒç§å¸¸ç”¨çš„è·¨åŸŸçš„æ–¹æ³•æ˜¯JSONPï¼ŒJSONPæ˜¯åˆ©ç”¨äº†scriptæ ‡ç­¾èƒ½å¤Ÿè·¨åŸŸï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š function updateList (data) { console.log(data);} $body.append(â€˜&lt;script src=â€œhttp://otherdomain.com/request?callback=updateList&quot;&gt;â€˜);ä»£ç å…ˆå®šä¹‰ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åæŠŠè¿™ä¸ªå‡½æ•°åé€šè¿‡callbackå‚æ•°æ·»åŠ åˆ°scriptæ ‡ç­¾çš„srcï¼Œscriptçš„srcå°±æ˜¯éœ€è¦è·¨åŸŸçš„è¯·æ±‚ï¼Œç„¶åè¿™ä¸ªè¯·æ±‚è¿”å›å¯æ‰§è¡Œçš„JSæ–‡æœ¬ï¼š // scriptå“åº”è¿”å›çš„jså†…å®¹ä¸ºupdateList([{ name: â€˜helloâ€™}]);ç”±äºå®ƒæ˜¯ä¸€ä¸ªjsï¼Œå¹¶ä¸”å·²ç»å®šä¹‰äº†upldateListå‡½æ•°ï¼Œæ‰€ä»¥èƒ½æ­£å¸¸æ‰§è¡Œï¼Œå¹¶ä¸”è·¨åŸŸçš„æ•°æ®é€šè¿‡ä¼ å‚å¾—åˆ°ã€‚è¿™å°±æ˜¯JSONPçš„åŸç†ã€‚ æ‰€ä»¥ç”±äºscript/iframe/imgç­‰æ ‡ç­¾çš„è¯·æ±‚é»˜è®¤æ˜¯èƒ½å¸¦ä¸Šcookieï¼ˆcookieé‡Œé¢å¸¦ä¸Šäº†ç™»é™†éªŒè¯çš„ç¥¨tokenï¼‰ï¼Œç”¨è¿™äº›æ ‡ç­¾å‘è¯·æ±‚æ˜¯èƒ½å¤Ÿç»•è¿‡åŒæºç­–ç•¥çš„ï¼Œå› æ­¤å°±å¯ä»¥åˆ©ç”¨è¿™äº›æ ‡ç­¾åšè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰ï¼Œå¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºï¼š // è½¬è´¦è¯·æ±‚ // é…ç½®è·¯ç”±å™¨æ·»åŠ ä»£ç†å¦‚æœç›¸åº”çš„ç½‘ç«™æ”¯æŒGETè¯·æ±‚ï¼Œæˆ–è€…æ²¡æœ‰åšè¿›ä¸€æ­¥çš„é˜²æŠ¤æªæ–½ï¼Œé‚£ä¹ˆå¦‚æœç”¨æˆ·åœ¨å¦å¤–ä¸€ä¸ªé¡µé¢ç™»é™†è¿‡äº†ï¼Œå†æ‰“å¼€ä¸€ä¸ªâ€œæœ‰æ¯’â€çš„ç½‘ç«™å°±ä¸­æ‹›äº†ã€‚ è€ŒåŠ¨æ€ajaxè¯·æ±‚é»˜è®¤æ˜¯ä¸å¸¦cookieçš„ï¼Œå¦‚æœä½ è¦å¸¦cookieï¼Œå¯ä»¥è®¾ç½®ajaxçš„ä¸€ä¸ªå±æ€§withCredentialsï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š // åŸç”Ÿè¯·æ±‚let xhr = new XMLHttpRequest();xhr.withCredentials = true;xhr.open(â€œGETâ€, â€œhttp://otherdomain.com/list&quot;);xhr.send(); // jqueryè¯·æ±‚$.ajax({ url: â€œhttp://otherdomain.com/list&quot;, xhrFields: { withCredentials: true }});è¿™ä¸ªæ—¶å€™å°±å’Œimg/scriptæ ‡ç­¾ä¸€æ ·ï¼Œèƒ½å¸¦ä¸Šcookieï¼Œå¹¶ä¸”è¿˜æ”¯æŒé™¤GETä¹‹å¤–çš„å…¶å®ƒæ–¹å¼ã€‚æ‰€ä»¥è¿™ç§æ–¹å¼ä¹Ÿæ˜¯èƒ½å®ç°CSRFçš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Screenshot-6.png æ‰€ä»¥å¦‚æœè½¬è´¦è¯·æ±‚åªæ˜¯ä¸æ”¯æŒGETï¼Œæ²¡åšå…¶å®ƒçš„é˜²æŠ¤æªæ–½ï¼Œä»ç„¶æœ‰CSRFæ”»å‡»çš„é£é™©ã€‚é‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ æ–¹æ³•ä¸€æ˜¯æ¯æ¬¡è¯·æ±‚éƒ½è¦åœ¨å‚æ•°é‡Œé¢æ˜¾ç¤ºåœ°å¸¦ä¸Štokenå³ç™»é™†çš„ç¥¨ï¼Œè™½ç„¶è·¨åŸŸè¯·æ±‚èƒ½å¸¦ä¸Šcookieï¼Œä½†æ˜¯é€šè¿‡document.cookieä»ç„¶æ˜¯è·å–ä¸åˆ°å…¶å®ƒæºçš„cookieçš„ï¼Œæ‰€ä»¥æ”»å‡»è€…æ— æ³•åœ¨ä»£ç é‡Œé¢æ‹¿åˆ°cookieé‡Œé¢çš„tokenï¼Œæ‰€ä»¥å°±æ²¡åŠæ³•äº†ã€‚æ–¹æ³•ä¸€çš„ç¼ºç‚¹æ˜¯ä¼šæš´éœ²tokenï¼Œæ‰€ä»¥éœ€è¦å¸¦tokençš„æœ€å¥½ä¸èƒ½æ˜¯GETï¼Œå› ä¸ºGETä¼šæŠŠå‚æ•°æ‹¼åœ¨urlé‡Œé¢ï¼Œç”¨æˆ·å¯èƒ½ä¼šæ— æ„æŠŠé“¾æ¥å‘ç»™åˆ«äººï¼Œä½†ä¸çŸ¥é“è¿™ä¸ªé“¾æ¥å¸¦ä¸Šäº†è‡ªå·±çš„ç™»é™†ä¿¡æ¯ã€‚ æ–¹æ³•äºŒæ˜¯æ¯æ¬¡è½¬è´¦è¯·æ±‚å‰éƒ½å…ˆè¯·æ±‚ä¸€ä¸ªéšæœºä¸²ï¼Œè¿™ä¸ªä¸²åªèƒ½ç”¨ä¸€æ¬¡è½¬è´¦æˆ–è€…æ”¯ä»˜è¯·æ±‚ï¼Œç”¨å®Œå°±åºŸå¼ƒï¼Œåªæœ‰è¿™ä¸ªä¸²å¯¹å¾—ä¸Šæ‰èƒ½è¯·æ±‚æˆåŠŸï¼Œæ”»å‡»è€…æ˜¯æ— æ³•æ‹¿åˆ°è¿™ä¸ªä¸²çš„ï¼Œå› ä¸ºå¦‚æœè·¨åŸŸè¯·æ±‚å¸¦cookieï¼Œæµè§ˆå™¨è¦æ±‚Access-Control-Allow-Originä¸èƒ½ä¸ºé€šé…ç¬¦ï¼Œåªèƒ½ä¸ºæŒ‡å®šçš„æºï¼Œå¦‚ï¼š Access-Control-Allow-Origin: http://renren.com ç”±äºæ”»å‡»è€…æ‰€åœ¨çš„åŸŸåä¸åœ¨è¿™ä¸ªæºé‡Œé¢ï¼Œæ‰€ä»¥å®ƒæ˜¯æ— æ³•å¾—åˆ°è¯·æ±‚ç»“æœï¼Œæ‰€ä»¥è¯·æ±‚ä¸åˆ°éšæœºä¸²ã€‚å› æ­¤è¿™ç§æ–¹å¼ä¹Ÿæ˜¯å¯ä»¥é¿å…CSRFæ”»å‡»ã€‚ å‡è®¾Allow-Originä¸º*ï¼Œajaxè®¾ç½®withCredentialsä¸ºtrueæ—¶ï¼Œæµè§ˆå™¨ä¼šæŠ›å¼‚å¸¸ï¼Œæ— æ³•å¾—åˆ°è¿”å›ç»“æœï¼š Screenshot-7.png å¦å¤–æœåŠ¡è¿˜éœ€è¦æŒ‡å®šAllow-Credentialsçš„å¤´éƒ¨ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š add_header â€œAccess-Control-Allow-Originâ€ â€œhttp://fedren.com&quot;;add_header â€œAccess-Control-Allow-Credentialsâ€ â€œtrueâ€; å…³äºcookieè¿˜æœ‰ä¸¤ä¸ªåœ°æ–¹å€¼å¾—æ³¨æ„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Screenshot-8.png è®¨è®ºå®Œäº†client to serverï¼Œæˆ‘ä»¬å†è®¨è®ºclient to clientï¼Œå³å¦‚ä½•å’Œä¸€ä¸ªframeé€šä¿¡ï¼ŒåŒ…æ‹¬iframeæˆ–è€…ä½¿ç”¨window.openæ‰“å¼€çš„é¡µé¢ã€‚ iframeè®¿é—®çˆ¶é¡µé¢å¯é€šè¿‡window.parentå¾—åˆ°çˆ¶çª—å£çš„windowå¯¹è±¡ï¼Œé€šè¿‡openæ‰“å¼€çš„å¯ä»¥ç”¨window.openerï¼Œè¿›è€Œå¾—åˆ°çˆ¶çª—å£çš„ä»»ä½•ä¸œè¥¿ï¼›çˆ¶çª—å£å¦‚æœå’ŒiframeåŒæºçš„ï¼Œé‚£ä¹ˆå¯é€šè¿‡iframe.contentWindowå¾—åˆ°iframeçš„windowå¯¹è±¡ï¼Œå¦‚æœå’Œiframeä¸åŒæºï¼Œåˆ™å­˜åœ¨è·¨åŸŸçš„é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™å¯é€šè¿‡postMessageè¿›è¡Œé€šè®¯ã€‚ ä½¿ç”¨postMessageçš„åŸºæœ¬åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š // main framelet iframeWin = document.querySelector(â€œ#my-iframeâ€) .contentWindow;iframeWin.postMessage({age: 18}, â€œhttp://parent.com&quot;);iframeWin.onmessage = function(event) { console.log(â€œrecv from iframe â€œ, event.data);}; // iframewindow.onmessage = function(event) { // test event.origin if (event.origin !== expectOrigin) { return; } console.log(â€œrecv from main frame â€œ, event.data);}; window.parent.postMessage(â€œhello, this is from iframe â€œ, â€œhttp://child.com&quot;); ä»¥é¡µé¢åµŒå…¥youtobeè§†é¢‘ä¸ºä¾‹ï¼Œé€šè¿‡ä»¥ä¸‹ä»£ç å¯ä»¥åœ¨é¡µé¢åµŒå…¥ä¸€ä¸ªyoutobeè§†é¢‘ï¼ŒåµŒå…¥çš„æ˜¯ä¸€ä¸ªè·¨åŸŸçš„iframeï¼Œæ‰€ä»¥å°±æ¶‰åŠåˆ°å¦‚ä½•å’Œiframeè¿›è¡Œé€šä¿¡çš„é—®é¢˜ã€‚å¦‚æ€ä¹ˆçŸ¥é“iframeçš„çŠ¶æ€ï¼Œè§¦å‘çˆ¶é¡µé¢å®šä¹‰çš„äº‹ä»¶onPlayerReadyï¼Œè¿™ä¸ªæ˜¯iframeé€šçŸ¥çˆ¶é¡µé¢ï¼Œè€Œçˆ¶é¡µé¢å¯ä»¥è°ƒplayer.stopVideoæ§åˆ¶iframeçš„è¡Œä¸ºï¼Œè¿™ä¸ªæ˜¯çˆ¶é¡µé¢é€šçŸ¥iframeã€‚ Screenshot-9.png iframeé€šçŸ¥çˆ¶é¡µé¢æ˜¯é€šè¿‡window.parent.postMessageï¼ŒåŒæ—¶ç›‘å¬messageäº‹ä»¶ï¼š Screenshot-10.png ç»æ£€æŸ¥ä¸Šé¢ä»£ç 4304è¡Œçš„cå°±æ˜¯window.parentï¼Œè¿™ä¸ªembed-player.jsæ˜¯iframeçš„jsï¼Œiframeçš„jsé€šè¿‡postMessageå‘é€äº†ä¸€ä¸ªæ¶ˆæ¯ï¼Œå¦‚ä¸Šå›¾å³è¾¹çš„çª—å£æ‰€ç¤ºï¼Œç„¶ååœ¨çˆ¶çª—å£çš„widgetapi.jså°±æ”¶åˆ°äº†è¿™ä¸ªæ¶ˆæ¯ åŒæ ·åœ°ï¼Œçˆ¶çª—å£çš„JSä¹Ÿæ˜¯ä½¿ç”¨postMessageå‘iframeå‘é€æ¶ˆæ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Screenshot-11.png å½“ç„¶postMessageä¸é™äºè·¨åŸŸï¼ŒåŒåŸŸçš„ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œåªæ˜¯åŒåŸŸçš„è¯å¯ä»¥é€šè¿‡windowå¯¹è±¡äº’ç›¸æ“ä½œï¼Œä½ å¯èƒ½éœ€è¦é¢å¤–å®šä¹‰ä¸€äº›å…¨å±€å˜é‡æˆ–è€…å‡½æ•°ä¾›å…¶å®ƒframeä½¿ç”¨ï¼Œæˆ–è€…æ˜¯å®šä¹‰ä¸€å¥—äº‹ä»¶æœºåˆ¶ï¼ˆå¯ä»¥å€ŸåŠ©åŸç”Ÿäº‹ä»¶/jQuery/Vueäº‹ä»¶ç­‰ï¼‰ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªç‰¹ä¾‹ï¼Œå°±æ˜¯å­åŸŸå¦‚mail.hello.comè¦è·¨hello.comçš„æ—¶å€™ï¼Œå¯ä»¥æ˜¾å¼åœ°è®¾ç½®å­åŸŸçš„document.domainå€¼ä¸ºçˆ¶åŸŸçš„domainï¼š document.domain = â€œhello.comâ€;å°±ä¸ä¼šæœ‰è·¨åŸŸçš„é—®é¢˜äº†ã€‚ è¡¥å……ä¸€ç‚¹ï¼Œå¦‚æœéœ€è¦å’ŒåŒæºçš„ä¸åŒæ ‡ç­¾é¡µè¿›è¡Œé€šä¿¡å¯ä»¥ä½¿ç”¨localStorageï¼Œå³ä¸€ä¸ªé¡µé¢è®¾ç½®localStorageï¼Œå…¶å®ƒé¡µé¢å°±ä¼šè§¦å‘storageäº‹ä»¶ï¼š window.addEventListener(â€˜storageâ€™, function(e) { e.key; e.oldValue; e.newValue; e.url; e.storageArea;}); å†è¡¥å……ä¸€ç‚¹ï¼Œwebsocketæ˜¯ä¸å—åŒæºç­–ç•¥é™åˆ¶çš„ï¼Œæ²¡æœ‰è·¨åŸŸçš„é—®é¢˜ã€‚CSSçš„å­—ä½“æ–‡ä»¶æ˜¯ä¼šæœ‰è·¨åŸŸé—®é¢˜ï¼ŒæŒ‡å®šCORSå°±èƒ½åŠ è½½å…¶å®ƒæºçš„å­—ä½“æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯æ”¾åœ¨cdnä¸Šçš„ï¼‰ã€‚è€ŒcanvasåŠ¨æ€åŠ è½½çš„å¤–éƒ¨imageï¼Œä¹Ÿæ˜¯éœ€è¦æŒ‡å®šCORSå¤´æ‰èƒ½è¿›è¡Œå›¾ç‰‡å¤„ç†ï¼Œå¦åˆ™åªèƒ½ç”»ä¸èƒ½è¯»å–ã€‚ æœ€åï¼Œè·¨åŸŸåˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯è·¨åŸŸè¯·æ±‚ï¼Œå¦ä¸€ç§è®¿é—®è·¨åŸŸçš„é¡µé¢ï¼Œè·¨åŸŸè¯·æ±‚å¯ä»¥é€šè¿‡CORS/JSONPç­‰æ–¹æ³•è¿›è¡Œè®¿é—®ï¼Œè·¨åŸŸçš„é¡µé¢ä¸»è¦é€šè¿‡postMesssageçš„æ–¹å¼ã€‚ç”±äºè·¨åŸŸè¯·æ±‚ä¸ä½†èƒ½å‘å‡ºå»è¿˜èƒ½å¸¦ä¸Šcookieï¼Œæ‰€ä»¥è¦è§„é¿è·¨ç«™è¯·æ±‚ä¼ªé€ æ”»å‡»çš„é£é™©ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°é’±çš„é‚£ç§è¯·æ±‚ã€‚","categories":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://sensitivemix.github.io/categories/å¼€å‘/"}],"tags":[{"name":"InfluxDB","slug":"InfluxDB","permalink":"https://sensitivemix.github.io/tags/InfluxDB/"},{"name":"Database","slug":"Database","permalink":"https://sensitivemix.github.io/tags/Database/"}]},{"title":"å¦‚ä½•æ„å»ºæ˜“äºè¿ç»´çš„åç«¯åº”ç”¨","slug":"å¦‚ä½•æ„å»ºæ˜“äºè¿ç»´çš„åç«¯åº”ç”¨","date":"2018-12-01T06:42:27.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/12/01/å¦‚ä½•æ„å»ºæ˜“äºè¿ç»´çš„åç«¯åº”ç”¨/","link":"","permalink":"https://sensitivemix.github.io/2018/12/01/å¦‚ä½•æ„å»ºæ˜“äºè¿ç»´çš„åç«¯åº”ç”¨/","excerpt":"","text":"å…­ç‚¹è¦ç‚¹ ä¿æŒç®€å•å¹¶æ¶ˆé™¤ä¸ä¸€è‡´ æ— çŠ¶æ€çš„ã€äº‹åŠ¡çš„ï¼ˆstatelessã€scalableï¼‰ å•ä¸€ä»£ç åº“ ï¼ˆCodebase -&gt; Deploysï¼‰ ç®€å•åœ°è§‚å¯Ÿå’Œå¹²é¢„å†…éƒ¨è¡Œä¸º æ—¥å¿—çº§åˆ« ï¼ˆtraceã€debugã€infoã€warnã€errorã€fatalï¼‰ ç»“æ„åŒ–æ—¥å¿— ï¼ˆbunyanã€winstonï¼‰ æ—¶åºæ•°æ®å’Œå›¾è¡¨ï¼ˆGrafanaï¼‰ æ—¶åºæ•°æ®ï¼ˆInfluxDBï¼‰ é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†é…ç½® exports.LISTEN = process.env.LISTEN || 3000 å‡ºäº†é—®é¢˜è¦æœ‰åŠæ³•å‘ç° self-check yield [] Promise.all [] é”™è¯¯æ”¶é›†ï¼ˆSentryã€ravenï¼‰ æ“ä½œè‡ªåŠ¨åŒ– Why ä¿è¯ä¸€è‡´ èŠ‚çœæ—¶é—´ å¯é‡å¤ å¯å¤ç”¨ How ä¾èµ–ï¼ˆpackage.jsonï¼‰ æ•°æ®åº“å˜æ›´ï¼ˆdb-migrateï¼‰ ç³»ç»Ÿç¯å¢ƒï¼ˆDockerfileï¼‰ æ„å»ºã€æµ‹è¯•å’Œå‘å¸ƒï¼ˆCIï¼‰ å…¶ä»–è‡ªåŠ¨åŒ–è„šæœ¬ å°è¯•ä»é”™è¯¯ä¸­è‡ªåŠ¨æ¢å¤ æ•°æ®ä¸€è‡´æ€§ä¿®å¤ä»»åŠ¡ï¼ˆMySQL MongoDB Redis Cacheï¼‰ åˆ’æ¸…ç»„ä»¶ä¹‹é—´çš„ç•Œé™ å®ˆæŠ¤è¿›ç¨‹ï¼ˆé‡å¯ï¼‰ è´Ÿè½½å‡è¡¡ï¼ˆHttpsã€IPé™æµï¼‰ æ—¥å¿—ï¼ˆå†™å…¥æ–‡ä»¶ã€è½®è½¬he ï¼‰","categories":[{"name":"å­¦ä¹ èµ„æ–™","slug":"å­¦ä¹ èµ„æ–™","permalink":"https://sensitivemix.github.io/categories/å­¦ä¹ èµ„æ–™/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://sensitivemix.github.io/tags/Tutorial/"}]},{"title":"JavaScript ä»£ç æ•´æ´ä¹‹é“ä¸­æ–‡ç‰ˆ","slug":"JavaScript-ä»£ç æ•´æ´ä¹‹é“ä¸­æ–‡ç‰ˆ","date":"2018-12-01T06:33:40.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/12/01/JavaScript-ä»£ç æ•´æ´ä¹‹é“ä¸­æ–‡ç‰ˆ/","link":"","permalink":"https://sensitivemix.github.io/2018/12/01/JavaScript-ä»£ç æ•´æ´ä¹‹é“ä¸­æ–‡ç‰ˆ/","excerpt":"","text":"# ç›®å½• æ¦‚è¿° å˜é‡ å‡½æ•° å¯¹è±¡å’Œæ•°æ®ç»“æ„ ç±» æµ‹è¯• å¹¶å‘ é”™è¯¯å¤„ç† æ ¼å¼ æ³¨é‡Š æ¦‚è¿° Robert C. Martin åœ¨ ã€Šä»£ç æ•´æ´ä¹‹é“ã€‹ ä¸­æåˆ°çš„è½¯ä»¶å·¥ç¨‹åŸåˆ™ï¼ŒåŒæ ·é€‚ç”¨äº JavaScriptã€‚è¿™ä¸æ˜¯ä¸€ä¸ªé£æ ¼å‚è€ƒã€‚å®ƒæŒ‡å¯¼å¦‚ä½•ç”¨ JavaScript ç¼–å†™å¯è¯»ã€å¯å¤ç”¨ã€å¯é‡æ„çš„è½¯ä»¶ã€‚ å¹¶ä¸æ˜¯æ¯ä¸€ä¸ªåŸåˆ™éƒ½å¿…é¡»ä¸¥æ ¼éµå¾ªï¼Œç”šè‡³å¾ˆå°‘å¾—åˆ°å¤§å®¶çš„è®¤åŒã€‚å®ƒä»¬ä»…ç”¨äºå‚è€ƒï¼Œä¸è¿‡è¦çŸ¥é“è¿™äº›åŸåˆ™éƒ½æ˜¯ã€Šä»£ç æ•´æ´ä¹‹é“ã€‹çš„ä½œè€…ä»¬ç´¯ç§¯å¤šå¹´çš„é›†ä½“ç»éªŒã€‚ æˆ‘ä»¬åœ¨è½¯ä»¶å·¥ç¨‹æ–¹é¢çš„æŠ€æœ¯å‘å±•åˆšåˆšè¶…è¿‡ 50 å¹´ï¼Œæˆ‘ä»¬ä»ç„¶åœ¨å­¦ä¹ å¾ˆå¤šä¸œè¥¿ã€‚å½“è½¯ä»¶æ¶æ„å’Œæ¶æ„æœ¬èº«ä¸€æ ·å¤è€çš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥éµå¾ªæ›´ä¸ºä¸¥æ ¼è§„åˆ™ã€‚ç°åœ¨ï¼Œå¯¹äºä½ å’Œä½ çš„å›¢é˜Ÿç¼–å†™çš„ JavaScript ä»£ç ï¼Œä¸å¦¨ä¾æ®è¿™äº›å‡†åˆ™æ¥è¿›è¡Œè´¨é‡è¯„ä¼°ã€‚ è¿˜æœ‰ä¸€ä»¶äº‹ï¼šçŸ¥é“è¿™äº›ä¸ä¼šé©¬ä¸Šè®©ä½ æˆä¸ºæ›´å¥½çš„è½¯ä»¶å¼€å‘è€…ï¼Œåœ¨å·¥ä½œä¸­å¸¸å¹´ä½¿ç”¨è¿™äº›å‡†åˆ™ä¸èƒ½è®©ä½ é¿å…é”™è¯¯ã€‚æ¯ä¸€æ®µä»£ç éƒ½ä»æœ€åˆçš„è‰å›¾å¼€å§‹åˆ°æœ€ç»ˆæˆå‹ï¼Œå°±åƒä¸ºæ¹¿ç²˜åœŸå¡‘å½¢ä¸€æ ·ã€‚æœ€åï¼Œå½“æˆ‘ä»¬ä¸åŒè¡Œä¸€èµ·å®¡æŸ¥çš„æ—¶å€™ï¼Œå†æŠŠä¸å®Œç¾çš„åœ°æ–¹æ¶ˆé™¤æ‰ã€‚ä¸è¦å› ä¸ºåˆç¨¿éœ€è¦æ”¹å–„è€Œå¦å®šè‡ªå·±ï¼Œéœ€è¦è¦å¦å®šçš„åªæ˜¯é‚£äº›ä»£ç ï¼ å˜é‡ä½¿ç”¨æœ‰å‡†ç¡®æ„ä¹‰çš„å˜é‡åä¸å¥½: var yyyymmdstr = moment().format(â€˜YYYY/MM/DDâ€™); å¥½: var yearMonthDay = moment().format(â€˜YYYY/MM/DDâ€™); åœ¨å˜é‡çš„å€¼ä¸ä¼šæ”¹å˜æ—¶ä½¿ç”¨ ES6 çš„å¸¸é‡åœ¨ä¸å¥½çš„ç¤ºä¾‹ä¸­ï¼Œå˜é‡å¯ä»¥è¢«æ”¹å˜ã€‚å¦‚æœä½ ç”³æ˜ä¸€ä¸ªå¸¸é‡ï¼Œå®ƒä¼šåœ¨æ•´ä¸ªç¨‹åºä¸­å§‹ç»ˆä¿æŒä¸å˜ã€‚ ä¸å¥½: var FIRST_US_PRESIDENT = â€œGeorge Washingtonâ€; å¥½: const FIRST_US_PRESIDENT = â€œGeorge Washingtonâ€; å¯¹åŒä¸€ç±»å‹çš„å˜é‡ä½¿ç”¨ç›¸åŒçš„è¯æ±‡ä¸å¥½: getUserInfo();getClientData();getCustomerRecord(); å¥½: getUser(); ä½¿ç”¨å¯æ£€ç´¢çš„åç§°æˆ‘ä»¬é˜…è¯»çš„ä»£ç æ°¸è¿œæ¯”å†™çš„æŠ˜ã€‚å†™å¯è¯»æ€§å¼ºã€æ˜“äºæ£€ç´¢çš„çš„ä»£ç éå¸¸é‡è¦ã€‚åœ¨ç¨‹åºä¸­ä½¿ç”¨æ— æ˜ç¡®æ„ä¹‰çš„å˜é‡åä¼šéš¾ä»¥ç†è§£ï¼Œå¯¹è¯»è€…é€ æˆä¼¤å®³ã€‚æ‰€ä»¥ï¼ŒæŠŠåç§°å®šä¹‰æˆå¯æ£€ç´¢çš„ã€‚ ä¸å¥½: // è§é¬¼ï¼Œ525600 æ˜¯ä¸ªå•¥ï¼Ÿfor (var i = 0; i &lt; 525600; i++) { runCronJob();} å¥½: // ç”¨ `var` ç”³æ˜ä¸ºå¤§å†™çš„å…¨å±€å˜é‡var MINUTES_IN_A_YEAR = 525600;for (var i = 0; i &lt; MINUTES_IN_A_YEAR; i++) { runCronJob();} ä½¿ç”¨è§£é‡Šæ€§çš„å˜é‡ä¸å¥½: const cityStateRegex = /^(.+)[,\\\\s]+(.+?)\\s*(\\d{5})?$/;saveCityState(cityStateRegex.match(cityStateRegex)[1], cityStateRegex.match(cityStateRegex)[2]); å¥½: const cityStateRegex = /^(.+)[,\\\\s]+(.+?)\\s*(\\d{5})?$/;const match = cityStateRegex.match(cityStateRegex)const city = match[1];const state = match[2];saveCityState(city, state); é¿å…æš—ç¤ºæ˜¾å¼ä¼˜äºéšå¼ã€‚ ä¸å¥½: var locations = [â€˜Austinâ€™, â€˜New Yorkâ€™, â€˜San Franciscoâ€™];locations.forEach((l) =&gt; { doStuff(); doSomeOtherStuff(); â€¦ â€¦ â€¦ // ç­‰ç­‰ï¼Œ`l` åˆæ˜¯ä»€ä¹ˆï¼Ÿ dispatch(l);}); å¥½: var locations = [â€˜Austinâ€™, â€˜New Yorkâ€™, â€˜San Franciscoâ€™];locations.forEach((location) =&gt; { doStuff(); doSomeOtherStuff(); â€¦ â€¦ â€¦ dispatch(location);}); ä¸è¦æ·»åŠ æ²¡å¿…è¦çš„ä¸Šä¸‹æ–‡å¦‚æœä½ çš„ç±»åç§°/å¯¹è±¡åç§°å·²ç»è¯´æ˜äº†å®ƒä»¬æ˜¯ä»€ä¹ˆï¼Œä¸è¦åœ¨(å±æ€§)å˜é‡åé‡Œé‡å¤ã€‚ ä¸å¥½: var Car = { carMake: â€˜Hondaâ€™, carModel: â€˜Accordâ€™, carColor: â€˜Blueâ€™}; function paintCar(car) { car.carColor = â€˜Redâ€™;} å¥½: var Car = { make: â€˜Hondaâ€™, model: â€˜Accordâ€™, color: â€˜Blueâ€™}; function paintCar(car) { car.color = â€˜Redâ€™;} çŸ­è·¯è¯­æ³•æ¯”æ¡ä»¶è¯­å¥æ›´æ¸…æ™°ä¸å¥½: function createMicrobrewery(name) { var breweryName; if (name) { breweryName = name; } else { breweryName = â€˜Hipster Brew Co.â€™; }} å¥½: function createMicrobrewery(name) { var breweryName = name || â€˜Hipster Brew Co.â€™} å‡½æ•°å‡½æ•°å‚æ•° (ç†è®ºä¸Šå°‘äºç­‰äº2ä¸ª)é™åˆ¶å‡½æ•°å‚æ•°çš„æ•°é‡æä¸ºé‡è¦ï¼Œå®ƒä¼šè®©ä½ æ›´å®¹æ˜“æµ‹è¯•å‡½æ•°ã€‚è¶…è¿‡3ä¸ªå‚æ•°ä¼šå¯¼è‡´ç»„åˆè†¨èƒ€ï¼Œä»¥è‡´äºä½ å¿…é¡»æ ¹æ®ä¸åŒçš„å‚æ•°å¯¹å¤§é‡ä¸åŒçš„æƒ…å†µè¿›è¡Œæµ‹è¯•ã€‚ ç†æƒ³æƒ…å†µä¸‹æ˜¯æ²¡æœ‰å‚æ•°ã€‚æœ‰ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªå‚æ•°ä¹Ÿè¿˜å¥½ï¼Œä¸‰ä¸ªå°±åº”è¯¥é¿å…äº†ã€‚å¤šäºé‚£ä¸ªæ•°é‡å°±åº”è¯¥è€ƒè™‘åˆå¹¶ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœä½ æœ‰å¤šäº2ä¸ªå‚æ•°ï¼Œä½ çš„å‡½æ•°ä¼šå°è¯•åšå¤ªå¤šäº‹æƒ…ã€‚å¦‚æœä¸æ˜¯è¿™æ ·ï¼Œå¤§å¤šæ•°æ—¶å€™å¯ä»¥ä½¿ç”¨ä¸€ä¸ªé«˜é˜¶å¯¹è±¡ä½œä¸ºå‚æ•°ä½¿ç”¨ã€‚ æ—¢ç„¶ JavaScript å…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶éšæ„åˆ›å»ºå¯¹è±¡ï¼Œè€Œä¸éœ€è¦é¢„å…ˆå®šä¹‰æ ·æ¿ï¼Œé‚£ä¹ˆä½ åœ¨éœ€è¦å¾ˆå¤šå‚æ•°çš„æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡æ¥å¤„ç†ã€‚ ä¸å¥½: function createMenu(title, body, buttonText, cancellable) { â€¦} å¥½: var menuConfig = { title: â€˜Fooâ€™, body: â€˜Barâ€™, buttonText: â€˜Bazâ€™, cancellable: true} function createMenu(menuConfig) { â€¦} ä¸€ä¸ªå‡½æ•°åªåšä¸€ä»¶äº‹ç›®å‰è¿™æ˜¯è½¯ä»¶å·¥ç¨‹ä¸­æœ€é‡è¦çš„åŸåˆ™ã€‚å¦‚æœå‡½æ•°åšäº†è¾ƒå¤šçš„äº‹æƒ…ï¼Œå®ƒå°±éš¾ä»¥ç»„åˆã€æµ‹è¯•å’Œæ¨æµ‹ã€‚å½“ä½ è®©å‡½æ•°åªåšä¸€ä»¶äº‹æƒ…çš„æ—¶å€™ï¼Œå®ƒä»¬å°±å¾ˆå®¹æ˜“é‡æ„ï¼Œè€Œä¸”ä»£ç è¯»èµ·æ¥ä¹Ÿä¼šæ¸…æ™°å¾—å¤šã€‚ä½ åªéœ€è¦éµå¾ªæœ¬æŒ‡å—çš„è¿™ä¸€æ¡ï¼Œå°±èƒ½é¢†å…ˆäºå…¶ä»–å¾ˆå¤šå¼€å‘è€…ã€‚ ä¸å¥½: function emailClients(clients) { clients.forEach(client =&gt; { let clientRecord = database.lookup(client); if (clientRecord.isActive()) { email(client); } });} å¥½: function emailClients(clients) { clients.forEach(client =&gt; { emailClientIfNeeded(client); });} function emailClientIfNeeded(client) { if (isClientActive(client)) { email(client); }} function isClientActive(client) { let clientRecord = database.lookup(client); return clientRecord.isActive();} å‡½æ•°åç§°è¦è¯´æ˜å®ƒåšçš„äº‹ä¸å¥½: function dateAdd(date, month) { // â€¦} let date = new Date(); // å¾ˆéš¾ä»å‡½æ•°åäº†è§£åˆ°åŠ äº†ä»€ä¹ˆdateAdd(date, 1); å¥½: function dateAddMonth(date, month) { // â€¦} let date = new Date();dateAddMonth(date, 1); å‡½æ•°åº”è¯¥åªæŠ½è±¡ä¸€ä¸ªå±‚æ¬¡å¦‚æœä½ æœ‰å¤šä¸ªå±‚æ¬¡çš„æŠ½è±¡ï¼Œé‚£ä¹ˆä½ çš„å‡½æ•°é€šå¸¸åšäº†å¤ªå¤šäº‹æƒ…ï¼Œæ­¤æ—¶åº”è¯¥æ‹†åˆ†å‡½æ•°ä½¿å…¶æ˜“äºå¤ç”¨å’Œæ˜“äºæµ‹è¯•ã€‚ ä¸å¥½: function parseBetterJSAlternative(code) { let REGEXES = [ // â€¦ ]; let statements = code.split(â€˜ â€˜); let tokens; REGEXES.forEach((REGEX) =&gt; { statements.forEach((statement) =&gt; { // â€¦ }) }); let ast; tokens.forEach((token) =&gt; { // lexâ€¦ }); ast.forEach((node) =&gt; { // parseâ€¦ })} å¥½: function tokenize(code) { let REGEXES = [ // â€¦ ]; let statements = code.split(â€˜ â€˜); let tokens; REGEXES.forEach((REGEX) =&gt; { statements.forEach((statement) =&gt; { // â€¦ }) }); return tokens;} function lexer(tokens) { let ast; tokens.forEach((token) =&gt; { // lexâ€¦ }); return ast;} function parseBetterJSAlternative(code) { let tokens = tokenize(code); let ast = lexer(tokens); ast.forEach((node) =&gt; { // parseâ€¦ })} åˆ é™¤é‡å¤ä»£ç ä»»ä½•æƒ…å†µä¸‹ï¼Œéƒ½ä¸è¦æœ‰é‡å¤çš„ä»£ç ã€‚æ²¡æœ‰ä»»ä½•åŸå› ï¼Œå®ƒå¾ˆå¯èƒ½æ˜¯é˜»ç¢ä½ æˆä¸ºä¸“ä¸šå¼€å‘è€…çš„æœ€ç³Ÿç³•çš„ä¸€ä»¶äº‹ã€‚é‡å¤ä»£ç æ„å‘³ç€ä½ è¦ä¿®æ”¹æŸäº›é€»è¾‘çš„æ—¶å€™è¦ä¿®æ”¹ä¸æ­¢ä¸€ä¸ªåœ°æ–¹çš„ä»£ç ã€‚JavaScript æ˜¯å¼±ç±»å‹è¯­å¥ï¼Œæ‰€ä»¥å®ƒå¾ˆå®¹æ˜“å†™é€šç”¨æ€§å¼ºçš„å‡½æ•°ã€‚è®°å¾—åˆ©ç”¨è¿™ä¸€ç‚¹ï¼ ä¸å¥½: function showDeveloperList(developers) { developers.forEach(developers =&gt; { var expectedSalary = developer.calculateExpectedSalary(); var experience = developer.getExperience(); var githubLink = developer.getGithubLink(); var data = { expectedSalary: expectedSalary, experience: experience, githubLink: githubLink }; render(data); });} function showManagerList(managers) { managers.forEach(manager =&gt; { var expectedSalary = manager.calculateExpectedSalary(); var experience = manager.getExperience(); var portfolio = manager.getMBAProjects(); var data = { expectedSalary: expectedSalary, experience: experience, portfolio: portfolio }; render(data); });} å¥½: function showList(employees) { employees.forEach(employee =&gt; { var expectedSalary = employee.calculateExpectedSalary(); var experience = employee.getExperience(); var portfolio; if (employee.type === &apos;manager&apos;) { portfolio = employee.getMBAProjects(); } else { portfolio = employee.getGithubLink(); } var data = { expectedSalary: expectedSalary, experience: experience, portfolio: portfolio }; render(data); });} ä½¿ç”¨é»˜è®¤å‚æ•°ä»£æ›¿çŸ­è·¯è¡¨è¾¾å¼ä¸å¥½: function writeForumComment(subject, body) { subject = subject || â€˜No Subjectâ€™; body = body || â€˜No textâ€™;} å¥½: function writeForumComment(subject = â€˜No subjectâ€™, body = â€˜No textâ€™) { â€¦} ç”¨ Object.assign è®¾ç½®é»˜è®¤å¯¹è±¡ä¸å¥½: var menuConfig = { title: null, body: â€˜Barâ€™, buttonText: null, cancellable: true} function createMenu(config) { config.title = config.title || â€˜Fooâ€™ config.body = config.body || â€˜Barâ€™ config.buttonText = config.buttonText || â€˜Bazâ€™ config.cancellable = config.cancellable === undefined ? config.cancellable : true; } createMenu(menuConfig); å¥½: var menuConfig = { title: â€˜Orderâ€™, // User did not include â€˜bodyâ€™ key buttonText: â€˜Sendâ€™, cancellable: true} function createMenu(config) { config = Object.assign({ title: â€˜Fooâ€™, body: â€˜Barâ€™, buttonText: â€˜Bazâ€™, cancellable: true }, config); // ç°åœ¨ config ç­‰äº: {title: â€œFooâ€, body: â€œBarâ€, buttonText: â€œBazâ€, cancellable: true} // â€¦} createMenu(menuConfig); ä¸è¦æŠŠæ ‡è®°ç”¨ä½œå‡½æ•°å‚æ•°æ ‡è®°å‘Šè¯‰ä½ çš„ç”¨æˆ·è¿™ä¸ªå‡½æ•°åšçš„äº‹æƒ…ä¸æ­¢ä¸€ä»¶ã€‚ä½†æ˜¯å‡½æ•°åº”è¯¥åªåšä¸€ä»¶äº‹ã€‚å¦‚æœä½ çš„å‡½æ•°ä¸­ä¼šæ ¹æ®æŸä¸ªå¸ƒå°”å‚æ•°äº§ç”Ÿä¸åŒçš„åˆ†æ”¯ï¼Œé‚£å°±æ‹†åˆ†è¿™ä¸ªå‡½æ•°ã€‚ ä¸å¥½: function createFile(name, temp) { if (temp) { fs.create(â€˜./temp/â€˜ + name); } else { fs.create(name); }} å¥½: function createTempFile(name) { fs.create(â€˜./temp/â€˜ + name);} function createFile(name) { fs.create(name);} é¿å…å‰¯ä½œç”¨å¦‚æœä¸€ä¸ªå‡½æ•°ä¸æ˜¯è·å–ä¸€ä¸ªè¾“å…¥çš„å€¼å¹¶è¿”å›å…¶å®ƒå€¼ï¼Œå®ƒå°±æœ‰å¯èƒ½äº§ç”Ÿå‰¯ä½œç”¨ã€‚è¿™äº›å‰¯ä½œç”¨å¯èƒ½æ˜¯å†™å…¥æ–‡ä»¶ã€ä¿®æ”¹ä¸€äº›å…¨å±€å˜é‡ï¼Œæˆ–è€…æ„å¤–åœ°æŠŠä½ æ‰€æœ‰é’±è½¬ç»™ä¸€ä¸ªé™Œç”Ÿäººã€‚ ç°åœ¨ä½ ç¡®å®éœ€è¦åœ¨ç¨‹åºä¸­æœ‰å‰¯ä½œç”¨ã€‚åƒå‰é¢æåˆ°çš„é‚£æ ·ï¼Œä½ å¯èƒ½éœ€è¦å†™å…¥æ–‡ä»¶ã€‚ç°åœ¨ä½ éœ€è¦åšçš„äº‹æƒ…æ˜¯ææ¸…æ¥šåœ¨å“ªé‡Œé›†ä¸­å®Œæˆè¿™ä»¶äº‹æƒ…ã€‚ä¸è¦ä½¿ç”¨å‡ ä¸ªå‡½æ•°æˆ–ç±»æ¥å®Œæˆå†™å…¥æŸä¸ªç‰¹å®šæ–‡ä»¶çš„å·¥ä½œã€‚é‡‡ç”¨ä¸€ä¸ªï¼Œå°±ä¸€ä¸ªæœåŠ¡æ¥å®Œæˆã€‚ å…³é”®ç‚¹æ˜¯é¿å…è§‰çš„é™·é˜±ï¼Œæ¯”å¦‚åœ¨æ²¡æœ‰ç»“æ„çš„å¯¹è±¡é—´å…±äº«çŠ¶æ€ï¼Œä½¿ç”¨å¯ä»¥è¢«ä»»æ„ä¿®æ”¹çš„æ˜“å˜çš„æ•°æ®ç±»å‹ï¼Œæ²¡æœ‰é›†ä¸­å¤„ç†å‘ç”Ÿçš„å‰¯ä½œç”¨ç­‰ã€‚å¦‚æœä½ èƒ½åšåˆ°ï¼Œä½ å°±èƒ½æ¯”å…¶ä»–å¤§å¤šæ•°ç¨‹åºå‘˜æ›´æ„‰å¿«ã€‚ ä¸å¥½: // ä¸‹é¢çš„å‡½æ•°ä½¿ç”¨äº†å…¨å±€å˜é‡ã€‚// å¦‚æœæœ‰å¦ä¸€ä¸ªå‡½æ•°åœ¨ä½¿ç”¨ nameï¼Œç°åœ¨å¯èƒ½ä¼šå› ä¸º name å˜æˆäº†æ•°ç»„è€Œä¸èƒ½æ­£å¸¸è¿è¡Œã€‚var name = â€˜Ryan McDermottâ€™; function splitIntoFirstAndLastName() { name = name.split(â€˜ â€˜);} splitIntoFirstAndLastName(); console.log(name); // [â€˜Ryanâ€™, â€˜McDermottâ€™]; å¥½: function splitIntoFirstAndLastName(name) { return name.split(â€˜ â€˜);} var name = â€˜Ryan McDermottâ€™var newName = splitIntoFirstAndLastName(name); console.log(name); // â€˜Ryan McDermottâ€™;console.log(newName); // [â€˜Ryanâ€™, â€˜McDermottâ€™]; ä¸è¦å†™å…¥å…¨å±€å‡½æ•°JavaScript ä¸­å…¨å±€æ±¡æŸ“æ˜¯ä¸€ä»¶ç³Ÿç³•çš„äº‹æƒ…ï¼Œå› ä¸ºå®ƒå¯èƒ½å’Œå¦å¤–åº“å‘ç”Ÿå†²çªï¼Œç„¶è€Œä½¿ç”¨ä½  API çš„ç”¨æˆ·å´ä¸ä¼šçŸ¥é“â€”â€”ç›´åˆ°ä»–ä»¬åœ¨ç”Ÿäº§ä¸­é‡åˆ°ä¸€ä¸ªå¼‚å¸¸ã€‚æ¥æ€è€ƒä¸€ä¸ªä¾‹å­ï¼šä½ æƒ³æ‰©å±• JavaScript çš„åŸç”Ÿ Arrayï¼Œä½¿ä¹‹æ‹¥æœ‰ä¸€ä¸ª diff æ–¹æ³•ï¼Œç”¨æ¥å±•ç¤ºä¸¤æ•°æ®ä¹‹å‰çš„åŒºåˆ«ï¼Œè¿™æ—¶ä½ ä¼šæ€ä¹ˆåšï¼Ÿä½ å¯ä»¥ç»™ Array.prototype æ·»åŠ ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œä½†å®ƒå¯èƒ½ä¼šä¸å…¶å®ƒæƒ³åšåŒæ ·äº‹æƒ…çš„åº“å‘ç”Ÿå†²çªã€‚å¦‚æœé‚£ä¸ªåº“å®ç°çš„ diff åªæ˜¯æ¯”å¦‚æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ å’Œæœ€åä¸€ä¸ªå…ƒç´ çš„å¼‚åŒä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…å‘¢ï¼Ÿè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ€å¥½æ˜¯ä½¿ç”¨ ES6 çš„ç±»è¯­æ³•ä»å…¨å±€çš„ Array æ´¾ç”Ÿä¸€ä¸ªç±»æ¥åšè¿™ä»¶äº‹ã€‚ ä¸å¥½: Array.prototype.diff = function(comparisonArray) { var values = []; var hash = {}; for (var i of comparisonArray) { hash[i] = true; } for (var i of this) { if (!hash[i]) { values.push(i); } } return values;} å¥½: class SuperArray extends Array { constructor(â€¦args) { super(â€¦args); } diff(comparisonArray) { var values = []; var hash = {}; for (var i of comparisonArray) { hash\\[i\\] = true; } for (var i of this) { if (!hash\\[i\\]) { values.push(i); } } return values; }} å–œæ¬¢ä¸Šå‘½ä»¤å¼ç¼–ç¨‹ä¹‹ä¸Šçš„å‡½æ•°å¼ç¼–ç¨‹å¦‚æœ Haskell æ˜¯ IPA é‚£ä¹ˆ JavaScript å°±æ˜¯ Oâ€™Doulsã€‚å°±æ˜¯è¯´ï¼Œä¸ Haskell ä¸åŒï¼ŒJavaScript ä¸æ˜¯å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œä¸è¿‡å®ƒä»ç„¶æœ‰ä¸€ç‚¹å‡½æ•°å¼çš„æ„å‘³ã€‚å‡½æ•°å¼è¯­è¨€æ›´æ•´æ´ä¹Ÿæ›´å®¹æ˜“æµ‹è¯•ï¼Œæ‰€ä»¥ä½ æœ€å¥½èƒ½å–œæ¬¢ä¸Šè¿™ç§ç¼–ç¨‹é£æ ¼ã€‚ ä¸å¥½: const programmerOutput = [ { name: â€˜Uncle Bobbyâ€™, linesOfCode: 500 }, { name: â€˜Suzie Qâ€™, linesOfCode: 1500 }, { name: â€˜Jimmy Goslingâ€™, linesOfCode: 150 }, { name: â€˜Gracie Hopperâ€™, linesOfCode: 1000 }]; var totalOutput = 0; for (var i = 0; i &lt; programmerOutput.length; i++) { totalOutput += programmerOutput[i].linesOfCode;} å¥½: const programmerOutput = [ { name: â€˜Uncle Bobbyâ€™, linesOfCode: 500 }, { name: â€˜Suzie Qâ€™, linesOfCode: 1500 }, { name: â€˜Jimmy Goslingâ€™, linesOfCode: 150 }, { name: â€˜Gracie Hopperâ€™, linesOfCode: 1000 }]; var totalOutput = programmerOutput .map((programmer) =&gt; programmer.linesOfCode) .reduce((acc, linesOfCode) =&gt; acc + linesOfCode, 0); å°è£…æ¡ä»¶ä¸å¥½: if (fsm.state === â€˜fetchingâ€™ &amp;&amp; isEmpty(listNode)) { /// â€¦} å¥½: function shouldShowSpinner(fsm, listNode) { return fsm.state === â€˜fetchingâ€™ &amp;&amp; isEmpty(listNode);} if (shouldShowSpinner(fsmInstance, listNodeInstance)) { // â€¦} é¿å…å¦å®šæ¡ä»¶ä¸å¥½: function isDOMNodeNotPresent(node) { // â€¦} if (!isDOMNodeNotPresent(node)) { // â€¦} å¥½: function isDOMNodePresent(node) { // â€¦} if (isDOMNodePresent(node)) { // â€¦} é¿å…æ¡ä»¶è¿™ä¼¼ä¹æ˜¯ä¸ªä¸å¯èƒ½å®Œæˆçš„ä»»åŠ¡ã€‚å¤§å¤šæ•°äººç¬¬ä¸€æ¬¡å¬åˆ°è¿™ä¸ªçš„æ—¶å€™ä¼šè¯´ï¼Œâ€œæ²¡æœ‰ if è¯­å¥æˆ‘è¯¥æ€ä¹ˆåŠï¼Ÿâ€å›ç­”æ˜¯åœ¨å¤šæ•°æƒ…å†µä¸‹éƒ½å¯ä»¥ä½¿ç”¨å¤šæ€æ¥å®ç°ç›¸åŒçš„ä»»åŠ¡ã€‚ç¬¬äºŒä¸ªé—®é¢˜é€šå¸¸æ˜¯ï¼Œâ€œé‚£å¤ªå¥½äº†ï¼Œä¸è¿‡æˆ‘ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšå‘¢ï¼Ÿâ€ç­”æ¡ˆåœ¨äºæˆ‘ä»¬ä¹‹å‰äº†è§£è¿‡æ•´æ´çš„æ¦‚å¿µï¼šä¸€ä¸ªå‡½æ•°åº”è¯¥åªåšä¸€ä»¶äº‹æƒ…ã€‚å¦‚æœä½ çš„ç±»å’Œå‡½æ•°æœ‰ if è¯­å¥ï¼Œå°±æ„å‘³ç€ä½ çš„å‡½æ•°åšäº†æ›´å¤šçš„äº‹ã€‚è®°ä½ï¼Œåªåšä¸€ä»¶äº‹ã€‚ ä¸å¥½: class Airplane { //â€¦ getCruisingAltitude() { switch (this.type) { case â€˜777â€™: return getMaxAltitude() - getPassengerCount(); case â€˜Air Force Oneâ€™: return getMaxAltitude(); case â€˜Cessnaâ€™: return getMaxAltitude() - getFuelExpenditure(); } }} å¥½: class Airplane { //â€¦} class Boeing777 extends Airplane { //â€¦ getCruisingAltitude() { return getMaxAltitude() - getPassengerCount(); }} class AirForceOne extends Airplane { //â€¦ getCruisingAltitude() { return getMaxAltitude(); }} class Cessna extends Airplane { //â€¦ getCruisingAltitude() { return getMaxAltitude() - getFuelExpenditure(); }} é¿å…ç±»å‹æ£€æŸ¥(ç¬¬1éƒ¨åˆ†)JavaScript æ˜¯æ— ç±»å‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å‡½æ•°å¯ä»¥è·å–ä»»æ„ç±»å‹çš„å‚æ•°ã€‚æœ‰æ—¶å€™ä½ ä¼šè§‰å¾—è¿™ç§è‡ªç”±æ˜¯ç§æŠ˜ç£¨ï¼Œå› è€Œä¼šä¸ç”±è‡ªä¸»åœ°åœ¨å‡½æ•°ä¸­ä½¿ç”¨ç±»å‹æ£€æŸ¥ã€‚æœ‰å¾ˆå¤šç§æ–¹æ³•å¯ä»¥é¿å…ç±»å‹æ£€æŸ¥ã€‚é¦–å…ˆè¦è€ƒè™‘çš„å°±æ˜¯ API çš„ä¸€è‡´æ€§ã€‚ ä¸å¥½: function travelToTexas(vehicle) { if (vehicle instanceof Bicycle) { vehicle.peddle(this.currentLocation, new Location(â€˜texasâ€™)); } else if (vehicle instanceof Car) { vehicle.drive(this.currentLocation, new Location(â€˜texasâ€™)); }} å¥½: function travelToTexas(vehicle) { vehicle.move(this.currentLocation, new Location(â€˜texasâ€™));} é¿å…ç±»å‹æ£€æŸ¥(ç¬¬2éƒ¨åˆ†)å¦‚æœä½ åœ¨å¤„ç†åŸºæœ¬ç±»å‹çš„æ•°æ®ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ï¼Œæ•´æ•°å’Œæ•°ç»„ï¼Œåˆä¸èƒ½ä½¿ç”¨å¤šæ€ï¼Œè¿™æ—¶ä½ ä¼šè§‰å¾—éœ€è¦ä½¿ç”¨ç±»å‹æ£€æŸ¥ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ TypeScriptã€‚è¿™æ˜¯æ™®é€š JavaScript çš„å®Œç¾æ›¿ä»£å“ï¼Œå®ƒåœ¨æ ‡å‡†çš„ JavaScript è¯­æ³•ä¹‹ä¸Šæä¾›äº†é™æ€ç±»å‹ã€‚æ™®é€š JavaScript æ‰‹å·¥æ£€æŸ¥ç±»å‹çš„é—®é¢˜åœ¨äºè¿™æ ·ä¼šå†™å¾ˆå¤šåºŸè¯ï¼Œè€Œäººä¸ºçš„â€œç±»å‹å®‰å…¨â€å¹¶ä¸èƒ½å¼¥è¡¥æŸå¤±çš„å¯è¯»æ€§ã€‚è®©ä½ çš„ JavaScript ä¿æŒæ•´æ´ï¼Œå†™å¾ˆå¥½çš„æµ‹è¯•ï¼Œå¹¶ä¿æŒè‰¯å¥½çš„ä»£ç å®¡æŸ¥ã€‚å¦åˆ™è®© TypeScript (æˆ‘è¯´è¿‡ï¼Œè¿™æ˜¯å¾ˆå¥½çš„æ›¿ä»£å“)æ¥åšæ‰€æœ‰äº‹æƒ…ã€‚ ä¸å¥½: function combine(val1, val2) { if (typeof val1 == â€œnumberâ€ &amp;&amp; typeof val2 == â€œnumberâ€ || typeof val1 == â€œstringâ€ &amp;&amp; typeof val2 == â€œstringâ€) { return val1 + val2; } else { throw new Error(â€˜Must be of type String or Numberâ€™); }} å¥½: function combine(val1, val2) { return val1 + val2;} ä¸è¦è¿‡åº¦ä¼˜åŒ–ç°åœ¨æµè§ˆå™¨åœ¨è¿è¡Œæ—¶æ‚„æ‚„åœ°åšäº†å¾ˆå¤šä¼˜åŒ–å·¥ä½œã€‚å¾ˆå¤šæ—¶å€™ä½ çš„ä¼˜åŒ–éƒ½æ˜¯åœ¨æµªè´¹æ—¶é—´ã€‚è¿™é‡Œæœ‰å¾ˆå¥½çš„èµ„æº å¯ä»¥çœ‹çœ‹å“ªäº›ä¼˜åŒ–æ¯”è¾ƒç¼ºä¹ã€‚æŠŠå®ƒä»¬ä½œä¸ºç›®æ ‡ï¼Œç›´åˆ°ä»–ä»¬èƒ½å›ºå®šä¸‹æ¥çš„æ—¶å€™ã€‚ ä¸å¥½: // åœ¨æ—§æµè§ˆå™¨ä¸­ï¼Œæ¯æ¬¡å¾ªç¯çš„æˆæœ¬éƒ½æ¯”è¾ƒé«˜ï¼Œå› ä¸ºæ¯æ¬¡éƒ½ä¼šé‡ç®— `len`ã€‚// ç°åœ¨æµè§ˆå™¨ä¸­ï¼Œè¿™å·²ç»è¢«ä¼˜åŒ–äº†ã€‚for (var i = 0, len = list.length; i &lt; len; i++) { // â€¦} å¥½: for (var i = 0; i &lt; list.length; i++) { // â€¦} åˆ é™¤ä¸ç”¨çš„ä»£ç ä¸ç”¨çš„ä»£ç å’Œé‡å¤çš„ä»£ç ä¸€æ ·ç³Ÿç³•ã€‚åœ¨ä»£ç åº“ä¸­ä¿ç•™æ— ç”¨çš„ä»£ç æ˜¯æ¯«æ— é“ç†çš„äº‹æƒ…ã€‚å¦‚æœæŸæ®µä»£ç ç”¨ä¸åˆ°ï¼Œé‚£å°±åˆ æ‰å®ƒï¼å¦‚æœä½ ä»¥åéœ€è¦å®ƒï¼Œä»ç„¶å¯ä»¥ä»ä»£ç åº“çš„å†å²ç‰ˆæœ¬ä¸­æ‰¾å‡ºæ¥ã€‚ ä¸å¥½: function oldRequestModule(url) { // â€¦} function newRequestModule(url) { // â€¦} var req = newRequestModule;inventoryTracker(â€˜applesâ€™, req, â€˜www.inventory-awesome.io&#39;); å¥½: function newRequestModule(url) { // â€¦} var req = newRequestModule;inventoryTracker(â€˜applesâ€™, req, â€˜www.inventory-awesome.io&#39;); å¯¹è±¡å’Œæ•°æ®ç»“æ„ä½¿ç”¨ getter å’Œ setterJavaScript æ²¡æœ‰æ¥å£æˆ–è€…ç±»å‹ï¼Œä¹Ÿæ²¡æœ‰åƒ public å’Œ private è¿™æ ·çš„å…³é”®å­—ï¼Œæ‰€ä»¥å¾ˆéš¾åº”ç”¨è®¾è®¡æ¨¡å¼ã€‚å®äº‹ä¸Šï¼Œåœ¨å¯¹è±¡ä¸Šä½¿ç”¨ getter å’Œ setter è®¿é—®æ•°æ®è¿œå¥½äºç›´æ¥æŸ¥æ‰¾å¯¹è±¡å±æ€§ã€‚â€œä¸ºä»€ä¹ˆï¼Ÿâ€ä½ å¯èƒ½ä¼šè¿™æ ·é—®ã€‚é‚£å¥½ï¼Œä¸‹é¢åˆ—å‡ºäº†åŸå› ï¼š ä½ æƒ³åœ¨è·å–å¯¹è±¡å±æ€§çš„æ—¶å€™åšæ›´å¤šçš„äº‹ï¼Œä¸å¿…åœ¨ä»£ç ä¸­å¯»æ‰¾æ‰€æœ‰è®¿é—®çš„ä»£ç æ¥é€ä¸ªä¿®æ”¹ã€‚ åœ¨è¿›è¡Œ set çš„æ—¶å€™å¯ä»¥è¿›è¡Œé¢å¤–çš„æ•°æ®æ£€éªŒã€‚ å°è£…å†…éƒ¨è¡¨ç°ã€‚ åœ¨è·å–æˆ–è®¾ç½®çš„æ—¶å€™æ˜“äºæ·»åŠ æ—¥å¿—å’Œé”™è¯¯å¤„ç†ã€‚ ç»§æ‰¿å½“å‰ç±»ï¼Œå¯ä»¥é‡å†™é»˜è®¤åŠŸèƒ½ã€‚ å¯ä»¥å¯¹å¯¹è±¡å±æ€§è¿›è¡Œæ‡’åŠ è½½ï¼Œæ¯”å¦‚è¯´ä»æœåŠ¡å™¨è·å–å±æ€§çš„æ•°æ®ã€‚ ä¸å¥½: class BankAccount { constructor() { this.balance = 1000; }} let bankAccount = new BankAccount(); // ä¹°é‹â€¦bankAccount.balance = bankAccount.balance - 100; å¥½: class BankAccount { constructor() { this.balance = 1000; } // It doesnâ€™t have to be prefixed with `get` or `set` to be a getter/setter withdraw(amount) { if (verifyAmountCanBeDeducted(amount)) { this.balance -= amount; } }} let bankAccount = new BankAccount(); // ä¹°é‹â€¦bankAccount.withdraw(100); è®©å¯¹è±¡æ‹¥æœ‰ç§æœ‰æˆå‘˜è¿™å¯ä»¥é€šè¿‡é—­åŒ…å®ç°(ES5ä»¥ä¹‹å‰çš„ç‰ˆæœ¬)ã€‚ ä¸å¥½: var Employee = function(name) { this.name = name;} Employee.prototype.getName = function() { return this.name;} var employee = new Employee(â€˜John Doeâ€™);console.log(â€˜Employee name: â€˜ + employee.getName()); // Employee name: John Doedelete employee.name;console.log(â€˜Employee name: â€˜ + employee.getName()); // Employee name: undefined å¥½: var Employee = (function() { function Employee(name) { this.getName = function() { return name; }; } return Employee;}()); var employee = new Employee(â€˜John Doeâ€™);console.log(â€˜Employee name: â€˜ + employee.getName()); // Employee name: John Doedelete employee.name;console.log(â€˜Employee name: â€˜ + employee.getName()); // Employee name: John Doe ç±»å•ä¸€èŒè´£åŸåˆ™ (SRP)æ­£å¦‚ã€Šä»£ç æ•´æ´ä¹‹é“ã€‹æ‰€è¯´ï¼Œâ€œä¸åº”è¯¥æœ‰è¶…è¿‡ä¸€ä¸ªåŸå› æ¥æ”¹å˜ç±»â€ã€‚å¾€ä¸€ä¸ªç±»é‡Œå¡è¿›è®¸å¤šåŠŸèƒ½æ˜¯ä»¶è¯±äººçš„äº‹æƒ…ï¼Œå°±åƒåœ¨åé£æœºçš„æ—¶å€™åªå¸¦ä¸€ä¸ªæ‰‹æç®±ä¸€æ ·ã€‚è¿™å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œä½ çš„ç±»ä¸ä¼šåœ¨æ¦‚å¿µä¸Šæœ‰å‡èšåŠ›ï¼Œä¼šæœ‰å¾ˆå¤šå› ç´ é€ æˆå¯¹å®ƒçš„æ”¹å˜ã€‚è®©ä½ çš„ç±»éœ€è¦æ”¹å˜çš„æ¬¡æ•°æœ€å°‘æ˜¯ä»¶éå¸¸é‡è¦çš„äº‹æƒ…ã€‚è¿™æ˜¯å› ä¸ºå¦‚æœä¸€ä¸ªç±»é‡Œå¡å…¥äº†å¤ªå¤šåŠŸèƒ½ï¼Œä½ åªä¿®æ”¹å®ƒçš„ä¸€éƒ¨åˆ†ï¼Œå¯èƒ½ä¼šè®©äººéš¾ä»¥ç†è§£å®ƒä¸ºä½•ä¼šå½±å“ä»£ç åº“ä¸­å…¶å®ƒç›¸å…³æ¨¡å—ã€‚ ä¸å¥½: class UserSettings { constructor(user) { this.user = user; } changeSettings(settings) { if (this.verifyCredentials(user)) { // â€¦ } } verifyCredentials(user) { // â€¦ }} å¥½: class UserAuth { constructor(user) { this.user = user; } verifyCredentials() { // â€¦ }} class UserSettings { constructor(user) { this.user = user; this.auth = new UserAuth(user) } changeSettings(settings) { if (this.auth.verifyCredentials()) { // â€¦ } }} å¼€æ”¾å°è£…åŸåˆ™(OCP)æ­£å¦‚ Bertrand Meyer æ‰€è¯´ï¼Œâ€œè½¯ä»¶å®ä½“(ç±»ã€æ¨¡å—ã€å‡½æ•°ç­‰)åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­ã€‚â€è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿè¿™ä¸ªåŸåˆ™åŸºæœ¬ä¸Šè§„å®šäº†ä½ åº”è¯¥å…è®¸ç”¨æˆ·æ‰©å±•ä½ çš„æ¨¡å—ï¼Œä½†ä¸éœ€è¦æ‰“å¼€ .js æºä»£ç æ–‡ä»¶æ¥è¿›è¡Œç¼–è¾‘ã€‚ ä¸å¥½: class AjaxRequester { constructor() { // å¦‚æœæˆ‘ä»¬éœ€è¦å¦ä¸€ä¸ª HTTP æ–¹æ³•ï¼Œæ¯”å¦‚ DELETEï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ // æˆ‘ä»¬å¿…é¡»æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ç„¶åæ‰‹å·¥æŠŠå®ƒåŠ è¿›å» this.HTTP_METHODS = [â€˜POSTâ€™, â€˜PUTâ€™, â€˜GETâ€™]; } get(url) { // â€¦ } } å¥½: class AjaxRequester { constructor() { this.HTTP_METHODS = [â€˜POSTâ€™, â€˜PUTâ€™, â€˜GETâ€™]; } get(url) { // â€¦ } addHTTPMethod(method) { this.HTTP_METHODS.push(method); }} é‡Œæ°æ›¿æ¢åŸåˆ™(LSP)è¿™æ˜¯ä¸€ä¸ªå“äººçš„æœ¯è¯­ï¼Œä½†æè¿°çš„å´æ˜¯ä¸ªç®€å•çš„æ¦‚å¿µã€‚å®ƒçš„æ­£å¼å®šä¹‰ä¸ºâ€œå¦‚æœ S æ˜¯ T çš„å­ç±»ï¼Œé‚£æ‰€æœ‰ T ç±»å‹çš„å¯¹è±¡éƒ½å¯ä»¥æ›¿æ¢ä¸º S ç±»å‹çš„å¯¹è±¡(å³ S ç±»å‹çš„å¯¹è±¡å¯ä»¥æ›¿ä»£ T ç±»å‹çš„å¯¹è±¡)ï¼Œè¿™ä¸ªæ›¿æ¢ä¸ä¼šæ”¹å˜ç¨‹åºçš„ä»»ä½•æ€§è´¨(æ­£ç¡®æ€§ã€ä»»åŠ¡æ‰§è¡Œç­‰)ã€‚â€è¿™ç¡®å®æ˜¯ä¸ªå“äººçš„å®šä¹‰ã€‚ å¯¹æ­¤æœ€å¥½çš„è§£é‡Šæ˜¯ï¼Œå¦‚æœä½ æœ‰çˆ¶ç±»å’Œå­ç±»ï¼Œé‚£ä¹ˆçˆ¶ç±»å’Œå­ç±»å¯ä»¥äº¤æ›¿ä½¿ç”¨è€Œä¸ä¼šé€ æˆä¸æ­£ç¡®çš„ç»“æœã€‚è¿™å¯èƒ½ä»ç„¶è®©äººæ„Ÿåˆ°ç–‘æƒ‘ï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬çœ‹çœ‹ç»å…¸çš„æ­£æ–¹å½¢å’ŒçŸ©å½¢çš„ä¾‹å­ã€‚åœ¨æ•°å­¦ä¸Šï¼Œæ­£æ–¹å½¢ä¹Ÿæ˜¯çŸ©å½¢ï¼Œä½†æ˜¯å¦‚æœä½ åœ¨æ¨¡å‹ä¸­é€šè¿‡ç»§æ‰¿ä½¿ç”¨ â€œis-aâ€ å…³ç³»ï¼Œä½ å¾ˆå¿«å°±ä¼šé™·å…¥å›°å¢ƒã€‚ ä¸å¥½: class Rectangle { constructor() { this.width = 0; this.height = 0; } setColor(color) { // â€¦ } render(area) { // â€¦ } setWidth(width) { this.width = width; } setHeight(height) { this.height = height; } getArea() { return this.width * this.height; }} class Square extends Rectangle { constructor() { super(); } setWidth(width) { this.width = width; this.height = width; } setHeight(height) { this.width = height; this.height = height; }} function renderLargeRectangles(rectangles) { rectangles.forEach((rectangle) =&gt; { rectangle.setWidth(4); rectangle.setHeight(5); let area = rectangle.getArea(); // ä¸å¥½ï¼šè¿™é‡Œå¯¹æ­£æ–¹å½¢ä¼šè¿”å› 25ï¼Œä½†åº”è¯¥æ˜¯ 20. rectangle.render(area); })} let rectangles = [new Rectangle(), new Rectangle(), new Square()];renderLargeRectangles(rectangles); å¥½: class Shape { constructor() {} setColor(color) { // â€¦ } render(area) { // â€¦ }} class Rectangle extends Shape { constructor() { super(); this.width = 0; this.height = 0; } setWidth(width) { this.width = width; } setHeight(height) { this.height = height; } getArea() { return this.width * this.height; }} class Square extends Shape { constructor() { super(); this.length = 0; } setLength(length) { this.length = length; } getArea() { return this.length * this.length; }} function renderLargeShapes(shapes) { shapes.forEach((shape) =&gt; { switch (shape.constructor.name) { case â€˜Squareâ€™: shape.setLength(5); case â€˜Rectangleâ€™: shape.setWidth(4); shape.setHeight(5); } let area = shape.getArea(); shape.render(area); })} let shapes = [new Rectangle(), new Rectangle(), new Square()];renderLargeShapes(shapes); æ¥å£éš”ç¦»åŸåˆ™(ISP)JavaScript ä¸­æ²¡æœ‰æ¥å£ï¼Œæ‰€ä»¥å®è¡Œè¿™ä¸ªåŸåˆ™ä¸èƒ½åƒå…¶å®ƒè¯­è¨€é‚£æ ·ä¸¥æ ¼ã€‚ç„¶è€Œå³ä½¿å¯¹ JavaScript çš„å¼±ç±»å‹ç³»ç»Ÿæ¥è¯´ï¼Œå®ƒä»ç„¶æ˜¯é‡è¦çš„ç›¸å…³ã€‚ ISP æŒ‡å‡ºï¼Œâ€œå®¢æˆ·ä¸åº”è¯¥ä¾èµ–äºé‚£äº›ä»–ä»¬ä¸ä½¿ç”¨çš„æ¥å£ã€‚â€ ç”±äº Duck Typing ç†è®ºï¼Œæ¥å£åœ¨ JavaScript ä¸­æ˜¯ä¸ªéšæ€§å¥‘çº¦ã€‚ åœ¨ JavaScript ä¸­æœ‰ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ¥æ¼”ç¤ºè¿™ä¸ªåŸåˆ™ï¼Œå³ä¸€ä¸ªæ‹¥æœ‰å·¨å¤§è®¾ç½®å¯¹è±¡çš„ç±»ã€‚æ¯”è¾ƒå¥½çš„åšæ³•æ˜¯ä¸è¦æ±‚å®¢æˆ·è®¾ç½®å¤§é‡çš„é€‰é¡¹ï¼Œå› ä¸ºå¤šæ•°æ—¶å€™ä»–ä»¬ä¸éœ€è¦æ‰€æœ‰è®¾ç½®ã€‚è®©è¿™äº›é€‰é¡¹æˆä¸ºå¯é€‰çš„æœ‰åŠ©äºé˜²æ­¢â€œèƒ–æ¥å£â€ã€‚ ä¸å¥½: class DOMTraverser { constructor(settings) { this.settings = settings; this.setup(); } setup() { this.rootNode = this.settings.rootNode; this.animationModule.setup(); } traverse() { // â€¦ }} let $ = new DOMTraverser({ rootNode: document.getElementsByTagName(â€˜bodyâ€™), animationModule: function() {} // å¤šæ•°æ—¶å€™æˆ‘ä»¬ä¸éœ€è¦åŠ¨ç”» // â€¦}); å¥½: class DOMTraverser { constructor(settings) { this.settings = settings; this.options = settings.options; this.setup(); } setup() { this.rootNode = this.settings.rootNode; this.setupOptions(); } setupOptions() { if (this.options.animationModule) { // â€¦ } } traverse() { // â€¦ }} let $ = new DOMTraverser({ rootNode: document.getElementsByTagName(â€˜bodyâ€™), options: { animationModule: function() {} }}); ä¾èµ–å€’ç½®åŸåˆ™(DIP)è¿™ä¸ªåŸåˆ™è¯´æ˜äº†ä¸¤ä¸ªåŸºæœ¬é—®é¢˜ï¼š 1. ä¸Šå±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä¸‹å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚ 2. æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºå…·ä½“å®ç°ï¼Œå…·ä½“å®ç°åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚ è¿™ä¸€å¼€å§‹å¯èƒ½å¾ˆéš¾ç†è§£ï¼Œä½†æ˜¯å¦‚æœä½ ä½¿ç”¨ Angular.jsï¼Œä½ å·²ç»çœ‹åˆ°äº†å¯¹è¿™ä¸ªåŸåˆ™çš„ä¸€ç§å®ç°å½¢å¼ï¼šä¾èµ–æ³¨å…¥(DI)ã€‚è™½ç„¶å®ƒä»¬ä¸æ˜¯å®Œå…¨ç›¸åŒçš„æ¦‚å¿µï¼ŒDIP é˜»æ­¢ä¸Šå±‚æ¨¡å—å»äº†è§£ä¸‹å±‚æ¨¡å—çš„ç»†èŠ‚å¹¶è®¾ç½®å®ƒä»¬ã€‚å®ƒå¯ä»¥é€šè¿‡ DI æ¥å®ç°ã€‚è¿™å¸¦æ¥çš„å·¨å¤§å¥½å¤„é™ä½äº†æ¨¡å—é—´çš„è€¦åˆã€‚è€¦åˆæ˜¯ç§éå¸¸ä¸å¥½çš„å¼€å‘æ¨¡å¼ï¼Œå› ä¸ºå®ƒè®©ä»£ç éš¾ä»¥é‡æ„ã€‚ å‰æå·²ç»æåˆ°ï¼ŒJavaScript æ²¡æœ‰æ¥å£ï¼Œå› æ­¤æŠ½è±¡ä¾èµ–äºéšæ€§å¥‘çº¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå¯¹è±¡/ç±»ä¼šæŠŠæ–¹æ³•å’Œå±æ€§æš´éœ²ç»™å¦ä¸€ä¸ªå¯¹è±¡/ç±»ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œéšæ€§å¥‘çº¦æ˜¯ä»»ä½•ç”¨äº InventoryTracker çš„ Request æ¨¡å—éƒ½åº”è¯¥æ‹¥æœ‰ requestItems æ–¹æ³•ã€‚ ä¸å¥½: class InventoryTracker { constructor(items) { this.items = items; // ä¸å¥½ï¼šæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªä¾èµ–äºç‰¹å®šè¯·æ±‚çš„å®ç°ã€‚ // æˆ‘ä»¬åº”è¯¥åªä¾èµ–è¯·æ±‚æ–¹æ³•ï¼š\\`request\\` çš„ requestItems this.requester = new InventoryRequester(); } requestItems() { this.items.forEach((item) =&gt; { this.requester.requestItem(item); }); }} class InventoryRequester { constructor() { this.REQ_METHODS = [â€˜HTTPâ€™]; } requestItem(item) { // â€¦ }} let inventoryTracker = new InventoryTracker([â€˜applesâ€™, â€˜bananasâ€™]);inventoryTracker.requestItems(); å¥½: class InventoryTracker { constructor(items, requester) { this.items = items; this.requester = requester; } requestItems() { this.items.forEach((item) =&gt; { this.requester.requestItem(item); }); }} class InventoryRequesterV1 { constructor() { this.REQ_METHODS = [â€˜HTTPâ€™]; } requestItem(item) { // â€¦ }} class InventoryRequesterV2 { constructor() { this.REQ_METHODS = [â€˜WSâ€™]; } requestItem(item) { // â€¦ }} // é€šè¿‡æ„å»ºå¤–éƒ¨ä¾èµ–å¹¶æ³¨å…¥å®ƒä»¬ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“æŠŠè¯·æ±‚æ¨¡å—æ›¿æ¢æˆ// ä¸€ä¸ªä½¿ç”¨ WebSocket çš„æ–°æ¨¡å—ã€‚let inventoryTracker = new InventoryTracker([â€˜applesâ€™, â€˜bananasâ€™], new InventoryRequesterV2());inventoryTracker.requestItems(); å¤šç”¨ ES6 ç±»è¯­æ³•ï¼Œå°‘ç”¨ ES5 æ„é€ å‡½æ•°è¯­æ³•åœ¨ç»å…¸çš„ ES5 çš„ç±»å®šä¹‰ä¸­ï¼Œå¾ˆéš¾æ‰¾åˆ°æ˜“è¯»çš„ç»§æ‰¿ã€æ„é€ ã€æ–¹æ³•å®šä¹‰ç­‰ã€‚å¦‚æœä½ éœ€è¦ç»§æ‰¿(ä½ ä¼šå‘ç°åšä¸åˆ°)ï¼Œé‚£å°±åº”è¯¥ä½¿ç”¨ç±»è¯­æ³•ã€‚ä¸è¿‡ï¼Œåº”è¯¥å°½å¯èƒ½ä½¿ç”¨å°å‡½æ•°è€Œä¸æ˜¯ç±»ï¼Œç›´åˆ°ä½ éœ€è¦æ›´å¤§æ›´å¤æ‚çš„å¯¹è±¡ã€‚ ä¸å¥½: var Animal = function(age) { if (!(this instanceof Animal)) { throw new Error(â€œInstantiate Animal with `new`â€œ); } this.age = age; }; Animal.prototype.move = function() {}; var Mammal = function(age, furColor) { if (!(this instanceof Mammal)) { throw new Error(â€œInstantiate Mammal with `new`â€œ); } Animal.call(this, age); this.furColor = furColor; }; Mammal.prototype = Object.create(Animal.prototype);Mammal.prototype.constructor = Mammal;Mammal.prototype.liveBirth = function() {}; var Human = function(age, furColor, languageSpoken) { if (!(this instanceof Human)) { throw new Error(â€œInstantiate Human with `new`â€œ); } Mammal.call(this, age, furColor); this.languageSpoken = languageSpoken; }; Human.prototype = Object.create(Mammal.prototype);Human.prototype.constructor = Human;Human.prototype.speak = function() {}; å¥½: class Animal { constructor(age) { this.age = age; } move() {} } class Mammal extends Animal { constructor(age, furColor) { super(age); this.furColor = furColor; } liveBirth() {} } class Human extends Mammal { constructor(age, furColor, languageSpoken) { super(age, furColor); this.languageSpoken = languageSpoken; } speak() {} } ä½¿ç”¨æ–¹æ³•é“¾åœ¨è¿™é‡Œæˆ‘çš„æ„è§ä¸ã€Šä»£ç æ•´æ´ä¹‹é“ã€‹çš„è§‚ç‚¹ä¸åŒã€‚æœ‰äººè®¤ä¸ºæ–¹æ³•é“¾ä¸æ•´æ´ï¼Œè€Œä¸”è¿åäº†å¾—å¢¨å¿’è€³å®šå¾‹ã€‚ä¹Ÿè®¸ä»–ä»¬æ˜¯å¯¹çš„ï¼Œä½†è¿™ä¸ªæ¨¡å¼åœ¨ JavaScript ä¸­éå¸¸æœ‰ç”¨ï¼Œä½ å¯ä»¥å¾ˆå¤šåº“ä¸­çœ‹åˆ°ï¼Œæ¯”å¦‚ jQuery å’Œ Lodashã€‚å®ƒè®©ä»£ç å˜å¾—æ—¢ç®€æ´åˆæœ‰è¡¨ç°åŠ›ã€‚åœ¨ç±»ä¸­ï¼Œåªéœ€è¦åœ¨æ¯ä¸ªå‡½æ•°ç»“æŸå‰è¿”å› thisï¼Œå°±å®ç°äº†é“¾å¼è°ƒç”¨çš„ç±»æ–¹æ³•ã€‚ ä¸å¥½: class Car { constructor() { this.make = â€˜Hondaâ€™; this.model = â€˜Accordâ€™; this.color = â€˜whiteâ€™; } setMake(make) { this.name = name; } setModel(model) { this.model = model; } setColor(color) { this.color = color; } save() { console.log(this.make, this.model, this.color); }} let car = new Car();car.setColor(â€˜pinkâ€™);car.setMake(â€˜Fordâ€™);car.setModel(â€˜F-150â€™)car.save(); å¥½: class Car { constructor() { this.make = â€˜Hondaâ€™; this.model = â€˜Accordâ€™; this.color = â€˜whiteâ€™; } setMake(make) { this.name = name; // NOTE: è¿”å› this ä»¥å®ç°é“¾å¼è°ƒç”¨ return this; } setModel(model) { this.model = model; // NOTE: è¿”å› this ä»¥å®ç°é“¾å¼è°ƒç”¨ return this; } setColor(color) { this.color = color; // NOTE: è¿”å› this ä»¥å®ç°é“¾å¼è°ƒç”¨ return this; } save() { console.log(this.make, this.model, this.color); }} let car = new Car() .setColor(â€˜pinkâ€™) .setMake(â€˜Fordâ€™) .setModel(â€˜F-150â€™) .save(); å¤šç”¨ç»„åˆï¼Œå°‘ç”¨ç»§æ‰¿å¤§å®¶éƒ½çŸ¥é“ GoF çš„è®¾è®¡æ¨¡å¼ï¼Œå…¶ä¸­æåˆ°åº”è¯¥å¤šç”¨ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿ã€‚å¯¹äºç»§æ‰¿å’Œç»„åˆï¼Œéƒ½æœ‰å¤§é‡çš„ç†ç”±åœ¨æ”¯æ’‘ï¼Œä½†è¿™ä¸ªå‡†åˆ™çš„è¦ç‚¹åœ¨äºï¼Œä½ çš„æƒ³æ³•æœ¬èƒ½åœ°ä¼šæƒ³åˆ°ç»§æ‰¿ï¼Œä½†è¿™æ—¶å€™ä¸é˜²å¤šæ€è€ƒä¸€ä¸‹ç”¨ç»„åˆæ˜¯å¦èƒ½æ›´å¥½çš„å¤„ç†é—®é¢˜â€”â€”æŸäº›æ—¶å€™ï¼Œçš„ç¡®èƒ½ã€‚ ä½ å¯èƒ½ä¼šè€ƒè™‘ï¼šâ€œæˆ‘ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ç»§æ‰¿ï¼Ÿâ€è¿™å–å†³äºä½ é‡åˆ°çš„é—®é¢˜ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¸é”™çš„æ¸…å•è¯´æ˜äº†ä»€ä¹ˆæ—¶å€™ç”¨ç»§æ‰¿æ¯”ç”¨ç»„åˆæ›´åˆé€‚ï¼š ä½ çš„ç»§æ‰¿æ˜¯ä¸€ä¸ªâ€œis-aâ€å…³ç³»ï¼Œè€Œä¸æ˜¯â€œhas-aâ€å…³ç³»(Animal-&gt;Human å¯¹æ¯” User-&gt;UserDetails)ã€‚ å¯ä»¥ä»åŸºç¡€å¤ç”¨ä»£ç  (äººå¯ä»¥åƒæ‰€æœ‰åŠ¨ç‰©ä¸€æ ·ç§»åŠ¨)ã€‚ ä½ æƒ³é€šè¿‡ä¿®æ”¹åŸºç¡€æ¥å®ç°å¯¹æ‰€æœ‰å­ç±»çš„å…¨å±€æ€§æ›´æ”¹ã€‚(æ”¹å˜åŠ¨ç‰©ç§»åŠ¨æ—¶çš„çƒ­é‡æ¶ˆè€—)ã€‚ ä¸å¥½: class Employee { constructor(name, email) { this.name = name; this.email = email; } // â€¦} // è¿™æ ·ä¸å¥½ï¼Œå› ä¸º Employees â€œæ‹¥æœ‰â€ ç¨åŠ¡æ•°æ®ã€‚EmployeeTaxData ä¸æ˜¯å±äº Employee çš„ä¸€ä¸ªç±»å‹class EmployeeTaxData extends Employee { constructor(ssn, salary) { super(); this.ssn = ssn; this.salary = salary; } // â€¦} å¥½: class Employee { constructor(name, email) { this.name = name; this.email = email; } setTaxData(ssn, salary) { this.taxData = new EmployeeTaxData(ssn, salary); } // â€¦} class EmployeeTaxData { constructor(ssn, salary) { this.ssn = ssn; this.salary = salary; } // â€¦} æµ‹è¯•æµ‹è¯•æ¯”ç”Ÿäº§æ›´é‡è¦ã€‚å¦‚æœä½ ä¸è¿›è¡Œæµ‹è¯•ï¼Œæˆ–è€…æµ‹è¯•çš„é‡ä¸å¤Ÿï¼Œé‚£ä½ å°±ä¸èƒ½è‚¯å®šä½ å†™çš„ä»£ç ä¸ä¼šé€ æˆç ´åã€‚æµ‹è¯•æ•°é‡ä¾é ä½ çš„å¼€å‘å›¢é˜Ÿæ¥å†³å®šï¼Œä½† 100% è¦†ç›–ç‡(æ‰€æœ‰è¯­å¥å’Œåˆ†æ”¯)èƒ½è®©ä½ æ‹¥æœ‰å·¨å¤§çš„ä¿¡å¿ƒï¼Œä¹Ÿèƒ½ä½¿ç¨‹åºå‘˜ä»¬å®‰å¿ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ éœ€è¦ä¸€ä¸ªä¸é”™çš„æµ‹è¯•æ¡†æ¶ï¼Œè¿˜éœ€è¦ä¸€ä¸ªå¥½çš„è¦†ç›–æ£€æŸ¥å·¥å…·. æ²¡æœ‰ä»€ä¹ˆç†ç”±å¯ä»¥è®©ä½ ä¸å†™æµ‹è¯•ã€‚è¿™é‡Œæœ‰ å¤§é‡ä¸é”™çš„ JS æµ‹è¯•æ¡†æ¶ï¼Œå¯ä»¥å»æ‰¾ä¸ªä½ ä»¬å›¢é˜Ÿå–œæ¬¢çš„æ¥ç”¨ã€‚å¦‚æœä½ æ‰¾ä¸€ä¸ªé€‚åˆåœ¨ä½ çš„å›¢é˜Ÿä¸­ä½¿ç”¨çš„å·¥ä½œï¼Œå°±æŠŠä¸ºæ¯ä¸ªæ–°äº§ç”Ÿçš„ç‰¹æ€§/æ–¹æ³•æ·»åŠ æµ‹è¯•ä½œä¸ºç›®æ ‡ã€‚å¦‚æœä½ å–œæ¬¢æµ‹è¯•é©±åŠ¨å¼€å‘(TDD)çš„æ–¹æ³•ï¼Œéå¸¸å¥½ï¼Œä½†è¦æ³¨æ„åœ¨è®©ä½ çš„æµ‹è¯•è¦†ç›–æ‰€æœ‰ç‰¹æ€§ï¼Œæˆ–è€…é‡æ„è¿‡çš„ä»£ç ã€‚ æ¯æ¬¡æµ‹è¯•ä¸€ä¸ªæ¦‚å¿µä¸å¥½: const assert = require(â€˜assertâ€™); describe(â€˜MakeMomentJSGreatAgainâ€™, function() { it(â€˜handles date boundariesâ€™, function() { let date; date = new MakeMomentJSGreatAgain(&apos;1/1/2015&apos;); date.addDays(30); date.shouldEqual(&apos;1/31/2015&apos;); date = new MakeMomentJSGreatAgain(&apos;2/1/2016&apos;); date.addDays(28); assert.equal(&apos;02/29/2016&apos;, date); date = new MakeMomentJSGreatAgain(&apos;2/1/2015&apos;); date.addDays(28); assert.equal(&apos;03/01/2015&apos;, date); });}); å¥½: const assert = require(â€˜assertâ€™); describe(â€˜MakeMomentJSGreatAgainâ€™, function() { it(â€˜handles 30-day monthsâ€™, function() { let date = new MakeMomentJSGreatAgain(â€˜1/1/2015â€™); date.addDays(30); date.shouldEqual(â€˜1/31/2015â€™); }); it(â€˜handles leap yearâ€™, function() { let date = new MakeMomentJSGreatAgain(â€˜2/1/2016â€™); date.addDays(28); assert.equal(â€˜02/29/2016â€™, date); }); it(â€˜handles non-leap yearâ€™, function() { let date = new MakeMomentJSGreatAgain(â€˜2/1/2015â€™); date.addDays(28); assert.equal(â€˜03/01/2015â€™, date); });}); å¹¶å‘ä½¿ç”¨ Promise è€Œä¸æ˜¯å›è°ƒå›è°ƒå¹¶ä¸æ•´æ´ï¼Œå®ƒä¼šå¯¼è‡´è¿‡å¤šçš„åµŒå¥—ã€‚ES6 çš„ Promise æ˜¯ä¸ªå†…ç½®çš„å…¨å±€ç±»å‹ã€‚ä½¿ç”¨å®ƒï¼ ä¸å¥½: require(â€˜requestâ€™).get(â€˜https://en.wikipedia.org/wiki/Robert\\_Cecil\\_Martin&#39;, function(err, response) { if (err) { console.error(err); } else { require(â€˜fsâ€™).writeFile(â€˜article.htmlâ€™, response.body, function(err) { if (err) { console.error(err); } else { console.log(â€˜File writtenâ€™); } }) }}) å¥½: require(â€˜request-promiseâ€™).get(â€˜https://en.wikipedia.org/wiki/Robert\\_Cecil\\_Martin&#39;) .then(function(response) { return require(â€˜fs-promiseâ€™).writeFile(â€˜article.htmlâ€™, response); }) .then(function() { console.log(â€˜File writtenâ€™); }) .catch(function(err) { console.error(err); }) async/await æ¯” Promise è¿˜æ•´æ´ä¸å›è°ƒç›¸å½“ï¼ŒPromise å·²ç»ç›¸å½“æ•´æ´äº†ï¼Œä½† ES7 å¸¦æ¥äº†æ›´æ•´æ´çš„è§£å†³æ–¹æ¡ˆ â€”â€” async å’Œ awaitã€‚ä½ è¦åšçš„äº‹æƒ…å°±æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°å‰åŠ ä¸Š async å…³é”®å­—ï¼Œç„¶åå†™ä¸‹å‘½ä»¤å½¢å¼çš„é€»è¾‘ï¼Œè€Œä¸å†éœ€è¦ then é“¾ã€‚ç°åœ¨å¯ä»¥ä½¿ç”¨è¿™ä¸ª ES7 ç‰¹æ€§å¸¦æ¥çš„ä¾¿åˆ©ï¼ ä¸å¥½: require(â€˜request-promiseâ€™).get(â€˜https://en.wikipedia.org/wiki/Robert\\_Cecil\\_Martin&#39;) .then(function(response) { return require(â€˜fs-promiseâ€™).writeFile(â€˜article.htmlâ€™, response); }) .then(function() { console.log(â€˜File writtenâ€™); }) .catch(function(err) { console.error(err); }) å¥½: async function getCleanCodeArticle() { try { var request = await require(â€˜request-promiseâ€™) var response = await request.get(â€˜https://en.wikipedia.org/wiki/Robert\\_Cecil\\_Martin&#39;); var fileHandle = await require(â€˜fs-promiseâ€™); await fileHandle.writeFile(&apos;article.html&apos;, response); console.log(&apos;File written&apos;); } catch(err) { console.log(err); } } é”™è¯¯å¤„ç†æŠ›å‡ºé”™è¯¯æ˜¯ä»¶å¥½äº‹ï¼è¿™è¡¨ç¤ºè¿è¡Œæ—¶å·²ç»æˆåŠŸæ£€æµ‹åˆ°ç¨‹åºå‡ºé”™äº†ï¼Œå®ƒåœæ­¢å½“å‰è°ƒç”¨æ¡†ä¸Šçš„å‡½æ•°æ‰§è¡Œï¼Œå¹¶ä¸­æ­¢è¿›ç¨‹(åœ¨ Node ä¸­)ï¼Œæœ€ååœ¨æ§åˆ¶å°é€šçŸ¥ä½ ï¼Œå¹¶è¾“å‡ºæ ˆè·Ÿè¸ªä¿¡æ¯ã€‚ ä¸è¦å¿½ç•¥æ•æ‰åˆ°çš„é”™è¯¯æ•æ‰åˆ°é”™è¯¯å´ä»€ä¹ˆä¹Ÿä¸é”™ï¼Œä½ å°±å¤±å»äº†çº æ­£é”™è¯¯çš„æœºä¼šã€‚å¤šæ•°æƒ…å†µä¸‹æŠŠé”™è¯¯è®°å½•åˆ°æ§åˆ¶å°(console.log)ä¹Ÿä¸æ¯”å¿½ç•¥å®ƒå¥½å¤šå°‘ï¼Œå› ä¸ºåœ¨å°‘é‡çš„æ§åˆ¶å°ä¿¡æ¯ä¸­å¾ˆéš¾å‘ç°è¿™ä¸€æ¡ã€‚å¦‚æœå°è¯•åœ¨ try/catch ä¸­å°è£…ä»£ç ï¼Œå°±æ„å‘³ç€ä½ çŸ¥é“è¿™é‡Œå¯èƒ½å‘ç”Ÿé”™ï¼Œä½ åº”è¯¥åœ¨é”™è¯¯å‘ç”Ÿçš„æ—¶å€™æœ‰åº”å¯¹çš„è®¡åˆ’ã€æˆ–è€…å¤„ç†åŠæ³•ã€‚ ä¸å¥½: try { functionThatMightThrow();} catch (error) { console.log(error);} å¥½: try { functionThatMightThrow();} catch (error) { // é€‰æ‹©ä¹‹ä¸€(æ¯” console.log æ›´é—¹å¿ƒ)ï¼š console.error(error); // å¦ä¸€ä¸ªé€‰æ‹©ï¼š notifyUserOfError(error); // å¦ä¸€ä¸ªé€‰æ‹©ï¼š reportErrorToService(error); // æˆ–è€…æ‰€æœ‰ä¸Šè¿°ä¸‰ç§é€‰æ‹©ï¼} ä¸è¦å¿½è§†è¢«æ‹’ç»çš„Promiseè¿™ä¸€æ¡ä¸ä¸è¦å¿½ç•¥ä» try/catch æ•æ‰åˆ°çš„é”™è¯¯æœ‰ç›¸åŒçš„åŸå› ã€‚ ä¸å¥½: getdata().then(data =&gt; { functionThatMightThrow(data);}).catch(error =&gt; { console.log(error);}); å¥½: getdata().then(data =&gt; { functionThatMightThrow(data);}).catch(error =&gt; { // é€‰æ‹©ä¹‹ä¸€(æ¯” console.log æ›´é—¹å¿ƒ)ï¼š console.error(error); // å¦ä¸€ä¸ªé€‰æ‹©ï¼š notifyUserOfError(error); // å¦ä¸€ä¸ªé€‰æ‹©ï¼š reportErrorToService(error); // æˆ–è€…æ‰€æœ‰ä¸Šè¿°ä¸‰ç§é€‰æ‹©ï¼}); æ ¼å¼æ ¼å¼æ˜¯ä¸ªå¾ˆä¸»è§‚çš„ä¸œè¥¿ï¼Œåƒè¿™é‡Œæåˆ°çš„è®¸å¤šè§„åˆ™ä¸€ï¼Œä½ ä¸å¿…å®Œå…¨éµå¾ªã€‚è¦ç‚¹ä¸åœ¨äºäº‰è®ºæ ¼å¼ã€‚å¤§é‡å·¥å…· å¯ä»¥è‡ªåŠ¨å¤„ç†ä¼˜åŒ–æ ¼å¼ã€‚ç”¨ä¸€ä¸ªï¼è®©å·¥ç¨‹å¸ˆäº‰è®ºæ ¼å¼é—®é¢˜ç®€ç›´å°±æ˜¯åœ¨æµªè´¹æ—¶é—´å’Œé‡‘é’±ã€‚ å¯¹äºé‚£äº›ä¸èƒ½è‡ªåŠ¨å¤„ç†çš„æ ¼å¼(å¯ä»¥è‡ªåŠ¨å¤„ç†çš„åŒ…æ‹¬ç¼©è¿›ã€Tabæˆ–ç©ºæ ¼ã€åŒå¼•å·æˆ–å•å¼•ç”¨ç­‰)ï¼Œå°±çœ‹çœ‹è¿™é‡Œçš„æŒ‡å¯¼ã€‚ ä½¿ç”¨ä¸€è‡´çš„å¤§å°å†™JavaScript æ˜¯æ— ç±»å‹çš„ï¼Œæ‰€ä»¥å¤§å°å†™å¯ä»¥å¸®åŠ©ä½ äº†è§£å˜é‡ã€å‡½æ•°ç­‰ã€‚è¿™äº›è§„åˆ™å…·æœ‰è¾ƒå¼ºçš„ä¸»è§‚æ€§ï¼Œæ‰€ä»¥ä½ çš„å›¢é˜Ÿåº”è¯¥é€‰æ‹©éœ€è¦çš„ã€‚é‡ç‚¹ä¸åœ¨äºä½ é€‰æ‹©äº†ä»€ä¹ˆï¼Œè€Œåœ¨äºè¦å§‹ç»ˆä¿æŒä¸€è‡´ã€‚ ä¸å¥½: var DAYS_IN_WEEK = 7;var daysInMonth = 30; var songs = [â€˜Back In Blackâ€™, â€˜Stairway to Heavenâ€™, â€˜Hey Judeâ€™];var Artists = [â€˜ACDCâ€™, â€˜Led Zeppelinâ€™, â€˜The Beatlesâ€™]; function eraseDatabase() {}function restore_database() {} class animal {}class Alpaca {} å¥½: var DAYS_IN_WEEK = 7;var DAYS_IN_MONTH = 30; var songs = [â€˜Back In Blackâ€™, â€˜Stairway to Heavenâ€™, â€˜Hey Judeâ€™];var artists = [â€˜ACDCâ€™, â€˜Led Zeppelinâ€™, â€˜The Beatlesâ€™]; function eraseDatabase() {}function restoreDatabase() {} class Animal {}class Alpaca {} å‡½æ•°è°ƒç”¨è€…å’Œè¢«è°ƒç”¨è€…åº”è¯¥å°½å¯èƒ½æ”¾åœ¨ä¸€èµ·å¦‚æœä¸€ä¸ªå‡½æ•°è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°ï¼Œé‚£åº”è¯¥è®©ä»–ä»¬åœ¨æºæ–‡ä»¶ä¸­çš„ä½ç½®éå¸¸æ¥è¿‘ã€‚ç†æƒ³æƒ…å†µä¸‹åº”è¯¥æŠŠè°ƒç”¨è€…æ”¾åœ¨è¢«è°ƒç”¨è€…çš„æ­£ä¸Šæ–¹ï¼Œè¿™ä¼šè®©ä½ çš„ä»£ç æ›´æ˜“è¯»ï¼Œå› ä¸ºæˆ‘ä»¬éƒ½ä¹ æƒ¯ä»ä¸Šå¾€ä¸‹è¯»ä»£ç ï¼Œå°±åƒè¯»æŠ¥çº¸é‚£æ ·ã€‚ ä¸å¥½: class PerformanceReview { constructor(employee) { this.employee = employee; } lookupPeers() { return db.lookup(this.employee, â€˜peersâ€™); } lookupMananger() { return db.lookup(this.employee, â€˜managerâ€™); } getPeerReviews() { let peers = this.lookupPeers(); // â€¦ } perfReview() { getPeerReviews(); getManagerReview(); getSelfReview(); } getManagerReview() { let manager = this.lookupManager(); } getSelfReview() { // â€¦ }} let review = new PerformanceReview(user);review.perfReview(); å¥½: class PerformanceReview { constructor(employee) { this.employee = employee; } perfReview() { getPeerReviews(); getManagerReview(); getSelfReview(); } getPeerReviews() { let peers = this.lookupPeers(); // â€¦ } lookupPeers() { return db.lookup(this.employee, â€˜peersâ€™); } getManagerReview() { let manager = this.lookupManager(); } lookupMananger() { return db.lookup(this.employee, â€˜managerâ€™); } getSelfReview() { // â€¦ }} let review = new PerformanceReview(employee);review.perfReview(); æ³¨é‡Šåªæ³¨é‡Šä¸šåŠ¡é€»è¾‘å¤æ‚çš„å†…å®¹æ³¨é‡Šæ˜¯ç”¨æ¥è§£é‡Šä»£ç çš„ï¼Œè€Œä¸æ˜¯å¿…é¡»çš„ã€‚å¥½çš„ä»£ç åº”è¯¥ è‡ªæ³¨é‡Šã€‚ ä¸å¥½: function hashIt(data) { // Hash ç  var hash = 0; // å­—ç¬¦ä¸²é•¿åº¦ var length = data.length; // éå†æ•°æ®ä¸­æ‰€æœ‰å­—ç¬¦ for (var i = 0; i &lt; length; i++) { // è·å–å­—ç¬¦ç¼–ç  var char = data.charCodeAt(i); // ç”Ÿæˆ Hash hash = ((hash &lt;&lt; 5) - hash) + char; // è½¬æ¢ä¸º32ä½æ•´æ•° hash = hash &amp; hash; }} å¥½: function hashIt(data) { var hash = 0; var length = data.length; for (var i = 0; i &lt; length; i++) { var char = data.charCodeAt(i); hash = ((hash &lt;&lt; 5) - hash) + char; // è½¬æ¢ä¸º32ä½æ•´æ•° hash = hash &amp; hash; }} ä¸è¦æŠŠæ³¨é‡Šæ‰çš„ä»£ç ç•™åœ¨ä»£ç åº“ä¸­ç‰ˆæœ¬æ§åˆ¶å­˜åœ¨çš„åŸå› å°±æ˜¯ä¿å­˜ä½ çš„å†å²ä»£ç ã€‚ ä¸å¥½: doStuff();// doOtherStuff();// doSomeMoreStuff();// doSoMuchStuff(); å¥½: doStuff(); ä¸éœ€è¦æ—¥å¿—å¼çš„æ³¨é‡Šè®°ä½ï¼Œä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ï¼æ²¡ç”¨çš„ä»£ç ã€æ³¨é‡Šæ‰çš„ä»£ç ï¼Œå°¤å…¶æ˜¯æ—¥å¿—å¼çš„æ³¨é‡Šã€‚ç”¨ git log æ¥è·å–å†å²ä¿¡æ¯ï¼ ä¸å¥½: /** * 2016-12-20: Removed monads, didnâ€™t understand them (RM) * 2016-10-01: Improved using special monads (JP) * 2016-02-03: Removed type-checking (LI) * 2015-03-14: Added combine with type-checking (JR) */function combine(a, b) { return a + b;} å¥½: function combine(a, b) { return a + b;} é¿å…ä½ç½®æ ‡è®°ä½ç½®æ ‡è®°é€šå¸¸åªä¼šæ·»åŠ åƒåœ¾ä¿¡æ¯ã€‚é€šè¿‡å¯¹å‡½æ•°æˆ–å˜é‡åä»¥åŠé€‚å½“çš„ç¼©è¿›å°±èƒ½ä¸ºä»£ç å¸¦æ¥è‰¯å¥½çš„å¯è§†åŒ–ç»“æ„ã€‚ ä¸å¥½: ////////////////////////////////////////////////////////////////////////////////// Scope Model Instantiation////////////////////////////////////////////////////////////////////////////////let $scope.model = { menu: â€˜fooâ€™, nav: â€˜barâ€™}; ////////////////////////////////////////////////////////////////////////////////// Action setup////////////////////////////////////////////////////////////////////////////////let actions = function() { // â€¦} å¥½: let $scope.model = { menu: â€˜fooâ€™, nav: â€˜barâ€™}; let actions = function() { // â€¦} é¿å…åœ¨æºæ–‡ä»¶ä¸­æ·»åŠ ç‰ˆæƒæ³¨é‡Šè¿™æ˜¯ä»£ç æ–‡ä»¶æ ‘é¡¶å±‚çš„ LICENSE æ–‡ä»¶åº”è¯¥å¹²çš„äº‹æƒ…ã€‚ ä¸å¥½: /*The MIT License (MIT) Copyright (c) 2016 Ryan McDermott Permission is hereby granted, free of charge, to any person obtaining a copyof this software and associated documentation files (the â€œSoftwareâ€), to dealin the Software without restriction, including without limitation the rightsto use, copy, modify, merge, publish, distribute, sublicense, and/or sellcopies of the Software, and to permit persons to whom the Software isfurnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in allcopies or substantial portions of the Software. THE SOFTWARE IS PROVIDED â€œAS ISâ€, WITHOUT WARRANTY OF ANY KIND, EXPRESS ORIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THEAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHERLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THESOFTWARE*/ function calculateBill() { // â€¦} å¥½: function calculateBill() { // â€¦}","categories":[{"name":"å­¦ä¹ èµ„æ–™","slug":"å­¦ä¹ èµ„æ–™","permalink":"https://sensitivemix.github.io/categories/å­¦ä¹ èµ„æ–™/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://sensitivemix.github.io/tags/Tutorial/"}]},{"title":"HTTP çŠ¶æ€ç æ•´ç†","slug":"HTTP-çŠ¶æ€ç æ•´ç†","date":"2018-12-01T06:30:51.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/12/01/HTTP-çŠ¶æ€ç æ•´ç†/","link":"","permalink":"https://sensitivemix.github.io/2018/12/01/HTTP-çŠ¶æ€ç æ•´ç†/","excerpt":"","text":"å½“æˆ‘ä»¬åœ¨æµè§ˆç½‘é¡µæˆ–æ˜¯åœ¨æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—æ—¶ï¼Œå¸¸ä¼šé‡åˆ°3ä½æ•°å­—çš„çŠ¶æ€ç ï¼Œè¿™3ä½æ•°å­—æ˜¯ä»€ä¹ˆæ„æ€å‘¢?å…¶å®ï¼Œè¿™3ä½æ•°å­—æ˜¯HTTPçŠ¶æ€ç ï¼Œç”¨æ¥è¡¨ç¤ºç½‘é¡µæœåŠ¡å™¨HTTPå“åº”çŠ¶æ€ï¼Œç®€è¨€ä¹‹å°±æ˜¯WebæœåŠ¡å™¨ç”¨æ¥å‘Šè¯‰å®¢æˆ·ç«¯å‘ç”Ÿäº†ä»€ä¹ˆäº‹ã€‚ 1xxï¼šä¿¡æ¯ 1XXç±»å‹çš„çŠ¶æ€ç æ˜¯ä¸´æ—¶å“åº”ï¼Œä»£è¡¨ç€è¯·æ±‚å·²ç»è¢«æ¥å—ï¼Œä½†éœ€è¦ç»§ç»­å¤„ç†ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äºHTTP/1.0 åè®®ä¸­å¹¶æ²¡æœ‰å®šä¹‰1XXçŠ¶æ€ç ï¼Œé™¤éåœ¨è¯•éªŒæ¡ä»¶ä¸‹ï¼ŒæœåŠ¡å™¨æ˜¯ç¦æ­¢å‘å®¢æˆ·ç«¯å‘é€1XXå“åº”çš„ã€‚ 100 Continue â€” æœåŠ¡å™¨ä»…æ¥æ”¶åˆ°éƒ¨åˆ†è¯·æ±‚ï¼Œä½†æ˜¯ä¸€æ—¦æœåŠ¡å™¨å¹¶æ²¡æœ‰æ‹’ç»è¯¥è¯·æ±‚ï¼Œå®¢æˆ·ç«¯åº”è¯¥ç»§ç»­å‘é€å…¶ä½™çš„è¯·æ±‚ã€‚ 101 Switching Protocols â€” æœåŠ¡å™¨è½¬æ¢åè®®ï¼šæœåŠ¡å™¨å°†éµä»å®¢æˆ·çš„è¯·æ±‚è½¬æ¢åˆ°å¦å¤–ä¸€ç§åè®®ã€‚ 102 Processing â€” ç”±WebDAV(RFC 2518)æ‰©å±•çš„çŠ¶æ€ç ï¼Œä»£è¡¨å¤„ç†å°†è¢«ç»§ç»­æ‰§è¡Œã€‚ 2xxï¼šæˆåŠŸ 2XXç±»å‹çš„çŠ¶æ€ç ä»£è¡¨ç€è¯·æ±‚å·²ç»è¢«æœåŠ¡å™¨æ¥æ”¶ã€ç†è§£ã€å¹¶æ¥å— 200 OKï¼šè¯·æ±‚æˆåŠŸ(å…¶åæ˜¯å¯¹GETå’ŒPOSTè¯·æ±‚çš„åº”ç­”æ–‡æ¡£ã€‚) 201 Created â€” è¯·æ±‚è¢«åˆ›å»ºå®Œæˆï¼ŒåŒæ—¶æ–°çš„èµ„æºè¢«åˆ›å»ºã€‚ 202 Accepted â€” ä¾›å¤„ç†çš„è¯·æ±‚å·²è¢«æ¥å—ï¼Œä½†æ˜¯å¤„ç†æœªå®Œæˆã€‚ 203 Non-authoritative Information â€” æ–‡æ¡£å·²ç»æ­£å¸¸åœ°è¿”å›ï¼Œä½†ä¸€äº›åº”ç­”å¤´å¯èƒ½ä¸æ­£ç¡®ï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯æ–‡æ¡£çš„æ‹·è´ã€‚ 204 No Content â€” æ²¡æœ‰æ–°æ–‡æ¡£ã€‚æµè§ˆå™¨åº”è¯¥ç»§ç»­æ˜¾ç¤ºåŸæ¥çš„æ–‡æ¡£ã€‚å¦‚æœç”¨æˆ·å®šæœŸåœ°åˆ·æ–°é¡µé¢ï¼Œè€ŒServletå¯ä»¥ç¡®å®šç”¨æˆ·æ–‡æ¡£è¶³å¤Ÿæ–°ï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚ 205 Reset Content â€” æ²¡æœ‰æ–°æ–‡æ¡£ã€‚ä½†æµè§ˆå™¨åº”è¯¥é‡ç½®å®ƒæ‰€æ˜¾ç¤ºçš„å†…å®¹ã€‚ç”¨æ¥å¼ºåˆ¶æµè§ˆå™¨æ¸…é™¤è¡¨å•è¾“å…¥å†…å®¹ã€‚ 206 Partial Content â€” å®¢æˆ·å‘é€äº†ä¸€ä¸ªå¸¦æœ‰Rangeå¤´çš„GETè¯·æ±‚ï¼ŒæœåŠ¡å™¨å®Œæˆäº†å®ƒã€‚ 207 Multi-Status â€” ç”±WebDAV(RFC 2518)æ‰©å±•çš„çŠ¶æ€ç ï¼Œä»£è¡¨ä¹‹åçš„æ¶ˆæ¯ä½“å°†æ˜¯ä¸€ä¸ªXMLæ¶ˆæ¯ï¼Œå¹¶ä¸”å¯èƒ½ä¾ç…§ä¹‹å‰å­è¯·æ±‚æ•°é‡çš„ä¸åŒï¼ŒåŒ…å«ä¸€ç³»åˆ—ç‹¬ç«‹çš„å“åº”ä»£ç ã€‚ 3xx: é‡å®šå‘ 3XXè¿™ç±»çŠ¶æ€ç ä»£è¡¨ç€å®¢æˆ·ç«¯éœ€è¦é‡‡å–è¿›ä¸€æ­¥çš„æ“ä½œæ‰èƒ½å®Œæˆè¯·æ±‚ï¼Œé€šå¸¸ï¼Œè¿™äº›çŠ¶æ€ç æ˜¯ç”¨æ¥é‡å®šå‘çš„ï¼ŒæŒ‰ç…§ HTTP/1.0 ç‰ˆè§„èŒƒçš„å»ºè®®ï¼Œæµè§ˆå™¨ä¸åº”è‡ªåŠ¨è®¿é—®è¶…è¿‡5æ¬¡çš„é‡å®šå‘ã€‚ 300 Multiple Choices â€” å¤šé‡é€‰æ‹©ã€‚é“¾æ¥åˆ—è¡¨ã€‚ç”¨æˆ·å¯ä»¥é€‰æ‹©æŸé“¾æ¥åˆ°è¾¾ç›®çš„åœ°ã€‚æœ€å¤šå…è®¸äº”ä¸ªåœ°å€ã€‚ 301 Moved Permanently â€” æ‰€è¯·æ±‚çš„é¡µé¢å·²ç»è½¬ç§»è‡³æ–°çš„urlã€‚ 302 Found â€” æ‰€è¯·æ±‚çš„é¡µé¢å·²ç»ä¸´æ—¶è½¬ç§»è‡³æ–°çš„urlã€‚ 303 See Other â€” æ‰€è¯·æ±‚çš„é¡µé¢å¯åœ¨åˆ«çš„urlä¸‹è¢«æ‰¾åˆ°ã€‚ 304 Not Modified â€” æœªæŒ‰é¢„æœŸä¿®æ”¹æ–‡æ¡£ã€‚å®¢æˆ·ç«¯æœ‰ç¼“å†²çš„æ–‡æ¡£å¹¶å‘å‡ºäº†ä¸€ä¸ªæ¡ä»¶æ€§çš„è¯·æ±‚(ä¸€èˆ¬æ˜¯æä¾›If-Modified-Sinceå¤´è¡¨ç¤ºå®¢æˆ·åªæƒ³æ¯”æŒ‡å®šæ—¥æœŸæ›´æ–°çš„æ–‡æ¡£)ã€‚æœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ï¼ŒåŸæ¥ç¼“å†²çš„æ–‡æ¡£è¿˜å¯ä»¥ç»§ç»­ä½¿ç”¨ã€‚ 305 Use Proxy â€” å®¢æˆ·è¯·æ±‚çš„æ–‡æ¡£åº”è¯¥é€šè¿‡Locationå¤´æ‰€æŒ‡æ˜çš„ä»£ç†æœåŠ¡å™¨æå–ã€‚ 306 Unused â€” æ­¤ä»£ç è¢«ç”¨äºå‰ä¸€ç‰ˆæœ¬ã€‚ç›®å‰å·²ä¸å†ä½¿ç”¨ï¼Œä½†æ˜¯ä»£ç ä¾ç„¶è¢«ä¿ç•™ã€‚ 307 Temporary Redirect â€” è¢«è¯·æ±‚çš„é¡µé¢å·²ç»ä¸´æ—¶ç§»è‡³æ–°çš„urlã€‚ 4xxï¼šå®¢æˆ·ç«¯é”™è¯¯ 4XXç±»å‹çš„çŠ¶æ€ç ä»£è¡¨ç€å®¢æˆ·ç«¯å¯èƒ½å‘ç”Ÿäº†é”™è¯¯ï¼Œé˜»ç¢äº†æœåŠ¡å™¨çš„å¤„ç†ï¼Œ 400 Bad Request â€” æœåŠ¡å™¨æœªèƒ½ç†è§£è¯·æ±‚æˆ–æ˜¯è¯·æ±‚å‚æ•°æœ‰è¯¯ã€‚ 401 Unauthorized â€” è¢«è¯·æ±‚çš„é¡µé¢éœ€è¦ç”¨æˆ·åå’Œå¯†ç ã€‚ 402 Payment Required â€” æ­¤ä»£ç å°šæ— æ³•ä½¿ç”¨(ä¸ºäº†å°†æ¥å¯èƒ½çš„éœ€æ±‚è€Œé¢„ç•™çš„ã€‚) 403 Forbidden â€” å¯¹è¢«è¯·æ±‚é¡µé¢çš„è®¿é—®è¢«ç¦æ­¢ã€‚ 404 Not Found â€” æœåŠ¡å™¨æ— æ³•æ‰¾åˆ°è¢«è¯·æ±‚çš„é¡µé¢ã€‚ 405 Method Not Allowed â€” è¯·æ±‚ä¸­æŒ‡å®šçš„æ–¹æ³•ä¸è¢«å…è®¸ã€‚ 406 Not Acceptable â€” æœåŠ¡å™¨ç”Ÿæˆçš„å“åº”æ— æ³•è¢«å®¢æˆ·ç«¯æ‰€æ¥å—ã€‚ 407 Proxy Authentication Required â€” ç”¨æˆ·å¿…é¡»é¦–å…ˆä½¿ç”¨ä»£ç†æœåŠ¡å™¨è¿›è¡ŒéªŒè¯ï¼Œè¿™æ ·è¯·æ±‚æ‰ä¼šè¢«å¤„ç†ã€‚ 408 Request Timeout â€” è¯·æ±‚è¶…å‡ºäº†æœåŠ¡å™¨çš„ç­‰å¾…æ—¶é—´ã€‚ 409 Conflict â€” ç”±äºå†²çªï¼Œè¯·æ±‚æ— æ³•è¢«å®Œæˆã€‚ 410 Gone â€” è¢«è¯·æ±‚çš„é¡µé¢ä¸å¯ç”¨ã€‚ 411 Length Requiredâ€Content-Length â€” â€œ æœªè¢«å®šä¹‰ã€‚å¦‚æœæ— æ­¤å†…å®¹ï¼ŒæœåŠ¡å™¨ä¸ä¼šæ¥å—è¯·æ±‚ã€‚ 412 Precondition Failed â€” è¯·æ±‚ä¸­çš„å‰ææ¡ä»¶è¢«æœåŠ¡å™¨è¯„ä¼°ä¸ºå¤±è´¥ã€‚ 413 Request Entity Too Large â€” ç”±äºæ‰€è¯·æ±‚çš„å®ä½“çš„å¤ªå¤§ï¼ŒæœåŠ¡å™¨ä¸ä¼šæ¥å—è¯·æ±‚ã€‚ 414 Request-url Too Long â€” ç”±äºurlå¤ªé•¿ï¼ŒæœåŠ¡å™¨ä¸ä¼šæ¥å—è¯·æ±‚ã€‚å½“postè¯·æ±‚è¢«è½¬æ¢ä¸ºå¸¦æœ‰å¾ˆé•¿çš„æŸ¥è¯¢ä¿¡æ¯çš„getè¯·æ±‚æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚ 415 Unsupported Media Type â€” ç”±äºåª’ä»‹ç±»å‹ä¸è¢«æ”¯æŒï¼ŒæœåŠ¡å™¨ä¸ä¼šæ¥å—è¯·æ±‚ã€‚ 416 â€” æœåŠ¡å™¨ä¸èƒ½æ»¡è¶³å®¢æˆ·åœ¨è¯·æ±‚ä¸­æŒ‡å®šçš„Rangeå¤´ã€‚ 417 Expectation Failed 5xxï¼š æœåŠ¡å™¨é”™è¯¯ è¿™ç±»çŠ¶æ€ç ä»£è¡¨äº†æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­æœ‰é”™è¯¯æˆ–è€…å¼‚å¸¸çŠ¶æ€å‘ç”Ÿï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æœåŠ¡å™¨æ„è¯†åˆ°ä»¥å½“å‰çš„è½¯ç¡¬ä»¶èµ„æºæ— æ³•å®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†ã€‚ 500 Internal Server Error â€” è¯·æ±‚æœªå®Œæˆã€‚æœåŠ¡å™¨é‡åˆ°ä¸å¯é¢„çŸ¥çš„æƒ…å†µã€‚ 501 Not Implemented â€” è¯·æ±‚æœªå®Œæˆã€‚æœåŠ¡å™¨ä¸æ”¯æŒæ‰€è¯·æ±‚çš„åŠŸèƒ½ã€‚ 502 Bad Gateway â€” è¯·æ±‚æœªå®Œæˆã€‚æœåŠ¡å™¨ä»ä¸Šæ¸¸æœåŠ¡å™¨æ”¶åˆ°ä¸€ä¸ªæ— æ•ˆçš„å“åº”ã€‚ 503 Service Unavailable â€” è¯·æ±‚æœªå®Œæˆã€‚æœåŠ¡å™¨ä¸´æ—¶è¿‡è½½æˆ–å½“æœºã€‚ 504 Gateway Timeout â€” ç½‘å…³è¶…æ—¶ã€‚ 505 HTTP Version Not Supported â€” æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚ä¸­æŒ‡æ˜çš„HTTPåè®®ç‰ˆæœ¬ã€‚ httpåè®®å“åº”çŠ¶æ€ç çœ‹èµ·æ¥å¾ˆå¤šï¼Œä½†è‹¥ä¸æ˜¯éœ€è¦åšAJAXï¼ŒREST,ç½‘ç»œçˆ¬è™«ï¼Œæœºå™¨äººç­‰ç¨‹åºï¼Œæˆ‘ä»¬åªéœ€è¦äº†è§£å¸¸è§çš„200ã€302.304.404ã€503è¿™å‡ ä¸ªçŠ¶æ€ç å°±å¥½äº†ã€‚","categories":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://sensitivemix.github.io/categories/è®¡ç®—æœºç½‘ç»œ/"}],"tags":[{"name":"http","slug":"http","permalink":"https://sensitivemix.github.io/tags/http/"}]},{"title":"å½»åº•ææ‡‚ Javascript æ‰§è¡Œæœºåˆ¶","slug":"å½»åº•ææ‡‚-Javascript-æ‰§è¡Œæœºåˆ¶","date":"2018-12-01T06:28:09.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/12/01/å½»åº•ææ‡‚-Javascript-æ‰§è¡Œæœºåˆ¶/","link":"","permalink":"https://sensitivemix.github.io/2018/12/01/å½»åº•ææ‡‚-Javascript-æ‰§è¡Œæœºåˆ¶/","excerpt":"","text":"è¿™ä¸€æ¬¡ï¼Œå½»åº•å¼„æ‡‚ JavaScript æ‰§è¡Œæœºåˆ¶æœ¬æ–‡çš„ç›®çš„å°±æ˜¯è¦ä¿è¯ä½ å½»åº•å¼„æ‡‚javascriptçš„æ‰§è¡Œæœºåˆ¶ï¼Œå¦‚æœè¯»å®Œæœ¬æ–‡è¿˜ä¸æ‡‚ï¼Œå¯ä»¥ææˆ‘ã€‚ ä¸è®ºä½ æ˜¯javascriptæ–°æ‰‹è¿˜æ˜¯è€é¸Ÿï¼Œä¸è®ºæ˜¯é¢è¯•æ±‚èŒï¼Œè¿˜æ˜¯æ—¥å¸¸å¼€å‘å·¥ä½œï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼šç»™å®šçš„å‡ è¡Œä»£ç ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å…¶è¾“å‡ºå†…å®¹å’Œé¡ºåºã€‚å› ä¸ºjavascriptæ˜¯ä¸€é—¨å•çº¿ç¨‹è¯­è¨€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼š javascriptæ˜¯æŒ‰ç…§è¯­å¥å‡ºç°çš„é¡ºåºæ‰§è¡Œçš„ çœ‹åˆ°è¿™é‡Œè¯»è€…è¦æ‰“äººäº†ï¼šæˆ‘éš¾é“ä¸çŸ¥é“jsæ˜¯ä¸€è¡Œä¸€è¡Œæ‰§è¡Œçš„ï¼Ÿè¿˜ç”¨ä½ è¯´ï¼Ÿç¨å®‰å‹¿èºï¼Œæ­£å› ä¸ºjsæ˜¯ä¸€è¡Œä¸€è¡Œæ‰§è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»¥ä¸ºjséƒ½æ˜¯è¿™æ ·çš„ï¼š let a = â€˜1â€™;console.log(a); ç„¶è€Œå®é™…ä¸Šjsæ˜¯è¿™æ ·çš„ï¼š setTimeout(function(){ console.log(â€˜å®šæ—¶å™¨å¼€å§‹å•¦â€™)});new Promise(function(resolve){ console.log(â€˜é©¬ä¸Šæ‰§è¡Œforå¾ªç¯å•¦â€™); for(var i = 0; i &lt; 10000; i++){ i == 99 &amp;&amp; resolve(); }}).then(function(){ console.log(â€˜æ‰§è¡Œthenå‡½æ•°å•¦â€™)}); ä¾ç…§jsæ˜¯æŒ‰ç…§è¯­å¥å‡ºç°çš„é¡ºåºæ‰§è¡Œè¿™ä¸ªç†å¿µï¼Œæˆ‘è‡ªä¿¡çš„å†™ä¸‹è¾“å‡ºç»“æœï¼š //â€œå®šæ—¶å™¨å¼€å§‹å•¦â€//â€œé©¬ä¸Šæ‰§è¡Œforå¾ªç¯å•¦â€//â€œæ‰§è¡Œthenå‡½æ•°å•¦â€//â€œä»£ç æ‰§è¡Œç»“æŸâ€ å»chromeä¸ŠéªŒè¯ä¸‹ï¼Œç»“æœå®Œå…¨ä¸å¯¹ï¼Œç¬é—´æ‡µäº†ï¼Œè¯´å¥½çš„ä¸€è¡Œä¸€è¡Œæ‰§è¡Œçš„å‘¢ï¼Ÿ æˆ‘ä»¬çœŸçš„è¦å½»åº•å¼„æ˜ç™½javascriptçš„æ‰§è¡Œæœºåˆ¶äº†ã€‚ 1.å…³äºjavascriptjavascriptæ˜¯ä¸€é—¨å•çº¿ç¨‹è¯­è¨€ï¼Œåœ¨æœ€æ–°çš„HTML5ä¸­æå‡ºäº†Web-Workerï¼Œä½†javascriptæ˜¯å•çº¿ç¨‹è¿™ä¸€æ ¸å¿ƒä»æœªæ”¹å˜ã€‚æ‰€ä»¥ä¸€åˆ‡javascriptç‰ˆçš„â€å¤šçº¿ç¨‹â€éƒ½æ˜¯ç”¨å•çº¿ç¨‹æ¨¡æ‹Ÿå‡ºæ¥çš„ï¼Œä¸€åˆ‡javascriptå¤šçº¿ç¨‹éƒ½æ˜¯çº¸è€è™ï¼ 2.javascriptäº‹ä»¶å¾ªç¯æ—¢ç„¶jsæ˜¯å•çº¿ç¨‹ï¼Œé‚£å°±åƒåªæœ‰ä¸€ä¸ªçª—å£çš„é“¶è¡Œï¼Œå®¢æˆ·éœ€è¦æ’é˜Ÿä¸€ä¸ªä¸€ä¸ªåŠç†ä¸šåŠ¡ï¼ŒåŒç†jsä»»åŠ¡ä¹Ÿè¦ä¸€ä¸ªä¸€ä¸ªé¡ºåºæ‰§è¡Œã€‚å¦‚æœä¸€ä¸ªä»»åŠ¡è€—æ—¶è¿‡é•¿ï¼Œé‚£ä¹ˆåä¸€ä¸ªä»»åŠ¡ä¹Ÿå¿…é¡»ç­‰ç€ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå‡å¦‚æˆ‘ä»¬æƒ³æµè§ˆæ–°é—»ï¼Œä½†æ˜¯æ–°é—»åŒ…å«çš„è¶…æ¸…å›¾ç‰‡åŠ è½½å¾ˆæ…¢ï¼Œéš¾é“æˆ‘ä»¬çš„ç½‘é¡µè¦ä¸€ç›´å¡ç€ç›´åˆ°å›¾ç‰‡å®Œå…¨æ˜¾ç¤ºå‡ºæ¥ï¼Ÿå› æ­¤èªæ˜çš„ç¨‹åºå‘˜å°†ä»»åŠ¡åˆ†ä¸ºä¸¤ç±»ï¼š åŒæ­¥ä»»åŠ¡ å¼‚æ­¥ä»»åŠ¡ å½“æˆ‘ä»¬æ‰“å¼€ç½‘ç«™æ—¶ï¼Œç½‘é¡µçš„æ¸²æŸ“è¿‡ç¨‹å°±æ˜¯ä¸€å¤§å †åŒæ­¥ä»»åŠ¡ï¼Œæ¯”å¦‚é¡µé¢éª¨æ¶å’Œé¡µé¢å…ƒç´ çš„æ¸²æŸ“ã€‚è€ŒåƒåŠ è½½å›¾ç‰‡éŸ³ä¹ä¹‹ç±»å ç”¨èµ„æºå¤§è€—æ—¶ä¹…çš„ä»»åŠ¡ï¼Œå°±æ˜¯å¼‚æ­¥ä»»åŠ¡ã€‚å…³äºè¿™éƒ¨åˆ†æœ‰ä¸¥æ ¼çš„æ–‡å­—å®šä¹‰ï¼Œä½†æœ¬æ–‡çš„ç›®çš„æ˜¯ç”¨æœ€å°çš„å­¦ä¹ æˆæœ¬å½»åº•å¼„æ‡‚æ‰§è¡Œæœºåˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨å¯¼å›¾æ¥è¯´æ˜ï¼š å¯¼å›¾è¦è¡¨è¾¾çš„å†…å®¹ç”¨æ–‡å­—æ¥è¡¨è¿°çš„è¯ï¼š åŒæ­¥å’Œå¼‚æ­¥ä»»åŠ¡åˆ†åˆ«è¿›å…¥ä¸åŒçš„æ‰§è¡Œâ€åœºæ‰€â€ï¼ŒåŒæ­¥çš„è¿›å…¥ä¸»çº¿ç¨‹ï¼Œå¼‚æ­¥çš„è¿›å…¥Event Tableå¹¶æ³¨å†Œå‡½æ•°ã€‚ å½“æŒ‡å®šçš„äº‹æƒ…å®Œæˆæ—¶ï¼ŒEvent Tableä¼šå°†è¿™ä¸ªå‡½æ•°ç§»å…¥Event Queueã€‚ ä¸»çº¿ç¨‹å†…çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¸ºç©ºï¼Œä¼šå»Event Queueè¯»å–å¯¹åº”çš„å‡½æ•°ï¼Œè¿›å…¥ä¸»çº¿ç¨‹æ‰§è¡Œã€‚ ä¸Šè¿°è¿‡ç¨‹ä¼šä¸æ–­é‡å¤ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„Event Loop(äº‹ä»¶å¾ªç¯)ã€‚ æˆ‘ä»¬ä¸ç¦è¦é—®äº†ï¼Œé‚£æ€ä¹ˆçŸ¥é“ä¸»çº¿ç¨‹æ‰§è¡Œæ ˆä¸ºç©ºå•Šï¼Ÿjså¼•æ“å­˜åœ¨monitoring processè¿›ç¨‹ï¼Œä¼šæŒç»­ä¸æ–­çš„æ£€æŸ¥ä¸»çº¿ç¨‹æ‰§è¡Œæ ˆæ˜¯å¦ä¸ºç©ºï¼Œä¸€æ—¦ä¸ºç©ºï¼Œå°±ä¼šå»Event Queueé‚£é‡Œæ£€æŸ¥æ˜¯å¦æœ‰ç­‰å¾…è¢«è°ƒç”¨çš„å‡½æ•°ã€‚ è¯´äº†è¿™ä¹ˆå¤šæ–‡å­—ï¼Œä¸å¦‚ç›´æ¥ä¸€æ®µä»£ç æ›´ç›´ç™½ï¼š let data = [];$.ajax({ url:www.javascript.com, data:data, success:() =&gt; { console.log(â€˜å‘é€æˆåŠŸ!â€™); }})console.log(â€˜ä»£ç æ‰§è¡Œç»“æŸâ€™); ä¸Šé¢æ˜¯ä¸€æ®µç®€æ˜“çš„ajaxè¯·æ±‚ä»£ç ï¼š ajaxè¿›å…¥Event Tableï¼Œæ³¨å†Œå›è°ƒå‡½æ•°successã€‚ æ‰§è¡Œconsole.log(&#39;ä»£ç æ‰§è¡Œç»“æŸ&#39;)ã€‚ ajaxäº‹ä»¶å®Œæˆï¼Œå›è°ƒå‡½æ•°successè¿›å…¥Event Queueã€‚ ä¸»çº¿ç¨‹ä»Event Queueè¯»å–å›è°ƒå‡½æ•°successå¹¶æ‰§è¡Œã€‚ ç›¸ä¿¡é€šè¿‡ä¸Šé¢çš„æ–‡å­—å’Œä»£ç ï¼Œä½ å·²ç»å¯¹jsçš„æ‰§è¡Œé¡ºåºæœ‰äº†åˆæ­¥äº†è§£ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥ç ”ç©¶è¿›é˜¶è¯é¢˜ï¼šsetTimeoutã€‚ 3.åˆçˆ±åˆæ¨çš„setTimeoutå¤§åé¼é¼çš„setTimeoutæ— éœ€å†å¤šè¨€ï¼Œå¤§å®¶å¯¹ä»–çš„ç¬¬ä¸€å°è±¡å°±æ˜¯å¼‚æ­¥å¯ä»¥å»¶æ—¶æ‰§è¡Œï¼Œæˆ‘ä»¬ç»å¸¸è¿™ä¹ˆå®ç°å»¶æ—¶3ç§’æ‰§è¡Œï¼š setTimeout(() =&gt; { console.log(â€˜å»¶æ—¶3ç§’â€™);},3000) æ¸æ¸çš„setTimeoutç”¨çš„åœ°æ–¹å¤šäº†ï¼Œé—®é¢˜ä¹Ÿå‡ºç°äº†ï¼Œæœ‰æ—¶å€™æ˜æ˜å†™çš„å»¶æ—¶3ç§’ï¼Œå®é™…å´5ï¼Œ6ç§’æ‰æ‰§è¡Œå‡½æ•°ï¼Œè¿™åˆå’‹å›äº‹å•Šï¼Ÿ å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š setTimeout(() =&gt; { task();},3000)console.log(â€˜æ‰§è¡Œconsoleâ€™); æ ¹æ®å‰é¢æˆ‘ä»¬çš„ç»“è®ºï¼ŒsetTimeoutæ˜¯å¼‚æ­¥çš„ï¼Œåº”è¯¥å…ˆæ‰§è¡Œconsole.logè¿™ä¸ªåŒæ­¥ä»»åŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç»“è®ºæ˜¯ï¼š //æ‰§è¡Œconsole//task() å»éªŒè¯ä¸€ä¸‹ï¼Œç»“æœæ­£ç¡®ï¼ç„¶åæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å‰é¢çš„ä»£ç ï¼š setTimeout(() =&gt; { task()},3000) sleep(10000000) ä¹ä¸€çœ‹å…¶å®å·®ä¸å¤šå˜›ï¼Œä½†æˆ‘ä»¬æŠŠè¿™æ®µä»£ç åœ¨chromeæ‰§è¡Œä¸€ä¸‹ï¼Œå´å‘ç°æ§åˆ¶å°æ‰§è¡Œtask()éœ€è¦çš„æ—¶é—´è¿œè¿œè¶…è¿‡3ç§’ï¼Œè¯´å¥½çš„å»¶æ—¶ä¸‰ç§’ï¼Œä¸ºå•¥ç°åœ¨éœ€è¦è¿™ä¹ˆé•¿æ—¶é—´å•Šï¼Ÿ è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦é‡æ–°ç†è§£setTimeoutçš„å®šä¹‰ã€‚æˆ‘ä»¬å…ˆè¯´ä¸Šè¿°ä»£ç æ˜¯æ€ä¹ˆæ‰§è¡Œçš„ï¼š task()è¿›å…¥Event Tableå¹¶æ³¨å†Œ,è®¡æ—¶å¼€å§‹ã€‚ æ‰§è¡Œsleepå‡½æ•°ï¼Œå¾ˆæ…¢ï¼Œéå¸¸æ…¢ï¼Œè®¡æ—¶ä»åœ¨ç»§ç»­ã€‚ 3ç§’åˆ°äº†ï¼Œè®¡æ—¶äº‹ä»¶timeoutå®Œæˆï¼Œtask()è¿›å…¥Event Queueï¼Œä½†æ˜¯sleepä¹Ÿå¤ªæ…¢äº†å§ï¼Œè¿˜æ²¡æ‰§è¡Œå®Œï¼Œåªå¥½ç­‰ç€ã€‚ sleepç»ˆäºæ‰§è¡Œå®Œäº†ï¼Œtask()ç»ˆäºä»Event Queueè¿›å…¥äº†ä¸»çº¿ç¨‹æ‰§è¡Œã€‚ ä¸Šè¿°çš„æµç¨‹èµ°å®Œï¼Œæˆ‘ä»¬çŸ¥é“setTimeoutè¿™ä¸ªå‡½æ•°ï¼Œæ˜¯ç»è¿‡æŒ‡å®šæ—¶é—´åï¼ŒæŠŠè¦æ‰§è¡Œçš„ä»»åŠ¡(æœ¬ä¾‹ä¸­ä¸ºtask())åŠ å…¥åˆ°Event Queueä¸­ï¼Œåˆå› ä¸ºæ˜¯å•çº¿ç¨‹ä»»åŠ¡è¦ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œï¼Œå¦‚æœå‰é¢çš„ä»»åŠ¡éœ€è¦çš„æ—¶é—´å¤ªä¹…ï¼Œé‚£ä¹ˆåªèƒ½ç­‰ç€ï¼Œå¯¼è‡´çœŸæ­£çš„å»¶è¿Ÿæ—¶é—´è¿œè¿œå¤§äº3ç§’ã€‚ æˆ‘ä»¬è¿˜ç»å¸¸é‡åˆ°setTimeout(fn,0)è¿™æ ·çš„ä»£ç ï¼Œ0ç§’åæ‰§è¡Œåˆæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæ˜¯ä¸æ˜¯å¯ä»¥ç«‹å³æ‰§è¡Œå‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ä¸ä¼šçš„ï¼ŒsetTimeout(fn,0)çš„å«ä¹‰æ˜¯ï¼ŒæŒ‡å®šæŸä¸ªä»»åŠ¡åœ¨ä¸»çº¿ç¨‹æœ€æ—©å¯å¾—çš„ç©ºé—²æ—¶é—´æ‰§è¡Œï¼Œæ„æ€å°±æ˜¯ä¸ç”¨å†ç­‰å¤šå°‘ç§’äº†ï¼Œåªè¦ä¸»çº¿ç¨‹æ‰§è¡Œæ ˆå†…çš„åŒæ­¥ä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œæˆï¼Œæ ˆä¸ºç©ºå°±é©¬ä¸Šæ‰§è¡Œã€‚ä¸¾ä¾‹è¯´æ˜ï¼š //ä»£ç 1console.log(â€˜å…ˆæ‰§è¡Œè¿™é‡Œâ€™);setTimeout(() =&gt; { console.log(â€˜æ‰§è¡Œå•¦â€™)},0); //ä»£ç 2console.log(â€˜å…ˆæ‰§è¡Œè¿™é‡Œâ€™);setTimeout(() =&gt; { console.log(â€˜æ‰§è¡Œå•¦â€™)},3000); ä»£ç 1çš„è¾“å‡ºç»“æœæ˜¯ï¼š //å…ˆæ‰§è¡Œè¿™é‡Œ//æ‰§è¡Œå•¦ ä»£ç 2çš„è¾“å‡ºç»“æœæ˜¯ï¼š //å…ˆæ‰§è¡Œè¿™é‡Œ// â€¦ 3s later// æ‰§è¡Œå•¦ å…³äºsetTimeoutè¦è¡¥å……çš„æ˜¯ï¼Œå³ä¾¿ä¸»çº¿ç¨‹ä¸ºç©ºï¼Œ0æ¯«ç§’å®é™…ä¸Šä¹Ÿæ˜¯è¾¾ä¸åˆ°çš„ã€‚æ ¹æ®HTMLçš„æ ‡å‡†ï¼Œæœ€ä½æ˜¯4æ¯«ç§’ã€‚æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œäº†è§£ã€‚ 4.åˆæ¨åˆçˆ±çš„setIntervalä¸Šé¢è¯´å®Œäº†setTimeoutï¼Œå½“ç„¶ä¸èƒ½é”™è¿‡å®ƒçš„å­ªç”Ÿå…„å¼ŸsetIntervalã€‚ä»–ä¿©å·®ä¸å¤šï¼Œåªä¸è¿‡åè€…æ˜¯å¾ªç¯çš„æ‰§è¡Œã€‚å¯¹äºæ‰§è¡Œé¡ºåºæ¥è¯´ï¼ŒsetIntervalä¼šæ¯éš”æŒ‡å®šçš„æ—¶é—´å°†æ³¨å†Œçš„å‡½æ•°ç½®å…¥Event Queueï¼Œå¦‚æœå‰é¢çš„ä»»åŠ¡è€—æ—¶å¤ªä¹…ï¼Œé‚£ä¹ˆåŒæ ·éœ€è¦ç­‰å¾…ã€‚ å”¯ä¸€éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå¯¹äºsetInterval(fn,ms)æ¥è¯´ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ä¸æ˜¯æ¯è¿‡msç§’ä¼šæ‰§è¡Œä¸€æ¬¡fnï¼Œè€Œæ˜¯æ¯è¿‡msç§’ï¼Œä¼šæœ‰fnè¿›å…¥Event Queueã€‚ä¸€æ—¦setIntervalçš„å›è°ƒå‡½æ•°fnæ‰§è¡Œæ—¶é—´è¶…è¿‡äº†å»¶è¿Ÿæ—¶é—´msï¼Œé‚£ä¹ˆå°±å®Œå…¨çœ‹ä¸å‡ºæ¥æœ‰æ—¶é—´é—´éš”äº†ã€‚è¿™å¥è¯è¯·è¯»è€…ä»”ç»†å“å‘³ã€‚ 5.Promiseä¸process.nextTick(callback)ä¼ ç»Ÿçš„å®šæ—¶å™¨æˆ‘ä»¬å·²ç»ç ”ç©¶è¿‡äº†ï¼Œæ¥ç€æˆ‘ä»¬æ¢ç©¶Promiseä¸process.nextTick(callback)çš„è¡¨ç°ã€‚ Promiseçš„å®šä¹‰å’ŒåŠŸèƒ½æœ¬æ–‡ä¸å†èµ˜è¿°ï¼Œä¸äº†è§£çš„è¯»è€…å¯ä»¥å­¦ä¹ ä¸€ä¸‹é˜®ä¸€å³°è€å¸ˆçš„Promiseã€‚è€Œprocess.nextTick(callback)ç±»ä¼¼node.jsç‰ˆçš„â€setTimeoutâ€ï¼Œåœ¨äº‹ä»¶å¾ªç¯çš„ä¸‹ä¸€æ¬¡å¾ªç¯ä¸­è°ƒç”¨ callback å›è°ƒå‡½æ•°ã€‚ æˆ‘ä»¬è¿›å…¥æ­£é¢˜ï¼Œé™¤äº†å¹¿ä¹‰çš„åŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯¹ä»»åŠ¡æœ‰æ›´ç²¾ç»†çš„å®šä¹‰ï¼š macro-task(å®ä»»åŠ¡)ï¼šåŒ…æ‹¬æ•´ä½“ä»£ç scriptï¼ŒsetTimeoutï¼ŒsetInterval micro-task(å¾®ä»»åŠ¡)ï¼šPromiseï¼Œprocess.nextTick ä¸åŒç±»å‹çš„ä»»åŠ¡ä¼šè¿›å…¥å¯¹åº”çš„Event Queueï¼Œæ¯”å¦‚setTimeoutå’ŒsetIntervalä¼šè¿›å…¥ç›¸åŒçš„Event Queueã€‚ äº‹ä»¶å¾ªç¯çš„é¡ºåºï¼Œå†³å®šjsä»£ç çš„æ‰§è¡Œé¡ºåºã€‚è¿›å…¥æ•´ä½“ä»£ç (å®ä»»åŠ¡)åï¼Œå¼€å§‹ç¬¬ä¸€æ¬¡å¾ªç¯ã€‚æ¥ç€æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡ã€‚ç„¶åå†æ¬¡ä»å®ä»»åŠ¡å¼€å§‹ï¼Œæ‰¾åˆ°å…¶ä¸­ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œå®Œæ¯•ï¼Œå†æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡ã€‚å¬èµ·æ¥æœ‰ç‚¹ç»•ï¼Œæˆ‘ä»¬ç”¨æ–‡ç« æœ€å¼€å§‹çš„ä¸€æ®µä»£ç è¯´æ˜ï¼š setTimeout(function() { console.log(â€˜setTimeoutâ€™);}) new Promise(function(resolve) { console.log(â€˜promiseâ€™);}).then(function() { console.log(â€˜thenâ€™);}) console.log(â€˜consoleâ€™); è¿™æ®µä»£ç ä½œä¸ºå®ä»»åŠ¡ï¼Œè¿›å…¥ä¸»çº¿ç¨‹ã€‚ å…ˆé‡åˆ°setTimeoutï¼Œé‚£ä¹ˆå°†å…¶å›è°ƒå‡½æ•°æ³¨å†Œååˆ†å‘åˆ°å®ä»»åŠ¡Event Queueã€‚(æ³¨å†Œè¿‡ç¨‹ä¸ä¸ŠåŒï¼Œä¸‹æ–‡ä¸å†æè¿°) æ¥ä¸‹æ¥é‡åˆ°äº†Promiseï¼Œnew Promiseç«‹å³æ‰§è¡Œï¼Œthenå‡½æ•°åˆ†å‘åˆ°å¾®ä»»åŠ¡Event Queueã€‚ é‡åˆ°console.log()ï¼Œç«‹å³æ‰§è¡Œã€‚ å¥½å•¦ï¼Œæ•´ä½“ä»£ç scriptä½œä¸ºç¬¬ä¸€ä¸ªå®ä»»åŠ¡æ‰§è¡Œç»“æŸï¼Œçœ‹çœ‹æœ‰å“ªäº›å¾®ä»»åŠ¡ï¼Ÿæˆ‘ä»¬å‘ç°äº†thenåœ¨å¾®ä»»åŠ¡Event Queueé‡Œé¢ï¼Œæ‰§è¡Œã€‚ okï¼Œç¬¬ä¸€è½®äº‹ä»¶å¾ªç¯ç»“æŸäº†ï¼Œæˆ‘ä»¬å¼€å§‹ç¬¬äºŒè½®å¾ªç¯ï¼Œå½“ç„¶è¦ä»å®ä»»åŠ¡Event Queueå¼€å§‹ã€‚æˆ‘ä»¬å‘ç°äº†å®ä»»åŠ¡Event Queueä¸­setTimeoutå¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œç«‹å³æ‰§è¡Œã€‚ ç»“æŸã€‚ äº‹ä»¶å¾ªç¯ï¼Œå®ä»»åŠ¡ï¼Œå¾®ä»»åŠ¡çš„å…³ç³»å¦‚å›¾æ‰€ç¤ºï¼š æˆ‘ä»¬æ¥åˆ†æä¸€æ®µè¾ƒå¤æ‚çš„ä»£ç ï¼Œçœ‹çœ‹ä½ æ˜¯å¦çœŸçš„æŒæ¡äº†jsçš„æ‰§è¡Œæœºåˆ¶ï¼š console.log(â€˜1â€™); setTimeout(function() { console.log(â€˜2â€™); process.nextTick(function() { console.log(â€˜3â€™); }) new Promise(function(resolve) { console.log(â€˜4â€™); resolve(); }).then(function() { console.log(â€˜5â€™) })})process.nextTick(function() { console.log(â€˜6â€™);})new Promise(function(resolve) { console.log(â€˜7â€™); resolve();}).then(function() { console.log(â€˜8â€™)}) setTimeout(function() { console.log(â€˜9â€™); process.nextTick(function() { console.log(â€˜10â€™); }) new Promise(function(resolve) { console.log(â€˜11â€™); resolve(); }).then(function() { console.log(â€˜12â€™) })}) ç¬¬ä¸€è½®äº‹ä»¶å¾ªç¯æµç¨‹åˆ†æå¦‚ä¸‹ï¼š æ•´ä½“scriptä½œä¸ºç¬¬ä¸€ä¸ªå®ä»»åŠ¡è¿›å…¥ä¸»çº¿ç¨‹ï¼Œé‡åˆ°console.logï¼Œè¾“å‡º1ã€‚ é‡åˆ°setTimeoutï¼Œå…¶å›è°ƒå‡½æ•°è¢«åˆ†å‘åˆ°å®ä»»åŠ¡Event Queueä¸­ã€‚æˆ‘ä»¬æš‚ä¸”è®°ä¸ºsetTimeout1ã€‚ é‡åˆ°process.nextTick()ï¼Œå…¶å›è°ƒå‡½æ•°è¢«åˆ†å‘åˆ°å¾®ä»»åŠ¡Event Queueä¸­ã€‚æˆ‘ä»¬è®°ä¸ºprocess1ã€‚ é‡åˆ°Promiseï¼Œnew Promiseç›´æ¥æ‰§è¡Œï¼Œè¾“å‡º7ã€‚thenè¢«åˆ†å‘åˆ°å¾®ä»»åŠ¡Event Queueä¸­ã€‚æˆ‘ä»¬è®°ä¸ºthen1ã€‚ åˆé‡åˆ°äº†setTimeoutï¼Œå…¶å›è°ƒå‡½æ•°è¢«åˆ†å‘åˆ°å®ä»»åŠ¡Event Queueä¸­ï¼Œæˆ‘ä»¬è®°ä¸ºsetTimeout2ã€‚ å®ä»»åŠ¡Event Queue å¾®ä»»åŠ¡Event Queue setTimeout1 process1 setTimeout2 then1 ä¸Šè¡¨æ˜¯ç¬¬ä¸€è½®äº‹ä»¶å¾ªç¯å®ä»»åŠ¡ç»“æŸæ—¶å„Event Queueçš„æƒ…å†µï¼Œæ­¤æ—¶å·²ç»è¾“å‡ºäº†1å’Œ7ã€‚ æˆ‘ä»¬å‘ç°äº†process1å’Œthen1ä¸¤ä¸ªå¾®ä»»åŠ¡ã€‚ æ‰§è¡Œprocess1,è¾“å‡º6ã€‚ æ‰§è¡Œthen1ï¼Œè¾“å‡º8ã€‚ å¥½äº†ï¼Œç¬¬ä¸€è½®äº‹ä»¶å¾ªç¯æ­£å¼ç»“æŸï¼Œè¿™ä¸€è½®çš„ç»“æœæ˜¯è¾“å‡º1ï¼Œ7ï¼Œ6ï¼Œ8ã€‚é‚£ä¹ˆç¬¬äºŒè½®æ—¶é—´å¾ªç¯ä»setTimeout1å®ä»»åŠ¡å¼€å§‹ï¼š é¦–å…ˆè¾“å‡º2ã€‚æ¥ä¸‹æ¥é‡åˆ°äº†process.nextTick()ï¼ŒåŒæ ·å°†å…¶åˆ†å‘åˆ°å¾®ä»»åŠ¡Event Queueä¸­ï¼Œè®°ä¸ºprocess2ã€‚new Promiseç«‹å³æ‰§è¡Œè¾“å‡º4ï¼Œthenä¹Ÿåˆ†å‘åˆ°å¾®ä»»åŠ¡Event Queueä¸­ï¼Œè®°ä¸ºthen2ã€‚ å®ä»»åŠ¡Event Queue å¾®ä»»åŠ¡Event Queue setTimeout2 process2 then2 ç¬¬äºŒè½®äº‹ä»¶å¾ªç¯å®ä»»åŠ¡ç»“æŸï¼Œæˆ‘ä»¬å‘ç°æœ‰process2å’Œthen2ä¸¤ä¸ªå¾®ä»»åŠ¡å¯ä»¥æ‰§è¡Œã€‚ è¾“å‡º3ã€‚ è¾“å‡º5ã€‚ ç¬¬äºŒè½®äº‹ä»¶å¾ªç¯ç»“æŸï¼Œç¬¬äºŒè½®è¾“å‡º2ï¼Œ4ï¼Œ3ï¼Œ5ã€‚ ç¬¬ä¸‰è½®äº‹ä»¶å¾ªç¯å¼€å§‹ï¼Œæ­¤æ—¶åªå‰©setTimeout2äº†ï¼Œæ‰§è¡Œã€‚ ç›´æ¥è¾“å‡º9ã€‚ å°†process.nextTick()åˆ†å‘åˆ°å¾®ä»»åŠ¡Event Queueä¸­ã€‚è®°ä¸ºprocess3ã€‚ ç›´æ¥æ‰§è¡Œnew Promiseï¼Œè¾“å‡º11ã€‚ å°†thenåˆ†å‘åˆ°å¾®ä»»åŠ¡Event Queueä¸­ï¼Œè®°ä¸ºthen3ã€‚ å®ä»»åŠ¡Event Queue å¾®ä»»åŠ¡Event Queue process3 then3 ç¬¬ä¸‰è½®äº‹ä»¶å¾ªç¯å®ä»»åŠ¡æ‰§è¡Œç»“æŸï¼Œæ‰§è¡Œä¸¤ä¸ªå¾®ä»»åŠ¡process3å’Œthen3ã€‚ è¾“å‡º10ã€‚ è¾“å‡º12ã€‚ ç¬¬ä¸‰è½®äº‹ä»¶å¾ªç¯ç»“æŸï¼Œç¬¬ä¸‰è½®è¾“å‡º9ï¼Œ11ï¼Œ10ï¼Œ12ã€‚ æ•´æ®µä»£ç ï¼Œå…±è¿›è¡Œäº†ä¸‰æ¬¡äº‹ä»¶å¾ªç¯ï¼Œå®Œæ•´çš„è¾“å‡ºä¸º1ï¼Œ7ï¼Œ6ï¼Œ8ï¼Œ2ï¼Œ4ï¼Œ3ï¼Œ5ï¼Œ9ï¼Œ11ï¼Œ10ï¼Œ12ã€‚(è¯·æ³¨æ„ï¼Œnodeç¯å¢ƒä¸‹çš„äº‹ä»¶ç›‘å¬ä¾èµ–libuvä¸å‰ç«¯ç¯å¢ƒä¸å®Œå…¨ç›¸åŒï¼Œè¾“å‡ºé¡ºåºå¯èƒ½ä¼šæœ‰è¯¯å·®) 6.å†™åœ¨æœ€å(1)jsçš„å¼‚æ­¥æˆ‘ä»¬ä»æœ€å¼€å¤´å°±è¯´javascriptæ˜¯ä¸€é—¨å•çº¿ç¨‹è¯­è¨€ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆæ–°æ¡†æ¶æ–°è¯­æ³•ç³–å®ç°çš„æ‰€è°“å¼‚æ­¥ï¼Œå…¶å®éƒ½æ˜¯ç”¨åŒæ­¥çš„æ–¹æ³•å»æ¨¡æ‹Ÿçš„ï¼Œç‰¢ç‰¢æŠŠæ¡ä½å•çº¿ç¨‹è¿™ç‚¹éå¸¸é‡è¦ã€‚ (2)äº‹ä»¶å¾ªç¯Event Loopäº‹ä»¶å¾ªç¯æ˜¯jså®ç°å¼‚æ­¥çš„ä¸€ç§æ–¹æ³•ï¼Œä¹Ÿæ˜¯jsçš„æ‰§è¡Œæœºåˆ¶ã€‚ (3)javascriptçš„æ‰§è¡Œå’Œè¿è¡Œæ‰§è¡Œå’Œè¿è¡Œæœ‰å¾ˆå¤§çš„åŒºåˆ«ï¼Œjavascriptåœ¨ä¸åŒçš„ç¯å¢ƒä¸‹ï¼Œæ¯”å¦‚nodeï¼Œæµè§ˆå™¨ï¼ŒRingoç­‰ç­‰ï¼Œæ‰§è¡Œæ–¹å¼æ˜¯ä¸åŒçš„ã€‚è€Œè¿è¡Œå¤§å¤šæŒ‡javascriptè§£æå¼•æ“ï¼Œæ˜¯ç»Ÿä¸€çš„ã€‚ (4)setImmediateå¾®ä»»åŠ¡å’Œå®ä»»åŠ¡è¿˜æœ‰å¾ˆå¤šç§ç±»ï¼Œæ¯”å¦‚setImmediateç­‰ç­‰ï¼Œæ‰§è¡Œéƒ½æ˜¯æœ‰å…±åŒç‚¹çš„ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œäº†è§£ã€‚ (5)æœ€åçš„æœ€å javascriptæ˜¯ä¸€é—¨å•çº¿ç¨‹è¯­è¨€ Event Loopæ˜¯javascriptçš„æ‰§è¡Œæœºåˆ¶","categories":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://sensitivemix.github.io/categories/å¼€å‘/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"https://sensitivemix.github.io/tags/Node-js/"}]},{"title":"æµ…æ Node.js Event Loop","slug":"æµ…æ-Node-js-Event-Loop","date":"2018-12-01T06:25:29.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/12/01/æµ…æ-Node-js-Event-Loop/","link":"","permalink":"https://sensitivemix.github.io/2018/12/01/æµ…æ-Node-js-Event-Loop/","excerpt":"","text":"ä»‹ç»è¦äº†è§£æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æŒæ¡ javascript æ˜¯å•çº¿ç¨‹ï¼Œæ‰€æœ‰çš„ä»»åŠ¡éƒ½æ˜¯åœ¨ä¸€æ¡çº¿ç¨‹ä¸Šé¢å»æ‰§è¡Œï¼Œåªæœ‰ç­‰ä¸Šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå¥½äº†æ‰ä¼šç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚ç„¶åæˆ‘ä»¬éœ€è¦äº†è§£ä»»åŠ¡çš„æ¦‚å¿µï¼ŒjavaScript å¯ä»¥åˆ†ä¸ºä¸¤ç§ä»»åŠ¡ï¼ŒåŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡ï¼ŒåŒæ­¥ä»»åŠ¡ä¼šåœ¨ä¸»çº¿ç¨‹ä¸Šé¢æ‰§è¡Œï¼Œå½¢æˆä¸€æ¡æ‰§è¡Œæ ˆã€‚å¼‚æ­¥ä»»åŠ¡ä¼šåœ¨ä¸»çº¿ç¨‹ä¹‹å¤–çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­æ‰§è¡Œï¼Œæ¯å½“å¼‚æ­¥ä»»åŠ¡æ”¯æŒå®Œæˆä¹‹åï¼Œå°±ä¼šåœ¨ä»»åŠ¡é˜Ÿåˆ—é‡Œé¢æ’å…¥ä¸€ä¸ªäº‹ä»¶ã€‚ä¸Šé¢æˆ‘ä»¬è¯´åˆ°äº†ä»»åŠ¡æ ˆå’Œä»»åŠ¡é˜Ÿåˆ—ï¼Œæˆ‘ä»¬éœ€è¦æŒæ¡æ ˆå’Œé˜Ÿåˆ—çš„åŸºæœ¬åŒºåˆ«ï¼Œæ ˆæ˜¯ç”±ç³»ç»Ÿåˆ†é…å†…å­˜ï¼Œæ ˆçš„ç‰¹ç‚¹æ˜¯å…ˆè¿›åå‡ºï¼Œè€Œé˜Ÿåˆ—çš„ç‰¹ç‚¹æ˜¯å…ˆè¿›å…ˆå‡ºã€‚äº†è§£äº†æ ˆå’Œé˜Ÿåˆ—ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ï¼Œä»€ä¹ˆæ˜¯å®ä»»åŠ¡å‘¢ï¼Ÿæ¯”å¦‚ setTimeout, setInterval,setImmediate è¿™äº›éƒ½å±äºå®ä»»åŠ¡ï¼›ä»€ä¹ˆæ˜¯å¾®ä»»åŠ¡å‘¢ï¼Ÿå¾®ä»»åŠ¡æ˜¯æŒ‡è¿›è¡Œç³»ç»Ÿ I/O æ“ä½œçš„ä¸€äº›äº‹ä»¶ï¼Œæ¯”å¦‚è¯´ Process.nextTick, Promise.then è¿™äº›å±äºå¾®ä»»åŠ¡ã€‚æµè§ˆå™¨æ˜¯å¦‚ä½•è¿è¡Œçš„å‘¢ï¼Œé¦–å…ˆä¼šæ‰§è¡Œæ ˆé‡Œé¢çš„åŒæ­¥ä»£ç ï¼Œæ¯”å¦‚è¯´æ­£å¸¸çš„å˜æˆå¤åˆ¶ï¼Œå¾ªç¯ï¼Œæ–¹æ³•æˆ–è€…ç±»çš„å®ä¾‹åŒ–ï¼Œç„¶åä¼šä¼˜å…ˆæ‰§è¡Œå¾®ä»»åŠ¡ï¼Œæœ€åæ‰ä¼šæ‰§è¡Œå®ä»»åŠ¡ã€‚ 1234567891011121314setTimeout(function()&#123; console.log(4)&#125;,0);new Promise(function(resolve)&#123; console.log(1) for( var i=0 ; i&lt;10000 ; i++ ) &#123; i==9999 &amp;&amp; resolve() &#125; console.log(2)&#125;).then(function()&#123; console.log(5)&#125;);console.log(3); 1,2,3,5,4 Node.js ä¸­çš„ Event loopæˆ‘ä»¬å†™çš„ Javascript ä»£ç é¦–å…ˆäº¤ç»™ V8 å¼•æ“å»å¤„ç†ä»£ç ä¸­è°ƒç”¨ Node APINode ä¼šäº¤ç»™ Libuv å»å¤„ç†ï¼Œé€šè¿‡é˜»å¡ I/Oå’Œå¤šçº¿ç¨‹å®ç°äº†å¼‚æ­¥ I/Oé€šè¿‡äº‹ä»¶é©±åŠ¨çš„å½¢å¼æ”¾ç½®åœ¨äº‹ä»¶é˜Ÿåˆ—ä¸­å»ï¼Œæœ€ç»ˆäº¤ä»˜ç»™æˆ‘ä»¬çš„åº”ç”¨æ‰§è¡Œé¡ºåºå¦‚ä¸‹ï¼šé¦–å…ˆä¼šæ‰§è¡Œä¸»çº¿ç¨‹ä¸­çš„åŒæ­¥ä»»åŠ¡ï¼Œç„¶åå¯»æ‰¾æ˜¯å¦å­˜åœ¨å¾®ä»»åŠ¡ï¼Œå¦‚æœå­˜åœ¨åˆ™æ‰§è¡Œå¾®ä»»åŠ¡ï¼Œä¸å­˜åœ¨åˆ™å¯»æ‰¾ timers ä¸­çš„å®ä»»åŠ¡æ”¾å…¥è‡³äº‹ä»¶é˜Ÿåˆ—ï¼Œå¦‚æœåé¢å­˜åœ¨å¾®ä»»åŠ¡ä¸æ‰§è¡Œï¼Œç»§ç»­å¯»æ‰¾æ˜¯å¦å­˜åœ¨å®ä»»åŠ¡ï¼Œä¸€æ¬¡å…¨éƒ¨æ‰§è¡Œå®Œå®ä»»åŠ¡ä¹‹åï¼Œç„¶åå†æ‰§è¡Œå¾®ä»»åŠ¡ã€‚","categories":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://sensitivemix.github.io/categories/å¼€å‘/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"https://sensitivemix.github.io/tags/Node-js/"}]},{"title":"InfluxDB å­¦ä¹ æŒ‡å—","slug":"InfluxDB-å­¦ä¹ æŒ‡å—","date":"2018-12-01T06:23:15.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/12/01/InfluxDB-å­¦ä¹ æŒ‡å—/","link":"","permalink":"https://sensitivemix.github.io/2018/12/01/InfluxDB-å­¦ä¹ æŒ‡å—/","excerpt":"","text":"å‰è¨€ influxdbæ˜¯ç›®å‰æ¯”è¾ƒæµè¡Œçš„æ—¶é—´åºåˆ—æ•°æ®åº“ã€‚ ä½•è°“æ—¶é—´åºåˆ—æ•°æ®åº“ï¼Ÿä»€ä¹ˆæ˜¯æ—¶é—´åºåˆ—æ•°æ®åº“ï¼Œæœ€ç®€å•çš„å®šä¹‰å°±æ˜¯æ•°æ®æ ¼å¼é‡ŒåŒ…å«Timestampå­—æ®µçš„æ•°æ®ï¼Œæ¯”å¦‚æŸä¸€æ—¶é—´ç¯å¢ƒçš„æ¸©åº¦ï¼ŒCPUçš„ä½¿ç”¨ç‡ç­‰ã€‚ä½†æ˜¯ï¼Œæœ‰ä»€ä¹ˆæ•°æ®ä¸åŒ…å«Timestampå‘¢ï¼Ÿå‡ ä¹æ‰€æœ‰çš„æ•°æ®å…¶å®éƒ½å¯ä»¥æ‰“ä¸Šä¸€ä¸ªTimestampå­—æ®µã€‚æ—¶é—´åºåˆ—æ•°æ®çš„æ›´é‡è¦çš„ä¸€ä¸ªå±æ€§æ˜¯å¦‚ä½•å»æŸ¥è¯¢å®ƒï¼ŒåŒ…æ‹¬æ•°æ®çš„è¿‡æ»¤ï¼Œè®¡ç®—ç­‰ç­‰ã€‚ InfluxdbInfluxdbæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼æ—¶åºã€æ—¶é—´å’ŒæŒ‡æ ‡æ•°æ®åº“ï¼Œä½¿ç”¨goè¯­è¨€ç¼–å†™ï¼Œæ— éœ€å¤–éƒ¨ä¾èµ–ã€‚å®ƒæœ‰ä¸‰å¤§ç‰¹æ€§ï¼š æ—¶åºæ€§ï¼ˆTime Seriesï¼‰ï¼šä¸æ—¶é—´ç›¸å…³çš„å‡½æ•°çš„çµæ´»ä½¿ç”¨ï¼ˆè¯¸å¦‚æœ€å¤§ã€æœ€å°ã€æ±‚å’Œç­‰ï¼‰ï¼› åº¦é‡ï¼ˆMetricsï¼‰ï¼šå¯¹å®æ—¶å¤§é‡æ•°æ®è¿›è¡Œè®¡ç®—ï¼› äº‹ä»¶ï¼ˆEventï¼‰ï¼šæ”¯æŒä»»æ„çš„äº‹ä»¶æ•°æ®ï¼Œæ¢å¥è¯è¯´ï¼Œä»»æ„äº‹ä»¶çš„æ•°æ®æˆ‘ä»¬éƒ½å¯ä»¥åšæ“ä½œã€‚ åŒæ—¶ï¼Œå®ƒæœ‰ä»¥ä¸‹å‡ å¤§ç‰¹ç‚¹ï¼š schemaless(æ— ç»“æ„)ï¼Œå¯ä»¥æ˜¯ä»»æ„æ•°é‡çš„åˆ—ï¼› min, max, sum, count, mean, median ä¸€ç³»åˆ—å‡½æ•°ï¼Œæ–¹ä¾¿ç»Ÿè®¡ï¼› Native HTTP API, å†…ç½®httpæ”¯æŒï¼Œä½¿ç”¨httpè¯»å†™ï¼› Powerful Query Language ç±»ä¼¼sqlï¼› Built-in Explorer è‡ªå¸¦ç®¡ç†å·¥å…·ã€‚ Influxdbå®‰è£… æ³¨ï¼šæœ¬æ–‡ä½¿ç”¨çš„influxdb versionæ˜¯1.0.2 åœ¨è®²è§£å…·ä½“çš„å®‰è£…æ­¥éª¤ä¹‹å‰ï¼Œå…ˆè¯´è¯´influxdbçš„ä¸¤ä¸ªhttpç«¯å£ï¼š8083å’Œ8086 port 8083ï¼šç®¡ç†é¡µé¢ç«¯å£ï¼Œè®¿é—®localhost:8083å¯ä»¥è¿›å…¥ä½ æœ¬æœºçš„influxdbç®¡ç†é¡µé¢ï¼› port 8086ï¼šhttpè¿æ¥influxdb clientç«¯å£ï¼Œä¸€èˆ¬ä½¿ç”¨è¯¥ç«¯å£å¾€æœ¬æœºçš„influxdbè¯»å†™æ•°æ®ã€‚ OS X 12brew updatebrew install influxdb Docker Image 1docker pull influxdb Ubuntu &amp; Debian 12wget https://dl.influxdata.com/influxdb/releases/influxdb_1.0.2_amd64.debsudo dpkg -i influxdb_1.0.2_amd64.deb RedHat &amp; CentOS 12wget https://dl.influxdata.com/influxdb/releases/influxdb-1.0.2.x86_64.rpmsudo yum localinstall influxdb-1.0.2.x86_64.rpm Standalone Linux Binaries (64-bit) 12wget https://dl.influxdata.com/influxdb/releases/influxdb-1.0.2_linux_amd64.tar.gz tar xvfz influxdb-1.0.2_linux_amd64.tar.gz Standalone Linux Binaries (32-bit) 12wget https://dl.influxdata.com/influxdb/releases/influxdb-1.0.2_linux_i386.tar.gztar xvfz influxdb-1.0.2_linux_i386.tar.gz Standalone Linux Binaries (ARM) 12wget https://dl.influxdata.com/influxdb/releases/influxdb-1.0.2_linux_armhf.tar.gztar xvfz influxdb-1.0.2_linux_armhf.tar.gz How to startï¼Ÿå®‰è£…å®Œä¹‹åï¼Œå¦‚ä½•å¯åŠ¨å‘¢ï¼Ÿ 1sudo service influxdb start 1brew services start influxdb (OSX å¯åŠ¨ influxdb) 1brew services stop influxdb (OSX å…³é—­ influxdb) åˆ°è¿™é‡Œinfluxdbå®‰è£…å¯åŠ¨å®Œæˆï¼Œå¯ä»¥è®¿é—®influxdbç®¡ç†é¡µé¢ï¼šæœ¬åœ°ç®¡ç†é¡µé¢ï¼Œè¯¥ç‰ˆæœ¬æ²¡æœ‰ç™»å½•ç”¨æˆ·åŠå¯†ç ï¼Œå¯ä»¥è‡ªè¡Œè®¾ç½®è¯»å†™çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ å¦‚ä½•åœ¨å‘½ä»¤è¡Œä½¿ç”¨å®‰è£…å®Œæ¯•ä¹‹åï¼Œå¦‚ä½•åœ¨å‘½ä»¤è¡Œä½¿ç”¨å‘¢ï¼Ÿ influxdbåœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ influxdbåŸºæœ¬æ“ä½œ åè¯è§£é‡Šåœ¨å…·ä½“çš„è®²è§£influxdbçš„ç›¸å…³æ“ä½œä¹‹å‰å…ˆè¯´è¯´influxdbçš„ä¸€äº›ä¸“æœ‰åè¯ï¼Œè¿™äº›åè¯ä»£è¡¨ä»€ä¹ˆã€‚ influxdbç›¸å…³åè¯ databaseï¼šæ•°æ®åº“ï¼› measurementï¼šæ•°æ®åº“ä¸­çš„è¡¨ï¼› pointsï¼šè¡¨é‡Œé¢çš„ä¸€è¡Œæ•°æ®ã€‚ influxDBä¸­ç‹¬æœ‰çš„ä¸€äº›æ¦‚å¿µPointç”±æ—¶é—´æˆ³ï¼ˆtimeï¼‰ã€æ•°æ®ï¼ˆfieldï¼‰å’Œæ ‡ç­¾ï¼ˆtagsï¼‰ç»„æˆã€‚ timeï¼šæ¯æ¡æ•°æ®è®°å½•çš„æ—¶é—´ï¼Œä¹Ÿæ˜¯æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆçš„ä¸»ç´¢å¼•ï¼› fieldsï¼šå„ç§è®°å½•çš„å€¼ï¼› tagsï¼šå„ç§æœ‰ç´¢å¼•çš„å±æ€§ã€‚ è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„åè¯ï¼šseriesæ‰€æœ‰åœ¨æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œéƒ½éœ€è¦é€šè¿‡å›¾è¡¨æ¥è¡¨ç¤ºï¼Œseriesè¡¨ç¤ºè¿™ä¸ªè¡¨é‡Œé¢çš„æ‰€æœ‰çš„æ•°æ®å¯ä»¥åœ¨å›¾æ ‡ä¸Šç”»æˆå‡ æ¡çº¿ï¼ˆæ³¨ï¼šçº¿æ¡çš„ä¸ªæ•°ç”±tagsæ’åˆ—ç»„åˆè®¡ç®—å‡ºæ¥ï¼‰ä¸¾ä¸ªç®€å•çš„å°æ —å­ï¼šæœ‰å¦‚ä¸‹æ•°æ®ï¼š error_time å®ƒçš„seriesä¸ºï¼š error_time_series influxdbåŸºæœ¬æ“ä½œ æ•°æ®åº“ä¸è¡¨çš„æ“ä½œå¯ä»¥ç›´æ¥åœ¨webç®¡ç†é¡µé¢åšæ“ä½œï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å‘½ä»¤è¡Œã€‚ 1234567891011121314#åˆ›å»ºæ•°æ®åº“create database &quot;db_name&quot;#æ˜¾ç¤ºæ‰€æœ‰çš„æ•°æ®åº“show databases#åˆ é™¤æ•°æ®åº“drop database &quot;db_name&quot;#ä½¿ç”¨æ•°æ®åº“use db_name#æ˜¾ç¤ºè¯¥æ•°æ®åº“ä¸­æ‰€æœ‰çš„è¡¨show measurements#åˆ›å»ºè¡¨ï¼Œç›´æ¥åœ¨æ’å…¥æ•°æ®çš„æ—¶å€™æŒ‡å®šè¡¨åinsert test,host=127.0.0.1,monitor_name=test count=1#åˆ é™¤è¡¨drop measurement &quot;measurement_name&quot; å¢å‘æ•°æ®åº“ä¸­æ’å…¥æ•°æ®ã€‚ é€šè¿‡å‘½ä»¤è¡Œ 12use testDbinsert test,host=127.0.0.1,monitor_name=test count=1 é€šè¿‡httpæ¥å£ 1curl -i -XPOST &apos;http://127.0.0.1:8086/write?db=testDb&apos; --data-binary &apos;test,host=127.0.0.1,monitor_name=test count=1&apos; è¯»è€…çœ‹åˆ°è¿™é‡Œå¯èƒ½ä¼šè§‚å¯Ÿåˆ°æ’å…¥çš„æ•°æ®çš„æ ¼å¼è²Œä¼¼æ¯”è¾ƒå¥‡æ€ªï¼Œè¿™æ˜¯å› ä¸ºinfluxDBå­˜å‚¨æ•°æ®é‡‡ç”¨çš„æ˜¯Line Protocolæ ¼å¼ã€‚é‚£ä¹ˆä½•è°“Line Protocoæ ¼å¼ï¼Ÿ Line Protocolæ ¼å¼ï¼šå†™å…¥æ•°æ®åº“çš„Pointçš„å›ºå®šæ ¼å¼ã€‚åœ¨ä¸Šé¢çš„ä¸¤ç§æ’å…¥æ•°æ®çš„æ–¹æ³•ä¸­éƒ½æœ‰è¿™æ ·çš„ä¸€éƒ¨åˆ†ï¼š 1test,host=127.0.0.1,monitor_name=test count=1 å…¶ä¸­ï¼š testï¼šè¡¨åï¼› host=127.0.0.1,monitor_name=testï¼štagï¼› count=1ï¼šfield æƒ³å¯¹æ­¤æ ¼å¼æœ‰è¯¦ç»†çš„äº†è§£å‚è§å®˜æ–¹æ–‡æ¡£ æŸ¥æŸ¥è¯¢æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚ é€šè¿‡å‘½ä»¤è¡Œ 1select * from test order by time desc é€šè¿‡httpæ¥å£ 1curl -G &apos;http://localhost:8086/query?pretty=true&apos; --data-urlencode &quot;db=testDb&quot; --data-urlencode &quot;q=select * from test order by time desc&quot; influxDBæ˜¯æ”¯æŒç±»sqlè¯­å¥çš„ï¼Œå…·ä½“çš„æŸ¥è¯¢è¯­æ³•éƒ½å·®ä¸å¤šï¼Œè¿™é‡Œå°±ä¸å†åšè¯¦ç»†çš„èµ˜è¿°äº†ã€‚ æ•°æ®ä¿å­˜ç­–ç•¥ï¼ˆRetention Policiesï¼‰influxDBæ˜¯æ²¡æœ‰æä¾›ç›´æ¥åˆ é™¤æ•°æ®è®°å½•çš„æ–¹æ³•ï¼Œä½†æ˜¯æä¾›æ•°æ®ä¿å­˜ç­–ç•¥ï¼Œä¸»è¦ç”¨äºæŒ‡å®šæ•°æ®ä¿ç•™æ—¶é—´ï¼Œè¶…è¿‡æŒ‡å®šæ—¶é—´ï¼Œå°±åˆ é™¤è¿™éƒ¨åˆ†æ•°æ®ã€‚ æŸ¥çœ‹å½“å‰æ•°æ®åº“Retention Policies 1show retention policies on &quot;db_name&quot; ![](http://upload-images.jianshu.io/upload_images/3994601-4dbf9942cc0f671a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240) retention_policies * åˆ›å»ºæ–°çš„Retention Policies 1create retention policy &quot;rp_name&quot; on &quot;db_name&quot; duration 3w replication 1 default * rp_nameï¼šç­–ç•¥åï¼› * db_nameï¼šå…·ä½“çš„æ•°æ®åº“åï¼› * 3wï¼šä¿å­˜3å‘¨ï¼Œ3å‘¨ä¹‹å‰çš„æ•°æ®å°†è¢«åˆ é™¤ï¼Œinfluxdbå…·æœ‰å„ç§äº‹ä»¶å‚æ•°ï¼Œæ¯”å¦‚ï¼šhï¼ˆå°æ—¶ï¼‰ï¼Œdï¼ˆå¤©ï¼‰ï¼Œwï¼ˆæ˜ŸæœŸï¼‰ï¼› * replication 1ï¼šå‰¯æœ¬ä¸ªæ•°ï¼Œä¸€èˆ¬ä¸º1å°±å¯ä»¥äº†ï¼› * defaultï¼šè®¾ç½®ä¸ºé»˜è®¤ç­–ç•¥ * ä¿®æ”¹Retention Policies 1alter retention policy &quot;rp_name&quot; on &quot;db_name&quot; duration 30d default * åˆ é™¤Retention Policies 1drop retention policy &quot;rp_name&quot; è¿ç»­æŸ¥è¯¢ï¼ˆContinous Queriesï¼‰å½“æ•°æ®è¶…è¿‡ä¿å­˜ç­–ç•¥é‡ŒæŒ‡å®šçš„æ—¶é—´ä¹‹åå°±ä¼šè¢«åˆ é™¤ï¼Œä½†æ˜¯è¿™æ—¶å€™å¯èƒ½å¹¶ä¸æƒ³æ•°æ®è¢«å®Œå…¨åˆ æ‰ï¼Œæ€ä¹ˆåŠï¼Ÿinfluxdbæä¾›äº†è”ç³»æŸ¥è¯¢ï¼Œå¯ä»¥åšæ•°æ®ç»Ÿè®¡é‡‡æ ·ã€‚ æŸ¥çœ‹æ•°æ®åº“çš„Continous Queries 1show continuous queries ![](http://upload-images.jianshu.io/upload_images/3994601-d0d2b55ee261869d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240) continuous_queries. * åˆ›å»ºæ–°çš„Continous Queries 1create continous query cq_name on db_name begin select sum(count) into new_table_name from table_name group by time(30m) end * cq_nameï¼šè¿ç»­æŸ¥è¯¢åå­—ï¼› * db_nameï¼šæ•°æ®åº“åå­—ï¼› * sum(count)ï¼šè®¡ç®—æ€»å’Œï¼› * table_nameï¼šå½“å‰è¡¨åï¼› * new_table_nameï¼šå­˜æ–°çš„æ•°æ®çš„è¡¨åï¼› * 30mï¼šæ—¶é—´é—´éš”ä¸º30åˆ†é’Ÿ * åˆ é™¤Continous Queries 1drop continous query cp_name on db_name ç”¨æˆ·ç®¡ç†å¯ä»¥ç›´æ¥åœ¨webç®¡ç†é¡µé¢åšæ“ä½œï¼Œä¹Ÿå¯ä»¥å‘½ä»¤è¡Œã€‚ 1234567#æ˜¾ç¤ºç”¨æˆ· show users#åˆ›å»ºç”¨æˆ·create user &quot;username&quot; with password &apos;password&apos;#åˆ›å»ºç®¡ç†å‘˜æƒé™ç”¨æˆ·create user &quot;username&quot; with password &apos;password&apos; with all privileges#åˆ é™¤ç”¨æˆ·drop user &quot;username&quot;","categories":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://sensitivemix.github.io/categories/å¼€å‘/"}],"tags":[{"name":"InfluxDB","slug":"InfluxDB","permalink":"https://sensitivemix.github.io/tags/InfluxDB/"},{"name":"Database","slug":"Database","permalink":"https://sensitivemix.github.io/tags/Database/"}]},{"title":"mongoDB æ‰§è¡Œè®¡åˆ’åˆ†æ","slug":"mongoDB-æ‰§è¡Œè®¡åˆ’åˆ†æ","date":"2018-11-27T15:31:32.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/11/27/mongoDB-æ‰§è¡Œè®¡åˆ’åˆ†æ/","link":"","permalink":"https://sensitivemix.github.io/2018/11/27/mongoDB-æ‰§è¡Œè®¡åˆ’åˆ†æ/","excerpt":"","text":"","categories":[],"tags":[]},{"title":"å®¢æˆ·ç«¯å¦‚ä½•å¿«æ·è¿‡æ»¤ API å“åº”","slug":"å®¢æˆ·ç«¯å¦‚ä½•å¿«æ·è¿‡æ»¤-API-å“åº”","date":"2018-11-09T07:10:57.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/11/09/å®¢æˆ·ç«¯å¦‚ä½•å¿«æ·è¿‡æ»¤-API-å“åº”/","link":"","permalink":"https://sensitivemix.github.io/2018/11/09/å®¢æˆ·ç«¯å¦‚ä½•å¿«æ·è¿‡æ»¤-API-å“åº”/","excerpt":"","text":"ä¸ºä»€ä¹ˆè¦è¿‡æ»¤ éœ€æ±‚å˜æ›´é¢‘ç¹ï¼ŒAPI æ— æ³•æ¯æ¬¡éƒ½æ ¹æ®éœ€æ±‚æ›´æ–° é€‚åº”å¤šç«¯ï¼Œå„ç«¯éœ€è¦çš„å“åº”è¿”å›éƒ½ä¸ä¸€æ ·ï¼Œä¸å¯èƒ½ä¸ºæ¯ä¸ªç«¯å®šåˆ¶ API è¿”å› ä¼˜åŒ– API å“åº”æ—¶é—´ï¼Œé¿å…ä¸å¿…è¦çš„ Format æŸ¥è¯¢æ“ä½œ å¤æ‚å†—ä½™çš„ API å“åº” è·å–å®¢æˆ·åˆ—è¡¨ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687&#123; &quot;extra&quot;:&#123; &quot;orgCounts&quot;:1, &quot;showHidden&quot;:true &#125;, &quot;organizations&quot;:[ &#123; &quot;_id&quot;:&quot;5be51350f93a32ade0e2e257&quot;, &quot;updateTime&quot;:&quot;2018-11-09T04:55:45.203Z&quot;, &quot;name&quot;:&quot;èœ€å›½&quot;, &quot;_workspaceId&quot;:&quot;5bd87ecba00f2b0001921b27&quot;, &quot;fields&quot;:[ ], &quot;undoneActivities&quot;:0, &quot;doneActivities&quot;:0, &quot;totalActivities&quot;:0, &quot;nextActivityDate&quot;:null, &quot;lastActivityDate&quot;:null, &quot;isPublic&quot;:false, &quot;isArchive&quot;:false, &quot;lostDeals&quot;:0, &quot;wonDeals&quot;:0, &quot;closedDeals&quot;:0, &quot;openDeals&quot;:0, &quot;numberOfEmployees&quot;:&quot;&quot;, &quot;quality&quot;:null, &quot;status&quot;:&#123; &quot;_fixedFieldId&quot;:&quot;5bd87ed761c2bf77fde85a2c&quot;, &quot;value&quot;:&quot;5bd87ed7d2e7854a5278b24a&quot;, &quot;choices&quot;:[ &#123; &quot;pos&quot;:65536, &quot;value&quot;:&quot;è¯•ç”¨&quot;, &quot;_id&quot;:&quot;5bd87ed7d2e7854a5278b24a&quot; &#125;, &#123; &quot;pos&quot;:131072, &quot;value&quot;:&quot;Onboarding&quot;, &quot;_id&quot;:&quot;5bd87ed7d2e7854a5278b249&quot; &#125;, &#123; &quot;pos&quot;:196608, &quot;value&quot;:&quot;Retention&quot;, &quot;_id&quot;:&quot;5bd87ed7d2e7854a5278b248&quot; &#125;, &#123; &quot;pos&quot;:262144, &quot;value&quot;:&quot;Renew&quot;, &quot;_id&quot;:&quot;5bd87ed7d2e7854a5278b247&quot; &#125;, &#123; &quot;pos&quot;:327680, &quot;value&quot;:&quot;æµå¤±&quot;, &quot;_id&quot;:&quot;5bd87ed7d2e7854a5278b246&quot; &#125; ] &#125;, &quot;area&quot;:&quot;&quot;, &quot;city&quot;:&quot;&quot;, &quot;avatarUrl&quot;:&quot;http://tcs.project.ci/thumbnail/010x5741bc1bce56f84c34f4b9855ce079b3/w/200/h/200&quot;, &quot;province&quot;:&quot;&quot;, &quot;industry&quot;:&quot;&quot;, &quot;country&quot;:&quot;&quot;, &quot;address&quot;:&quot;&quot;, &quot;allocateTime&quot;:&quot;2018-11-09T04:55:44.674Z&quot;, &quot;updateNoteTime&quot;:null, &quot;createdTime&quot;:&quot;2018-11-09T04:55:44.674Z&quot;, &quot;people&quot;:0, &quot;note&quot;:&quot;&quot;, &quot;products&quot;:[ ], &quot;creator&quot;:&#123; &quot;_id&quot;:&quot;599e33ce7c814524278308c2&quot;, &quot;name&quot;:&quot;jack&quot; &#125;, &quot;owner&quot;:&#123; &quot;_id&quot;:&quot;599e33ce7c814524278308c2&quot;, &quot;name&quot;:&quot;jack&quot; &#125;, &quot;__v&quot;:0 &#125; ]&#125; å¦‚ä½•è‡ªå®šä¹‰ API å“åº”Field-Masks (å­—æ®µæ©ç ) ä½¿ç”¨å­—æ®µæ©ç è¿›è¡Œè¯»å–| ä¾‹å­ | å½±å“ ||:â€”-|| items | è¿”å›itemsæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼ŒåŒ…æ‹¬æ¯ä¸ªå…ƒç´ ä¸­çš„æ‰€æœ‰å­—æ®µï¼Œä½†ä¸åŒ…å«å…¶ä»–å­—æ®µã€‚ || etag,items | è¿”å›etagitemsæ•°ç»„ä¸­çš„å­—æ®µå’Œæ‰€æœ‰å…ƒç´ ã€‚ || items/title | ä»…è¿”å›titleitemsæ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ çš„å­—æ®µã€‚æ¯å½“è¿”å›åµŒå¥—å­—æ®µæ—¶ï¼Œå“åº”éƒ½åŒ…å«å°é—­çš„çˆ¶å¯¹è±¡ã€‚é™¤éæ˜ç¡®é€‰æ‹©çˆ¶å­—æ®µï¼Œå¦åˆ™çˆ¶å­—æ®µä¸åŒ…æ‹¬ä»»ä½•å…¶ä»–å­å­—æ®µã€‚ || context/facets/label | ä»…è¿”å›æ•°ç»„çš„labelæ‰€æœ‰æˆå‘˜çš„å­—æ®µï¼Œè¯¥facetsæ•°ç»„æœ¬èº«åµŒå¥—åœ¨contextå¯¹è±¡ä¸‹ã€‚ || items/pagemap/*/title | å¯¹äºitemsæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œä»…è¿”å›ä½œä¸ºå­é¡¹titleçš„æ‰€æœ‰å¯¹è±¡çš„å­—æ®µï¼ˆå¦‚æœå­˜åœ¨ï¼‰pagemapã€‚ | ä½¿ç”¨å­—æ®µæ©ç è¿›è¡Œæ›´æ–°1POST https://slides.googleapis.com/v1/presentations/presentationId:batchUpdate 12345678910111213141516171819&#123; &quot;requests&quot;: [ &#123; &quot;updateShapeProperties&quot;: &#123; &quot;objectId&quot;: elementId, &quot;shapeProperties&quot;: &#123; &quot;shapeBackgroundFill&quot;: &#123; &quot;solidFill&quot;: &#123; &quot;color&quot;: &#123; &quot;themeColor&quot;: &quot;DARK1&quot; &#125; &#125; &#125; &#125;, &quot;fields&quot;: &quot;shapeBackgroundFill.solidFill.color,outline&quot; &#125; &#125; ]&#125; å¦‚ä½•åº”ç”¨ä¸­è‡³é¡¹ç›® åŸºç¡€è½®å­ï¼šJSON-MASK KOA2.X: koa-json-mask KOA1.X: koa1-json-mask","categories":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://sensitivemix.github.io/categories/å¼€å‘/"}],"tags":[{"name":"Frontend","slug":"Frontend","permalink":"https://sensitivemix.github.io/tags/Frontend/"}]},{"title":"Node.js åº”ç”¨æœ€ä½³å®è·µ","slug":"Node-js-åº”ç”¨æœ€ä½³å®è·µ","date":"2018-09-03T07:01:29.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/09/03/Node-js-åº”ç”¨æœ€ä½³å®è·µ/","link":"","permalink":"https://sensitivemix.github.io/2018/09/03/Node-js-åº”ç”¨æœ€ä½³å®è·µ/","excerpt":"","text":"åŸºäº Express å®è·µï¼ŒExpress æ˜¯ä¸€ä¸ªç®€æ´è€Œçµæ´»çš„ node.js Webåº”ç”¨æ¡†æ¶, æä¾›äº†ä¸€ç³»åˆ—å¼ºå¤§ç‰¹æ€§å¸®åŠ©ä½ åˆ›å»ºå„ç§ Web åº”ç”¨ï¼Œå’Œä¸°å¯Œçš„ HTTP å·¥å…·ã€‚ é¡¹ç›®ç»“æ„å®è·µ1.1 ç»„ä»¶å¼æ„å»ºä½ çš„è§£å†³æ–¹æ¡ˆ (The Future)å®šä¹‰ï¼šå¤§å‹é¡¹ç›®çš„æœ€åçš„éšæ‚£å°±æ˜¯ç»´æŠ¤ä¸€ä¸ªåºå¤§çš„ï¼Œå«æœ‰å‡ ç™¾ä¸ªä¾èµ–çš„ä»£ç åº“ - å½“å¼€å‘äººå‘˜å‡†å¤‡æ•´åˆæ–°çš„éœ€æ±‚çš„æ—¶å€™ï¼Œè¿™æ ·ä¸€ä¸ªåºç„¶å¤§ç‰©åŠ¿å¿…å‡ç¼“äº†å¼€å‘æ•ˆç‡ã€‚åä¹‹ï¼ŒæŠŠæ‚¨çš„ä»£ç æ‹†åˆ†æˆç»„ä»¶ï¼Œæ¯ä¸€ä¸ªç»„ä»¶æœ‰å®ƒè‡ªå·±çš„æ–‡ä»¶å¤¹å’Œä»£ç åº“ï¼Œå¹¶ä¸”ç¡®ä¿æ¯ä¸€ä¸ªç»„ä»¶å°è€Œç®€å•ã€‚ å¦åˆ™: å½“ç¼–å†™æ–°éœ€æ±‚çš„å¼€å‘äººå‘˜é€æ­¥æ„è¯†åˆ°ä»–æ‰€åšæ”¹å˜çš„å½±å“ï¼Œå¹¶æ‹…å¿ƒä¼šç ´åå…¶ä»–çš„ä¾èµ–æ¨¡å— - éƒ¨ç½²ä¼šå˜å¾—æ›´æ…¢ï¼Œé£é™©æ›´å¤§ã€‚å½“æ‰€æœ‰ä¸šåŠ¡é€»è¾‘æ²¡æœ‰è¢«åˆ†å¼€ï¼Œè¿™ä¹Ÿä¼šè¢«è®¤ä¸ºå¾ˆéš¾æ‰©å±• 1.1.1 Bad: Group your files by technical role 1.1.2 Good: Structure your solution by self-contained components 1.2 åˆ†å±‚è®¾è®¡ç»„ä»¶ï¼Œä¿æŒé¡¹ç›®ç»“æ„åœ¨ç‰¹å®šçš„åŒºåŸŸå®šä¹‰: æ¯ä¸€ä¸ªç»„ä»¶éƒ½åº”è¯¥åŒ…å«ã€Œå±‚çº§ã€ - ä¸€ä¸ªä¸“æ³¨çš„ç”¨äºæ¥å…¥ç½‘ç»œï¼Œé€»è¾‘ï¼Œæ•°æ®çš„æ¦‚å¿µã€‚è¿™æ ·ä¸ä»…è·å¾—ä¸€ä¸ªæ¸…æ™°çš„åˆ†ç¦»è€ƒé‡ï¼Œè€Œä¸”ä½¿ä»¿çœŸï¼ˆmock-serverï¼‰å’Œæµ‹è¯•ç³»ç»Ÿå˜å¾—å¼‚å¸¸å®¹æ˜“ã€‚å°½ç®¡è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„æ¨¡å¼ï¼Œä½†æ¥å£å¼€å‘è€…æ˜“äºæ··æ·†å±‚çº§å…³ç³»ï¼Œæ¯”å¦‚æŠŠç½‘ç»œå±‚çš„å¯¹è±¡ï¼ˆreq, resï¼‰ä¼ ç»™ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®å±‚ - è¿™ä¼šä»¤æ‚¨çš„åº”ç”¨å½¼æ­¤ä¾èµ–ï¼Œå¹¶ä¸”åªèƒ½é€šè¿‡Expressä½¿ç”¨ã€‚ å¦åˆ™: å¯¹äºæ··æ·†äº†ç½‘ç»œå±‚å’Œå…¶å®ƒå±‚çš„åº”ç”¨ï¼Œå°†ä¸æ˜“äºæµ‹è¯•ï¼Œæ‰§è¡Œ CRON çš„ä»»åŠ¡ï¼Œå…¶å®ƒé-Express çš„è°ƒç”¨è€…æ— æ³•ä½¿ç”¨ å¯¹æ¯”é€»è¾‘åˆ†å±‚é‡è¦æ€§ 1.3 å°è£…å…¬å…±æ¨¡å—æˆä¸ºNPMçš„åŒ…å®šä¹‰: ç”±å¤§é‡ä»£ç æ„æˆçš„ä¸€ä¸ªå¤§å‹åº”ç”¨ä¸­ï¼Œè´¯å½»å…¨å±€çš„ï¼Œæ¯”å¦‚æ—¥å¿—ï¼ŒåŠ å¯†å’Œå…¶å®ƒç±»ä¼¼çš„å…¬å…±ç»„ä»¶ï¼Œåº”è¯¥è¿›è¡Œå°è£…ï¼Œå¹¶æš´éœ²æˆä¸€ä¸ªç§æœ‰çš„NPMåŒ…ã€‚è¿™å°†ä½¿å…¶åœ¨æ›´å¤šçš„ä»£ç åº“å’Œé¡¹ç›®ä¸­è¢«ä½¿ç”¨å˜æˆäº†å¯èƒ½ã€‚ å¦åˆ™: æ‚¨å°†ä¸å¾—ä¸é‡é€ éƒ¨ç½²å’Œä¾èµ–çš„è½®å­ åœ¨ç¯å¢ƒå’Œç»„ä»¶ä¸­å…±äº«ä½ è‡ªå·±çš„å…¬ç”¨å®ç”¨å·¥å…· 1.4 åˆ†ç¦» Express â€˜appâ€™ and â€˜serverâ€™å®šä¹‰: é¿å…å®šä¹‰æ•´ä¸ª Express åº”ç”¨åœ¨ä¸€ä¸ªå•ç‹¬çš„å¤§æ–‡ä»¶é‡Œï¼Œ è¿™æ˜¯ä¸€ä¸ªä¸å¥½çš„ä¹ æƒ¯ - åˆ†ç¦»æ‚¨çš„ ã€ŒExpressã€ å®šä¹‰è‡³å°‘åœ¨ä¸¤ä¸ªæ–‡ä»¶ä¸­ï¼š APIå£°æ˜(app.js) å’Œ ç½‘ç»œç›¸å…³(WWW)ã€‚å¯¹äºæ›´å¥½çš„ç»“æ„ï¼Œæ˜¯æŠŠä½ çš„APIå£°æ˜æ”¾åœ¨ç»„ä»¶ä¸­ã€‚ å¦åˆ™: æ‚¨çš„ API å°†åªèƒ½é€šè¿‡ HTTP çš„è°ƒç”¨è¿›è¡Œæµ‹è¯•ï¼ˆæ…¢ï¼Œå¹¶ä¸”å¾ˆéš¾äº§ç”Ÿæµ‹è¯•è¦†ç›–æŠ¥å‘Šï¼‰ã€‚ç»´æŠ¤ä¸€ä¸ªæœ‰ç€ä¸Šç™¾è¡Œä»£ç çš„æ–‡ä»¶ä¹Ÿä¸æ˜¯ä¸€ä¸ªä»¤äººå¼€å¿ƒçš„äº‹æƒ…ã€‚ ä¸€æ®µè§£é‡Šæœ€æ–°çš„ Express ç”Ÿæˆå™¨æœ‰ä¸€ä¸ªå€¼å¾—ä¿ç•™çš„ä¼Ÿå¤§å®è·µâ€“APIå£°æ˜ä¸ç½‘ç»œç›¸å…³é…ç½®ï¼ˆç«¯å£ã€åè®®ç­‰ï¼‰æ˜¯åˆ†å¼€çš„ã€‚è¿™æ ·å°±å¯ä»¥åœ¨ä¸æ‰§è¡Œç½‘ç»œè°ƒç”¨çš„æƒ…å†µä¸‹å¯¹APIè¿›è¡Œåœ¨çº¿æµ‹è¯•ï¼Œå®ƒæ‰€å¸¦æ¥çš„å¥½å¤„æ˜¯ï¼šå¿«é€Ÿæ‰§è¡Œæµ‹è¯•æ“ä½œå’Œè·å–ä»£ç è¦†ç›–ç‡ã€‚å®ƒè¿˜å…è®¸åœ¨çµæ´»å¤šæ ·çš„ç½‘ç»œæ¡ä»¶ä¸‹éƒ¨ç½²ç›¸åŒçš„APIã€‚é¢å¤–å¥½å¤„ï¼šæ›´å¥½çš„å…³æ³¨ç‚¹åˆ†ç¦»å’Œæ›´æ¸…æ™°çš„ä»£ç ç»“æ„ã€‚ ä»£ç ç¤ºä¾‹ï¼šAPIå£°æ˜åº”è¯¥åœ¨ app.js æ–‡ä»¶é‡Œé¢1234var app = express();app.use(bodyParser.json());app.use(&quot;/api/events&quot;, events.API);app.use(&quot;/api/forms&quot;, forms); ### ä»£ç ç¤ºä¾‹: æœåŠ¡å™¨ç½‘ç»œå£°æ˜ï¼Œåº”è¯¥åœ¨ /bin/www æ–‡ä»¶é‡Œé¢123456789101112131415var app = require(&apos;../app&apos;);var http = require(&apos;http&apos;);/** * Get port from environment and store in Express. */var port = normalizePort(process.env.PORT || &apos;3000&apos;);app.set(&apos;port&apos;, port);/** * Create HTTP server. */var server = http.createServer(app); ### ç¤ºä¾‹ä»£ç : ä½¿ç”¨è¶…å¿«çš„æµè¡Œçš„æµ‹è¯•åŒ…åœ¨çº¿æµ‹è¯•ä½ çš„ä»£ç 1234567891011121314const app = express();app.get(&apos;/user&apos;, function(req, res) &#123; res.status(200).json(&#123; name: &apos;tobi&apos; &#125;);&#125;);request(app) .get(&apos;/user&apos;) .expect(&apos;Content-Type&apos;, /json/) .expect(&apos;Content-Length&apos;, &apos;15&apos;) .expect(200) .end(function(err, res) &#123; if (err) throw err; &#125;); 1.5 ä½¿ç”¨æ˜“äºè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå®‰å…¨å’Œåˆ†çº§çš„é…ç½®å®šä¹‰: ä¸€ä¸ªå®Œç¾æ— ç‘•çš„é…ç½®å®‰è£…åº”è¯¥ç¡®ä¿ (a) å…ƒç´ å¯ä»¥ä»æ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥ä»ç¯å¢ƒå˜é‡ä¸­è¯»å– (b) å¯†ç æ’é™¤åœ¨æäº¤çš„ä»£ç ä¹‹å¤– (c) ä¸ºäº†æ˜“äºæ£€ç´¢ï¼Œé…ç½®æ˜¯åˆ†çº§çš„ã€‚ä»…æœ‰å‡ ä¸ªåŒ…å¯ä»¥æ»¡è¶³è¿™æ ·çš„æ¡ä»¶ï¼Œæ¯”å¦‚rc, nconf å’Œ configã€‚ å¦åˆ™: ä¸èƒ½æ»¡è¶³ä»»æ„çš„é…ç½®è¦æ±‚å°†ä¼šä½¿å¼€å‘ï¼Œè¿ç»´å›¢é˜Ÿï¼Œæˆ–è€…ä¸¤è€…ï¼Œæ˜“äºé™·å…¥æ³¥æ½­ã€‚ ä¸€æ®µè§£é‡Šå½“æˆ‘ä»¬å¤„ç†é…ç½®å‚æ•°æ—¶ï¼Œå¸¸å¸¸ä¼šå¾ˆæ…¢å¹¶ä¸”å¾ˆçƒ¦èºï¼šï¼ˆ1ï¼‰å½“éœ€è¦æ³¨å…¥100ä¸ªkeys(è€Œä¸æ˜¯åªåœ¨é…ç½®æ–‡ä»¶ä¸­æäº¤å®ƒä»¬)æ—¶ï¼Œä½¿ç”¨è¿›ç¨‹ç¯å¢ƒå˜é‡è®¾ç½®æ‰€æœ‰çš„keyså˜å¾—éå¸¸ç¹çï¼Œä½†æ˜¯å½“å¤„ç†åªæœ‰devopsç®¡ç†æƒé™çš„æ–‡ä»¶æ—¶ï¼Œä¸æ”¹å˜ä»£ç è¡Œä¸ºå°±ä¸ä¸ä¼šå˜ã€‚ä¸€ä¸ªå¯é çš„é…ç½®è§£å†³æ–¹æ¡ˆå¿…é¡»ç»“åˆé…ç½®æ–‡ä»¶å’Œè¿›ç¨‹å˜é‡è¦†ç›–ã€‚ ï¼ˆ2ï¼‰æšä¸¾ä¸€ä¸ªæ™®é€šJSONçš„æ‰€æœ‰keysæ—¶ï¼Œå½“ç›®å½•å˜å¾—éå¸¸åºæ‚çš„æ—¶å€™ï¼ŒæŸ¥æ‰¾ä¿®æ”¹æ¡ç›®å›°éš¾ã€‚å‡ ä¹æ²¡æœ‰é…ç½®åº“å…è®¸å°†é…ç½®å­˜å‚¨åœ¨å¤šä¸ªæ–‡ä»¶ä¸­ï¼Œè¿è¡Œæ—¶å°†æ‰€æœ‰æ–‡ä»¶è”åˆèµ·æ¥ã€‚åˆ†æˆå‡ ä¸ªéƒ¨åˆ†çš„åˆ†å±‚JSONæ–‡ä»¶èƒ½å¤Ÿå…‹æœè¿™ä¸ªé—®é¢˜ã€‚è¯·å‚ç…§ä¸‹é¢ç¤ºä¾‹ã€‚ ï¼ˆ3ï¼‰ä¸æ¨èå­˜å‚¨åƒå¯†ç æ•°æ®è¿™æ ·çš„æ•æ„Ÿä¿¡æ¯ï¼Œä½†æ˜¯åˆæ²¡æœ‰å¿«é€Ÿä¾¿æ·çš„æ–¹æ³•è§£å†³è¿™ä¸ªéš¾é¢˜ã€‚ä¸€äº›é…ç½®åº“å…è®¸æ–‡ä»¶åŠ å¯†ï¼Œå…¶ä»–åº“åœ¨Gitæäº¤æ—¶åŠ å¯†ç›®å½•ï¼Œæˆ–è€…ä¸å­˜å‚¨è¿™äº›ç›®å½•çš„çœŸå®å€¼ï¼Œåœ¨é€šè¿‡ç¯å¢ƒå˜é‡éƒ¨ç½²æœŸé—´æšä¸¾çœŸå®å€¼ã€‚ ï¼ˆ4ï¼‰ä¸€äº›é«˜çº§é…ç½®åœºæ™¯éœ€è¦é€šè¿‡å‘½ä»¤è¡Œï¼ˆvargsï¼‰æ³¨å…¥é…ç½®å€¼ï¼Œæˆ–è€…åƒRedisä¸€æ ·é€šè¿‡é›†ä¸­ç¼“å­˜åŒæ­¥é…ç½®ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸åŒçš„æœåŠ¡å™¨ä¸ä¼šä¿å­˜ä¸åŒçš„æ•°æ®ã€‚ä¸€äº›é…ç½®åº“å¯ä»¥å…è´¹æä¾›è¿™äº›åŠŸèƒ½çš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œè¯·æŸ¥çœ‹NPMåº“ï¼ˆnconf å’Œ configï¼‰è¿™äº›åº“å¯ä»¥æ»¡è¶³è¿™äº›è¦æ±‚ä¸­çš„è®¸å¤šè¦æ±‚ã€‚ ä»£ç ç¤ºä¾‹ â€“ åˆ†å±‚é…ç½®æœ‰åŠ©äºæŸ¥æ‰¾æ¡ç›®å’Œç»´æŠ¤åºå¤§çš„é…ç½®æ–‡ä»¶123456789101112131415&#123; // Customer module configs &quot;Customer&quot;: &#123; &quot;dbConfig&quot;: &#123; &quot;host&quot;: &quot;localhost&quot;, &quot;port&quot;: 5984, &quot;dbName&quot;: &quot;customers&quot; &#125;, &quot;credit&quot;: &#123; &quot;initialLimit&quot;: 100, // Set low for development &quot;initialDays&quot;: 1 &#125; &#125;&#125; å¼‚å¸¸å¤„ç†å®è·µ2.1 ä½¿ç”¨ Async-Await å’Œ promises ç”¨äºå¼‚æ­¥é”™è¯¯å¤„ç†å®šä¹‰: ä½¿ç”¨å›è°ƒçš„æ–¹å¼å¤„ç†å¼‚æ­¥é”™è¯¯å¯èƒ½æ˜¯å¯¼è‡´ç¾éš¾çš„æœ€å¿«çš„æ–¹å¼(a.k.a the pyramid of doom)ã€‚å¯¹æ‚¨çš„ä»£ç æ¥è¯´ï¼Œæœ€å¥½çš„ç¤¼ç‰©å°±æ˜¯ä½¿ç”¨è§„èŒƒçš„ promise åº“ã€ async-await æ¥æ›¿ä»£ï¼Œè¿™ä¼šä½¿å…¶åƒ try-catch ä¸€æ ·æ›´åŠ ç®€æ´ï¼Œå…·æœ‰ç†Ÿæ‚‰çš„ä»£ç ç»“æ„ã€‚ å¦åˆ™: Node.jså›è°ƒç‰¹æ€§, function(err, response), æ˜¯å¯¼è‡´ä¸å¯ç»´æŠ¤ä»£ç çš„ä¸€ä¸ªå¿…ç„¶çš„æ–¹å¼ã€‚ç©¶å…¶åŸå› ï¼Œæ˜¯ç”±äºæ··åˆäº†éšæ„çš„é”™è¯¯å¤„ç†ä»£ç ï¼Œè‡ƒè‚¿çš„å†…åµŒï¼Œè¹©è„šçš„ä»£ç æ¨¡å¼ã€‚ ä»£ç ç¤ºä¾‹ â€“ ä½¿ç”¨promiseæ•è·é”™è¯¯123456doWork() .then(doWork) .then(doOtherWork) .then((result) =&gt; doWork) .catch((error) =&gt; &#123;throw error;&#125;) .then(verify); ### ä»£ç ç¤ºä¾‹ åæ¨¡å¼ â€“ å›è°ƒæ–¹å¼çš„é”™è¯¯å¤„ç†123456789101112getData(someParameter, function(err, result)&#123; if(err != null) //åšä¸€äº›äº‹æƒ…ç±»ä¼¼äºè°ƒç”¨ç»™å®šçš„å›è°ƒå‡½æ•°å¹¶ä¼ é€’é”™è¯¯ getMoreData(a, function(err, result)&#123; if(err != null) //åšä¸€äº›äº‹æƒ…ç±»ä¼¼äºè°ƒç”¨ç»™å®šçš„å›è°ƒå‡½æ•°å¹¶ä¼ é€’é”™è¯¯ getMoreData(b, function(c)&#123; getMoreData(d, function(e)&#123; if(err != null) //ä½ æœ‰ä»€ä¹ˆæƒ³æ³•? ïŠ &#125;);&#125;); 2.2 ä»…ä½¿ç”¨å†…å»ºçš„é”™è¯¯å¯¹è±¡å®šä¹‰: å¾ˆå¤šäººæŠ›å‡ºå¼‚å¸¸ä½¿ç”¨å­—ç¬¦ä¸²ç±»å‹æˆ–ä¸€äº›è‡ªå®šä¹‰ç±»å‹ - è¿™ä¼šå¯¼è‡´é”™è¯¯å¤„ç†é€»è¾‘å’Œæ¨¡å—é—´çš„è°ƒç”¨å¤æ‚åŒ–ã€‚æ˜¯å¦æ‚¨rejectä¸€ä¸ªpromiseï¼ŒæŠ›å‡ºå¼‚å¸¸æˆ–å‘å‡º(emit)é”™è¯¯ - ä½¿ç”¨å†…å»ºçš„é”™è¯¯å¯¹è±¡å°†ä¼šå¢åŠ è®¾è®¡ä¸€è‡´æ€§ï¼Œå¹¶é˜²æ­¢ä¿¡æ¯çš„ä¸¢å¤±ã€‚ å¦åˆ™: è°ƒç”¨æŸäº›æ¨¡å—ï¼Œå°†ä¸ç¡®å®šå“ªç§é”™è¯¯ç±»å‹ä¼šè¿”å› - è¿™å°†ä¼šä½¿æ°å½“çš„é”™è¯¯å¤„ç†æ›´åŠ å›°éš¾ã€‚æ›´åçš„æƒ…å†µæ˜¯ï¼Œä½¿ç”¨ç‰¹å®šçš„ç±»å‹æè¿°é”™è¯¯ï¼Œä¼šå¯¼è‡´é‡è¦çš„é”™è¯¯ä¿¡æ¯ç¼ºå¤±ï¼Œæ¯”å¦‚ stack traceï¼ ä»£ç ç¤ºä¾‹ â€“ æ­£ç¡®å¤„ç†å®ƒ12345678910111213//ä»å…¸å‹å‡½æ•°æŠ›å‡ºé”™è¯¯, æ— è®ºæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ if(!productToAdd) throw new Error(&quot;How can I add new product when no value provided?&quot;); //ä»EventEmitteræŠ›å‡ºé”™è¯¯const myEmitter = new MyEmitter();myEmitter.emit(&apos;error&apos;, new Error(&apos;whoops!&apos;)); //ä»promiseæŠ›å‡ºé”™è¯¯ return new promise(function (resolve, reject) &#123; Return DAL.getProduct(productToAdd.id).then((existingProduct) =&gt; &#123; if(existingProduct != null) reject(new Error(&quot;Why fooling us and trying to add an existing product?&quot;)); ### ä»£ç ç¤ºä¾‹ â€“ åæ¨¡å¼123//æŠ›å‡ºå­—ç¬¦ä¸²é”™è¯¯ç¼ºå°‘ä»»ä½•stack traceä¿¡æ¯å’Œå…¶ä»–é‡è¦å±æ€§if(!productToAdd) throw (&quot;How can I add new product when no value provided?&quot;); ### ä»£ç ç¤ºä¾‹ â€“ æ›´å¥½å¤„ç†å®ƒ123456789101112131415//ä»nodeé”™è¯¯æ´¾ç”Ÿçš„é›†ä¸­é”™è¯¯å¯¹è±¡function appError(name, httpCode, description, isOperational) &#123; Error.call(this); Error.captureStackTrace(this); this.name = name; //...åœ¨è¿™èµ‹å€¼å…¶å®ƒå±æ€§&#125;;appError.prototype.__proto__ = Error.prototype;module.exports.appError = appError; //å®¢æˆ·ç«¯æŠ›å‡ºä¸€ä¸ªé”™è¯¯if(user == null) throw new appError(commonErrors.resourceNotFound, commonHTTPErrors.notFound, &quot;further explanation&quot;, true) 2.3 åŒºåˆ†è¿è¡Œé”™è¯¯å’Œç¨‹åºè®¾è®¡é”™è¯¯å®šä¹‰: è¿è¡Œé”™è¯¯ï¼ˆä¾‹å¦‚, APIæ¥å—åˆ°ä¸€ä¸ªæ— æ•ˆçš„è¾“å…¥ï¼‰æŒ‡çš„æ˜¯ä¸€äº›å·²çŸ¥åœºæ™¯ä¸‹çš„é”™è¯¯ï¼Œè¿™ç±»é”™è¯¯çš„å½±å“å·²ç»å®Œå…¨è¢«ç†è§£ï¼Œå¹¶èƒ½è¢«è€ƒè™‘å‘¨å…¨çš„å¤„ç†æ‰ã€‚åŒæ—¶ï¼Œç¨‹åºè®¾è®¡é”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œå°è¯•è¯»å–æœªå®šä¹‰çš„å˜é‡ï¼‰æŒ‡çš„æ˜¯æœªçŸ¥çš„ç¼–ç é—®é¢˜ï¼Œå½±å“åˆ°åº”ç”¨å¾—å½“çš„é‡å¯ã€‚ å¦åˆ™: å½“ä¸€ä¸ªé”™è¯¯äº§ç”Ÿçš„æ—¶å€™ï¼Œæ‚¨æ€»æ˜¯å¾—é‡å¯åº”ç”¨ï¼Œä½†ä¸ºä»€ä¹ˆè¦è®© ~5000 ä¸ªåœ¨çº¿ç”¨æˆ·ä¸èƒ½è®¿é—®ï¼Œä»…ä»…æ˜¯å› ä¸ºä¸€ä¸ªç»†å¾®çš„ï¼Œå¯ä»¥é¢„æµ‹çš„ï¼Œè¿è¡Œæ—¶é”™è¯¯ï¼Ÿç›¸åçš„æ–¹æ¡ˆï¼Œä¹Ÿä¸å®Œç¾ â€“ å½“æœªçŸ¥çš„é—®é¢˜ï¼ˆç¨‹åºé—®é¢˜ï¼‰äº§ç”Ÿçš„æ—¶å€™ï¼Œä½¿åº”ç”¨ä¾æ—§å¯ä»¥è®¿é—®ï¼Œå¯èƒ½å¯¼è‡´ä¸å¯é¢„æµ‹è¡Œä¸ºã€‚åŒºåˆ†ä¸¤è€…ä¼šä½¿å¤„ç†æ›´æœ‰æŠ€å·§ï¼Œå¹¶åœ¨ç»™å®šçš„ä¸Šä¸‹æ–‡ä¸‹ç»™å‡ºä¸€ä¸ªå¹³è¡¡çš„å¯¹ç­–ã€‚ ä¸€æ®µè§£é‡ŠåŒºåˆ†ä»¥ä¸‹ä¸¤ç§é”™è¯¯ç±»å‹å°†æœ€å¤§é™åº¦åœ°å‡å°‘åº”ç”¨ç¨‹åºåœæœºæ—¶é—´å¹¶å¸®åŠ©é¿å…å‡ºç°è’å”çš„é”™è¯¯: æ“ä½œå‹é”™è¯¯æŒ‡çš„æ˜¯æ‚¨äº†è§£å‘ç”Ÿäº†ä»€ä¹ˆæƒ…å†µåŠå…¶å½±å“çš„æƒ…å½¢ â€“ ä¾‹å¦‚, ç”±äºè¿æ¥é—®é¢˜è€Œå¯¼è‡´å¯¹æŸäº› HTTP æœåŠ¡çš„æŸ¥è¯¢å¤±è´¥é—®é¢˜ã€‚å¦ä¸€æ–¹é¢, ç¨‹åºå‹é”™è¯¯æŒ‡çš„æ˜¯æ‚¨ä¸çŸ¥é“åŸå› , æœ‰æ—¶æ˜¯é”™è¯¯ä¸çŸ¥é“æ¥è‡ªä½•å¤„çš„æƒ…å†µ â€“ å¯èƒ½æ˜¯ä¸€äº›ä»£ç è¯•å›¾è¯»å–æœªå®šä¹‰çš„å€¼æˆ– DB è¿æ¥æ± å†…å­˜æ³„æ¼ã€‚æ“ä½œå‹é”™è¯¯ç›¸å¯¹å®¹æ˜“å¤„ç† â€“ é€šå¸¸è®°å½•é”™è¯¯å°±è¶³å¤Ÿäº†ã€‚å½“ç¨‹åºå‹é”™è¯¯å‡ºç°ï¼Œäº‹æƒ…å˜å¾—éš¾ä»¥åº”ä»˜, åº”ç”¨ç¨‹åºå¯èƒ½å¤„äºä¸ä¸€è‡´çŠ¶æ€, ä½ å¯ä»¥åšçš„ï¼Œæ²¡æœ‰ä»€ä¹ˆæ¯”ä¼˜é›…çš„é‡æ–°å¯åŠ¨æ›´å¥½äº†ã€‚ ä»£ç ç¤ºä¾‹ â€“ å°†é”™è¯¯æ ‡è®°ä¸ºå¯æ“ä½œ (å—ä¿¡ä»»)1234567891011121314//å°†é”™è¯¯æ ‡è®°ä¸ºå¯æ“ä½œ var myError = new Error(&quot;How can I add new product when no value provided?&quot;);myError.isOperational = true; //æˆ–è€…, å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ä¸€äº›é›†ä¸­å¼é”™è¯¯å·¥å‚ (è¯·å‚è§é¡¹ç›®ç¬¦å·ä¸­çš„ç¤ºä¾‹&quot;ä»…ä½¿ç”¨å†…ç½®é”™è¯¯å¯¹è±¡&quot;)function appError(commonType, description, isOperational) &#123; Error.call(this); Error.captureStackTrace(this); this.commonType = commonType; this.description = description; this.isOperational = isOperational;&#125;; throw new appError(errorManagement.commonErrors.InvalidInput, &quot;Describe here what happened&quot;, true); ## 2.4 é›†ä¸­å¤„ç†é”™è¯¯ï¼Œä¸è¦åœ¨ Express ä¸­é—´ä»¶ä¸­å¤„ç†é”™è¯¯å®šä¹‰: é”™è¯¯å¤„ç†é€»è¾‘ï¼Œæ¯”å¦‚ç»™ç®¡ç†å‘˜å‘é€é‚®ä»¶ï¼Œæ—¥å¿—åº”è¯¥å°è£…åœ¨ä¸€ä¸ªç‰¹å®šçš„ï¼Œé›†ä¸­çš„å¯¹è±¡å½“ä¸­ï¼Œè¿™æ ·å½“é”™è¯¯äº§ç”Ÿçš„æ—¶å€™ï¼Œæ‰€æœ‰çš„ç»ˆç«¯ï¼ˆä¾‹å¦‚ Expressä¸­é—´ä»¶ï¼Œcron ä»»åŠ¡ï¼Œå•å…ƒæµ‹è¯•ï¼‰éƒ½å¯ä»¥è°ƒç”¨ã€‚ å¦åˆ™: é”™è¯¯å¤„ç†çš„é€»è¾‘ä¸æ”¾åœ¨ä¸€èµ·å°†ä¼šå¯¼è‡´ä»£ç é‡å¤å’Œéå¸¸å¯èƒ½ä¸æ°å½“çš„é”™è¯¯å¤„ç†ã€‚ ä¸€æ®µè§£é‡Šå¦‚æœæ²¡æœ‰ä¸€ä¸ªä¸“ç”¨çš„é”™è¯¯å¤„ç†å¯¹è±¡ï¼Œé‚£ä¹ˆç”±äºæ“ä½œä¸å½“ï¼Œåœ¨é›·è¾¾ä¸‹é‡è¦é”™è¯¯è¢«éšè—çš„å¯èƒ½æ€§å°±ä¼šæ›´å¤§ã€‚é”™è¯¯å¤„ç†å¯¹è±¡è´Ÿè´£ä½¿é”™è¯¯å¯è§ï¼Œä¾‹å¦‚é€šè¿‡å†™å…¥ä¸€ä¸ªæ ¼å¼åŒ–è‰¯å¥½çš„loggerï¼Œé€šè¿‡ç”µå­é‚®ä»¶å°†äº‹ä»¶å‘é€åˆ°æŸä¸ªç›‘æ§äº§å“æˆ–ç®¡ç†å‘˜ã€‚ä¸€ä¸ªå…¸å‹çš„é”™è¯¯å¤„ç†æµç¨‹å¯èƒ½æ˜¯ï¼šä¸€äº›æ¨¡å—æŠ›å‡ºä¸€ä¸ªé”™è¯¯ -&gt; APIè·¯ç”±å™¨æ•è·é”™è¯¯ -&gt; å®ƒä¼ æ’­é”™è¯¯ç»™è´Ÿè´£æ•è·é”™è¯¯çš„ä¸­é—´ä»¶ï¼ˆå¦‚Expressï¼ŒKOAï¼‰-&gt; é›†ä¸­å¼é”™è¯¯å¤„ç†ç¨‹åºè¢«è°ƒç”¨ -&gt; ä¸­é—´ä»¶æ­£åœ¨è¢«å‘Šä¹‹è¿™ä¸ªé”™è¯¯æ˜¯å¦æ˜¯ä¸€ä¸ªä¸å¯ä¿¡çš„é”™è¯¯ï¼ˆä¸æ˜¯æ“ä½œå‹é”™è¯¯ï¼‰ï¼Œè¿™æ ·å¯ä»¥ä¼˜é›…çš„é‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åºã€‚æ³¨æ„ï¼Œåœ¨Expressä¸­é—´ä»¶ä¸­å¤„ç†é”™è¯¯æ˜¯ä¸€ç§å¸¸è§ä½†åˆé”™è¯¯çš„åšæ³•ï¼Œè¿™æ ·åšä¸ä¼šè¦†ç›–åœ¨éWebæ¥å£ä¸­æŠ›å‡ºçš„é”™è¯¯ã€‚ ä»£ç ç¤ºä¾‹ â€“ ä¸€ä¸ªå…¸å‹é”™è¯¯æµ12345678910111213141516171819202122232425//DALå±‚, åœ¨è¿™é‡Œæˆ‘ä»¬ä¸å¤„ç†é”™è¯¯DB.addDocument(newCustomer, (error, result) =&gt; &#123; if (error) throw new Error(&quot;Great error explanation comes here&quot;, other useful parameters)&#125;); //APIè·¯ç”±ä»£ç , æˆ‘ä»¬åŒæ—¶æ•è·å¼‚æ­¥å’ŒåŒæ­¥é”™è¯¯ï¼Œå¹¶è½¬åˆ°ä¸­é—´ä»¶try &#123; customerService.addNew(req.body).then(function (result) &#123; res.status(200).json(result); &#125;).catch((error) =&gt; &#123; next(error) &#125;);&#125;catch (error) &#123; next(error);&#125; //é”™è¯¯å¤„ç†ä¸­é—´ä»¶ï¼Œæˆ‘ä»¬å§”æ‰˜é›†ä¸­å¼é”™è¯¯å¤„ç†ç¨‹åºå¤„ç†é”™è¯¯app.use(function (err, req, res, next) &#123; errorHandler.handleError(err).then((isOperationalError) =&gt; &#123; if (!isOperationalError) next(err); &#125;);&#125;); ### ä»£ç ç¤ºä¾‹ â€“ åœ¨ä¸€ä¸ªä¸“é—¨çš„å¯¹è±¡é‡Œé¢å¤„ç†é”™è¯¯123456module.exports.handler = new errorHandler(); function errorHandler()&#123; this.handleError = function (error) &#123; return logger.logError(err).then(sendMailToAdminIfCritical).then(saveInOpsQueueIfCritical).then(determineIfOperationalError); &#125; 2.5 å¯¹APIé”™è¯¯ä½¿ç”¨Swaggeræ–‡æ¡£åŒ–å®šä¹‰: è®©ä½ çš„APIè°ƒç”¨è€…çŸ¥é“å“ªç§é”™è¯¯ä¼šè¿”å›ï¼Œè¿™æ ·ä»–ä»¬å°±èƒ½å®Œå…¨çš„å¤„ç†è¿™äº›é”™è¯¯ï¼Œè€Œä¸è‡³äºç³»ç»Ÿå´©æºƒã€‚Swaggerï¼ŒREST APIçš„æ–‡æ¡£æ¡†æ¶ï¼Œé€šå¸¸å¤„ç†è¿™ç±»é—®é¢˜ã€‚ å¦åˆ™: ä»»ä½•APIçš„å®¢æˆ·ç«¯å¯èƒ½å†³å®šå´©æºƒå¹¶é‡å¯ï¼Œä»…ä»…å› ä¸ºå®ƒæ”¶åˆ°ä¸€ä¸ªä¸èƒ½å¤„ç†çš„é”™è¯¯ã€‚æ³¨æ„ï¼šAPIçš„è°ƒç”¨è€…å¯èƒ½æ˜¯ä½ ï¼ˆåœ¨å¾®æœåŠ¡ç¯å¢ƒä¸­éå¸¸å…¸å‹ï¼‰ã€‚ 2.6 å½“ä¸€ä¸ªç‰¹æ®Šçš„æƒ…å†µäº§ç”Ÿï¼Œåœæ‰æœåŠ¡æ˜¯å¾—ä½“çš„å®šä¹‰: å½“ä¸€ä¸ªä¸ç¡®å®šé”™è¯¯äº§ç”Ÿï¼ˆä¸€ä¸ªå¼€å‘é”™è¯¯ï¼Œæœ€ä½³å®è·µæ¡æ¬¾#3) - è¿™å°±æ„å‘³ç€å¯¹åº”ç”¨è¿è½¬å¥å…¨çš„ä¸ç¡®å®šã€‚ä¸€ä¸ªæ™®é€šçš„å®è·µå°†æ˜¯å»ºè®®ä»”ç»†åœ°é‡å¯è¿›ç¨‹ï¼Œå¹¶ä½¿ç”¨ä¸€äº›â€˜å¯åŠ¨å™¨â€™å·¥å…·ï¼Œæ¯”å¦‚Foreverå’ŒPM2ã€‚ å¦åˆ™: å½“ä¸€ä¸ªæœªçŸ¥çš„å¼‚å¸¸è¢«æŠ›å‡ºï¼Œæ„å‘³ç€æŸäº›å¯¹è±¡åŒ…å«é”™è¯¯çš„çŠ¶æ€ï¼ˆä¾‹å¦‚æŸä¸ªå…¨å±€äº‹ä»¶å‘ç”Ÿå™¨ç”±äºæŸäº›å†…åœ¨çš„é”™è¯¯ï¼Œä¸åœ¨äº§ç”Ÿäº‹ä»¶ï¼‰ï¼Œæœªæ¥çš„è¯·æ±‚å¯èƒ½å¤±è´¥æˆ–è€…è¡Œä¸ºå¼‚å¸¸ã€‚ ä»£ç å®ä¾‹: å†³å®šæ˜¯å¦é€€å‡º1234567891011121314151617181920//æ”¶åˆ°æœªæ•è·çš„å¼‚å¸¸æ—¶ï¼Œå†³å®šæ˜¯å¦è¦å´©æºƒ//å¦‚æœå¼€å‘äººå‘˜æ ‡è®°å·²çŸ¥çš„æ“ä½œå‹é”™è¯¯ä½¿ç”¨ï¼šerror.isOperational=trueprocess.on(&apos;uncaughtException&apos;, function(error) &#123; errorManagement.handler.handleError(error); if(!errorManagement.handler.isTrustedError(error)) process.exit(1)&#125;); //å°è£…é”™è¯¯å¤„ç†ç›¸å…³é€»è¾‘åœ¨é›†ä¸­çš„é”™è¯¯å¤„ç†ä¸­function errorHandler()&#123; this.handleError = function (error) &#123; return logger.logError(err).then(sendMailToAdminIfCritical).then(saveInOpsQueueIfCritical).then(determineIfOperationalError); &#125; this.isTrustedError = function(error) &#123; return error.isOperational; &#125; 2.7 ä½¿ç”¨ä¸€ä¸ªæˆç†Ÿçš„æ—¥å¿—å·¥å…·æé«˜é”™è¯¯çš„å¯è§æ€§å®šä¹‰: ä¸€ç³»åˆ—æˆç†Ÿçš„æ—¥å¿—å·¥å…·ï¼Œæ¯”å¦‚Winstonï¼ŒBunyanå’ŒLog4Jï¼Œä¼šåŠ é€Ÿé”™è¯¯çš„å‘ç°å’Œç†è§£ã€‚å¿˜è®°console.logå§ã€‚ å¦åˆ™: æµè§ˆconsoleçš„logï¼Œå’Œä¸é€šè¿‡æŸ¥è¯¢å·¥å…·æˆ–è€…ä¸€ä¸ªå¥½çš„æ—¥å¿—æŸ¥çœ‹å™¨ï¼Œæ‰‹åŠ¨æµè§ˆç¹ççš„æ–‡æœ¬æ–‡ä»¶ï¼Œä¼šä½¿ä½ å¿™äºå·¥ä½œåˆ°å¾ˆæ™šã€‚ ä»£ç ç¤ºä¾‹ â€“ ä½¿ç”¨Winston Logger1234567891011//æ‚¨çš„é›†ä¸­å¼loggerå¯¹è±¡var logger = new winston.Logger(&#123; level: &apos;info&apos;, transports: [ new (winston.transports.Console)(), new (winston.transports.File)(&#123; filename: &apos;somefile.log&apos; &#125;) ]&#125;);//åœ¨æŸä¸ªåœ°æ–¹ä½¿ç”¨loggerçš„è‡ªå®šä¹‰ä»£ç logger.log(&apos;info&apos;, &apos;Test Log Message with some parameter %s&apos;, &apos;some parameter&apos;, &#123; anything: &apos;This is metadata&apos; &#125;); ### ä»£ç ç¤ºä¾‹ â€“ æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶å¤¹ (æœç´¢æ¡ç›®)1234567891011121314var options = &#123; from: new Date - 24 * 60 * 60 * 1000, until: new Date, limit: 10, start: 0, order: &apos;desc&apos;, fields: [&apos;message&apos;] &#125;; // æŸ¥æ‰¾åœ¨ä»Šå¤©å’Œæ˜¨å¤©ä¹‹é—´è®°å½•çš„é¡¹ç›® winston.query(options, function (err, results) &#123; //å¯¹äºç»“æœçš„å›è°ƒå¤„ç† &#125;); 2.8 ä½¿ç”¨ä½ æœ€å–œæ¬¢çš„æµ‹è¯•æ¡†æ¶æµ‹è¯•é”™è¯¯æµå®šä¹‰: æ— è®ºä¸“ä¸šçš„è‡ªåŠ¨åŒ–æµ‹è¯•æˆ–è€…ç®€å•çš„æ‰‹åŠ¨å¼€å‘æµ‹è¯• - ç¡®ä¿æ‚¨çš„ä»£ç ä¸ä»…æ»¡è¶³æ­£å¸¸çš„åœºæ™¯ï¼Œè€Œä¸”å¤„ç†å¹¶ä¸”è¿”å›æ­£ç¡®çš„é”™è¯¯ã€‚æµ‹è¯•æ¡†æ¶ï¼Œæ¯”å¦‚Mocha &amp; Chaiå¯ä»¥éå¸¸å®¹æ˜“çš„å¤„ç†è¿™äº›é—®é¢˜ï¼ˆåœ¨â€Gist popupâ€ä¸­æŸ¥çœ‹ä»£ç å®ä¾‹ï¼‰ã€‚ å¦åˆ™: æ²¡æœ‰æµ‹è¯•ï¼Œä¸ç®¡è‡ªåŠ¨è¿˜æ˜¯æ‰‹åŠ¨ï¼Œæ‚¨ä¸å¯èƒ½ä¾èµ–ä»£ç å»è¿”å›æ­£ç¡®çš„é”™è¯¯ã€‚è€Œæ²¡æœ‰å¯ä»¥ç†è§£çš„é”™è¯¯ï¼Œé‚£å°†æ¯«æ— é”™è¯¯å¤„ç†å¯è¨€ã€‚ ä»£ç ç¤ºä¾‹: ä½¿ç”¨ Mocha &amp; Chai ç¡®ä¿æ­£ç¡®çš„å¼‚å¸¸è¢«æŠ›å‡º1234567describe(&quot;Facebook chat&quot;, () =&gt; &#123; it(&quot;Notifies on new chat message&quot;, () =&gt; &#123; var chatService = new chatService(); chatService.participants = getDisconnectedParticipants(); expect(chatService.sendMessage.bind(&#123;message: &quot;Hi&quot;&#125;)).to.throw(ConnectionError); &#125;);&#125;); ### ä»£ç ç¤ºä¾‹: ç¡®ä¿ API è¿”å›æ­£ç¡®çš„ HTTP é”™è¯¯ç 12345678910it(&quot;Creates new Facebook group&quot;, function (done) &#123; var invalidGroupInfo = &#123;&#125;; httpRequest(&#123;method: &apos;POST&apos;, uri: &quot;facebook.com/api/groups&quot;, resolveWithFullResponse: true, body: invalidGroupInfo, json: true &#125;).then((response) =&gt; &#123; //oh no if we reached here than no exception was thrown &#125;).catch(function (response) &#123; expect(400).to.equal(response.statusCode); done(); &#125;); &#125;); 2.9 æ•è·æœªå¤„ç†çš„promise rejectionså®šä¹‰: ä»»ä½•åœ¨promiseä¸­è¢«æŠ›å‡ºçš„å¼‚å¸¸å°†è¢«æ”¶å›å’Œé—å¼ƒï¼Œé™¤éå¼€å‘è€…æ²¡æœ‰å¿˜è®°å»æ˜ç¡®çš„å¤„ç†ã€‚å³ä½¿æ‚¨çš„ä»£ç è°ƒç”¨çš„æ˜¯process.uncaughtExceptionï¼è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥æ³¨å†Œåˆ°äº‹ä»¶process.unhandledRejectionã€‚ å¦åˆ™: æ‚¨çš„é”™è¯¯å°†è¢«å›æ”¶ï¼Œæ— è¸ªè¿¹å¯å¾ªã€‚æ²¡æœ‰ä»€ä¹ˆå¯ä»¥éœ€è¦è€ƒè™‘ã€‚ ä»£ç ç¤ºä¾‹: è¿™äº›é”™è¯¯å°†ä¸ä¼šå¾—åˆ°ä»»ä½•é”™è¯¯å¤„ç†ç¨‹åºæ•è·ï¼ˆé™¤unhandledrejectionï¼‰123456DAL.getUserById(1).then((johnSnow) =&gt;&#123; //this error will just vanish if(johnSnow.isAlive == false) throw new Error(&apos;ahhhh&apos;);&#125;); ä»£ç ç¤ºä¾‹: æ•è· unresolved å’Œ rejected çš„ promise12345678910process.on(&apos;unhandledRejection&apos;, (reason, p) =&gt; &#123; //æˆ‘åˆšåˆšæ•è·äº†ä¸€ä¸ªæœªå¤„ç†çš„promise rejection, å› ä¸ºæˆ‘ä»¬å·²ç»æœ‰äº†å¯¹äºæœªå¤„ç†é”™è¯¯çš„åå¤‡çš„å¤„ç†æœºåˆ¶ï¼ˆè§ä¸‹é¢ï¼‰, ç›´æ¥æŠ›å‡ºï¼Œè®©å®ƒæ¥å¤„ç† throw reason;&#125;);process.on(&apos;uncaughtException&apos;, (error) =&gt; &#123; //æˆ‘åˆšæ”¶åˆ°ä¸€ä¸ªä»æœªè¢«å¤„ç†çš„é”™è¯¯ï¼Œç°åœ¨å¤„ç†å®ƒï¼Œå¹¶å†³å®šæ˜¯å¦éœ€è¦é‡å¯åº”ç”¨ errorManagement.handler.handleError(error); if (!errorManagement.handler.isTrustedError(error)) process.exit(1);&#125;); 2.10 å¿«é€ŸæŸ¥é”™ï¼ŒéªŒè¯å‚æ•°ä½¿ç”¨ä¸€ä¸ªä¸“é—¨çš„åº“Fail fast, validate arguments using a dedicated libraryå®šä¹‰: è¿™åº”è¯¥æ˜¯æ‚¨çš„Expressæœ€ä½³å®è·µä¸­çš„ä¸€éƒ¨åˆ† â€“ assert APIè¾“å…¥é¿å…éš¾ä»¥ç†è§£çš„æ¼æ´ï¼Œè¿™ç±»æ¼æ´ä»¥åä¼šéå¸¸éš¾ä»¥è¿½è¸ªã€‚è€ŒéªŒè¯ä»£ç é€šå¸¸æ˜¯ä¸€ä»¶ä¹å‘³çš„äº‹æƒ…ï¼Œé™¤éä½¿ç”¨ä¸€äº›éå¸¸ç‚«é…·çš„å¸®åŠ©åº“æ¯”å¦‚Joiã€‚ å¦åˆ™: è€ƒè™‘è¿™ç§æƒ…å†µ â€“ æ‚¨çš„åŠŸèƒ½æœŸæœ›ä¸€ä¸ªæ•°å­—å‚æ•° â€œDiscountâ€ ï¼Œç„¶è€Œè°ƒç”¨è€…å¿˜è®°ä¼ å€¼ï¼Œä¹‹ååœ¨æ‚¨çš„ä»£ç ä¸­æ£€æŸ¥æ˜¯å¦ Discount!=0 ï¼ˆå…è®¸çš„æŠ˜æ‰£å€¼å¤§äºé›¶ï¼‰ï¼Œè¿™æ ·å®ƒå°†å…è®¸ç”¨æˆ·ä½¿ç”¨ä¸€ä¸ªæŠ˜æ‰£ã€‚OMGï¼Œå¤šä¹ˆä¸çˆ½çš„ä¸€ä¸ªæ¼æ´ã€‚ä½ èƒ½æ˜ç™½å—ï¼Ÿ ä»£ç ç¤ºä¾‹: ä½¿ç”¨â€˜Joiâ€™éªŒè¯å¤æ‚çš„JSONè¾“å…¥123456789101112var memberSchema = Joi.object().keys(&#123; password: Joi.string().regex(/^[a-zA-Z0-9]&#123;3,30&#125;$/), birthyear: Joi.number().integer().min(1900).max(2013), email: Joi.string().email()&#125;); function addNewMember(newMember)&#123; //assertions come first Joi.assert(newMember, memberSchema); //throws if validation fails //other logic here&#125; ### åæ¨¡å¼: æ²¡æœ‰éªŒè¯ä¼šäº§ç”Ÿä»¤äººè®¨åŒçš„é”™è¯¯123456789//å‡å¦‚æŠ˜æ‰£ä¸ºæ­£ï¼Œé‡å®šå‘ç”¨æˆ·å»æ‰“å°ä»–çš„æŠ˜æ‰£ä¼˜æƒ åŠµfunction redirectToPrintDiscount(httpResponse, member, discount)&#123; if(discount != 0) httpResponse.redirect(`/discountPrintView/$&#123;member.id&#125;`);&#125; redirectToPrintDiscount(httpResponse, someMember);//å¿˜è®°ä¼ é€’å‚æ•°discount, ä¸ºä»€ä¹ˆç”¨æˆ·è¢«é‡å®šå‘åˆ°æŠ˜æ‰£é¡µé¢ï¼Ÿ ç¼–ç è§„èŒƒå®è·µ3.1 ä½¿ç”¨ä¸€æ¬¾é£æ ¼ç®¡ç†å·¥å…·å®šä¹‰: ESLintï¼ŒStandard æ˜¯æ£€æŸ¥å¯èƒ½çš„ä»£ç é”™è¯¯å’Œä¿®å¤ä»£ç æ ·å¼çš„äº‹å®ä¸Šçš„æ ‡å‡†ï¼Œä¸ä»…å¯ä»¥è¯†åˆ«å®é™…çš„é—´è·é—®é¢˜, è€Œä¸”è¿˜å¯ä»¥æ£€æµ‹ä¸¥é‡çš„åæ¨¡å¼ä»£ç , å¦‚å¼€å‘äººå‘˜åœ¨ä¸åˆ†ç±»çš„æƒ…å†µä¸‹æŠ›å‡ºé”™è¯¯ã€‚å°½ç®¡ESlintå¯ä»¥è‡ªåŠ¨ä¿®å¤ä»£ç æ ·å¼ï¼Œä½†å…¶ä»–çš„å·¥å…·æ¯”å¦‚ prettier å’Œ beautifyåœ¨æ ¼å¼åŒ–ä¿®å¤ä¸ŠåŠŸèƒ½å¼ºå¤§ï¼Œå¯ä»¥å’ŒEslintç»“åˆèµ·æ¥ä½¿ç”¨ã€‚ å¦åˆ™: å¼€å‘äººå‘˜å°†å¿…é¡»å…³æ³¨å•è°ƒä¹å‘³çš„é—´è·å’Œçº¿å®½é—®é¢˜, å¹¶ä¸”æ—¶é—´å¯èƒ½ä¼šæµªè´¹åœ¨è¿‡å¤šè€ƒè™‘é¡¹ç›®çš„ä»£ç æ ·å¼ã€‚ 3.2 å˜é‡ã€å¸¸é‡ã€å‡½æ•°å’Œç±»çš„å‘½åçº¦å®šå®šä¹‰: å½“å‘½åå˜é‡å’Œæ–¹æ³•çš„æ—¶å€™ï¼Œä½¿ç”¨ lowerCamelCase ï¼Œå½“å‘½åç±»çš„æ—¶å€™ï¼Œä½¿ç”¨ UpperCamelCase ï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ï¼Œå¯¹äºå¸¸é‡ï¼Œåˆ™ UPPERCASE ã€‚è¿™å°†å¸®åŠ©æ‚¨è½»æ¾åœ°åŒºåˆ†æ™®é€šå˜é‡/å‡½æ•°å’Œéœ€è¦å®ä¾‹åŒ–çš„ç±»ã€‚ä½¿ç”¨æè¿°æ€§åç§°ï¼Œä½†ä½¿å®ƒä»¬å°½é‡ç®€çŸ­ã€‚ å¦åˆ™: JavaScriptæ˜¯ä¸–ç•Œä¸Šå”¯ä¸€ä¸€é—¨ä¸éœ€è¦å®ä¾‹åŒ–ï¼Œå°±å¯ä»¥ç›´æ¥è°ƒç”¨æ„é€ å‡½æ•°ï¼ˆâ€Classâ€ï¼‰çš„ç¼–ç è¯­è¨€ã€‚å› æ­¤ï¼Œç±»å’Œå‡½æ•°çš„æ„é€ å‡½æ•°ç”±é‡‡ç”¨UpperCamelCaseå¼€å§‹åŒºåˆ†ã€‚ ä»£ç ç¤ºä¾‹1234567891011121314// ä½¿ç”¨UpperCamelCaseå‘½åç±»åclass SomeClassExample () &#123; // å¸¸é‡ä½¿ç”¨constå…³é”®å­—ï¼Œå¹¶ä½¿ç”¨lowerCamelCaseå‘½å const config = &#123; key: &apos;value&apos; &#125;; // å˜é‡å’Œæ–¹æ³•ä½¿ç”¨lowerCamelCaseå‘½å let someVariableExample = &apos;value&apos;; function doSomething() &#123; &#125;&#125; 3.3 å…ˆ require, è€Œä¸æ˜¯åœ¨æ–¹æ³•å†…éƒ¨å®šä¹‰: åœ¨æ¯ä¸ªæ–‡ä»¶çš„èµ·å§‹ä½ç½®ï¼Œåœ¨ä»»ä½•å‡½æ•°çš„å‰é¢å’Œå¤–éƒ¨requireæ¨¡å—ã€‚è¿™ç§ç®€å•çš„æœ€ä½³å®è·µï¼Œä¸ä»…èƒ½å¸®åŠ©æ‚¨è½»æ¾å¿«é€Ÿåœ°åœ¨æ–‡ä»¶é¡¶éƒ¨è¾¨åˆ«å‡ºä¾èµ–å…³ç³»ï¼Œè€Œä¸”é¿å…äº†ä¸€äº›æ½œåœ¨çš„é—®é¢˜ã€‚ å¦åˆ™: åœ¨Node.jsä¸­ï¼Œrequire æ˜¯åŒæ­¥è¿è¡Œçš„ã€‚å¦‚æœä»å‡½æ•°ä¸­è°ƒç”¨å®ƒä»¬ï¼Œå®ƒå¯èƒ½ä¼šé˜»å¡å…¶ä»–è¯·æ±‚ï¼Œåœ¨æ›´å…³é”®çš„æ—¶é—´å¾—åˆ°å¤„ç†ã€‚å¦å¤–ï¼Œå¦‚æœæ‰€requireçš„æ¨¡å—æˆ–å®ƒè‡ªå·±çš„ä»»ä½•ä¾èµ–é¡¹æŠ›å‡ºé”™è¯¯å¹¶ä½¿æœåŠ¡å™¨å´©æºƒï¼Œæœ€å¥½å°½å¿«æŸ¥æ˜å®ƒï¼Œå¦‚æœè¯¥æ¨¡å—åœ¨å‡½æ•°ä¸­requireçš„ï¼Œåˆ™å¯èƒ½ä¸æ˜¯è¿™æ ·çš„æƒ…å†µã€‚ é”™è¯¯ä»£ç ç¤ºä¾‹12345function myClassFunction () &#123; const _ = require(&apos;lodash&apos;) return _.merge(&#123;name: &apos;class&apos;&#125;)&#125; æ­£ç¡®ä»£ç ç¤ºä¾‹12345const _ = require(&apos;lodash&apos;)function myClassFunction () &#123; return _.merge(&#123;name: &apos;class&apos;&#125;)&#125; ## 3.4 åœ¨æ–‡ä»¶å¤¹ä¸Š require ï¼Œè€Œä¸æ˜¯ç›´æ¥åœ¨æ–‡ä»¶ä¸Šå®šä¹‰: å½“åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­å¼€å‘åº“/æ¨¡å—ï¼Œæ”¾ç½®ä¸€ä¸ªæ–‡ä»¶index.jsæš´éœ²æ¨¡å—çš„ å†…éƒ¨ï¼Œè¿™æ ·æ¯ä¸ªæ¶ˆè´¹è€…éƒ½ä¼šé€šè¿‡å®ƒã€‚è¿™å°†ä½œä¸ºæ‚¨æ¨¡å—çš„ä¸€ä¸ªæ¥å£ï¼Œå¹¶ä½¿æœªæ¥çš„å˜åŒ–ç®€å•è€Œä¸è¿åè§„åˆ™ã€‚ å¦åˆ™: æ›´æ”¹æ–‡ä»¶å†…éƒ¨ç»“æ„æˆ–ç­¾åå¯èƒ½ä¼šç ´åä¸å®¢æˆ·ç«¯çš„æ¥å£ã€‚ ä»£ç ç¤ºä¾‹1234567// å»ºè®®module.exports.SMSProvider = require(&apos;./SMSProvider&apos;);module.exports.SMSNumberResolver = require(&apos;./SMSNumberResolver&apos;);// é¿å…module.exports.SMSProvider = require(&apos;./SMSProvider/SMSProvider.js&apos;);module.exports.SMSNumberResolver = require(&apos;./SMSNumberResolver/SMSNumberResolver.js&apos;); æµ‹è¯•å’Œæ€»ä½“è´¨é‡å®è·µ4.1 è‡³å°‘ï¼Œç¼–å†™APIï¼ˆç»„ä»¶ï¼‰æµ‹è¯•å®šä¹‰: å¤§å¤šæ•°é¡¹ç›®åªæ˜¯å› ä¸ºæ—¶é—´è¡¨å¤ªçŸ­è€Œæ²¡æœ‰è¿›è¡Œä»»ä½•è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œæˆ–è€…æµ‹è¯•é¡¹ç›®å¤±æ§è€Œæ­£è¢«é—å¼ƒã€‚å› æ­¤ï¼Œä¼˜å…ˆä»APIæµ‹è¯•å¼€å§‹ï¼Œè¿™æ˜¯æœ€ç®€å•çš„ç¼–å†™å’Œæä¾›æ¯”å•å…ƒæµ‹è¯•æ›´å¤šè¦†ç›–ç‡çš„äº‹æƒ…ï¼ˆä½ ç”šè‡³å¯èƒ½ä¸éœ€è¦ç¼–ç è€Œè¿›è¡ŒAPIæµ‹è¯•ï¼ŒåƒPostmanã€‚ä¹‹åï¼Œå¦‚æœæ‚¨æœ‰æ›´å¤šçš„èµ„æºå’Œæ—¶é—´ï¼Œç»§ç»­ä½¿ç”¨é«˜çº§æµ‹è¯•ç±»å‹ï¼Œå¦‚å•å…ƒæµ‹è¯•ã€DBæµ‹è¯•ã€æ€§èƒ½æµ‹è¯•ç­‰ã€‚ å¦åˆ™: æ‚¨å¯èƒ½éœ€è¦èŠ±å¾ˆé•¿æ—¶é—´ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œæ‰å‘ç°åªæœ‰20%çš„ç³»ç»Ÿè¦†ç›–ç‡ã€‚ 4.2 ä½¿ç”¨ä¸€ä¸ªlinteræ£€æµ‹ä»£ç é—®é¢˜å®šä¹‰: ä½¿ç”¨ä»£ç linteræ£€æŸ¥åŸºæœ¬è´¨é‡å¹¶åŠæ—©æ£€æµ‹åæ¨¡å¼ã€‚åœ¨ä»»ä½•æµ‹è¯•ä¹‹å‰è¿è¡Œå®ƒ, å¹¶å°†å…¶æ·»åŠ ä¸ºé¢„æäº¤çš„gité’©å­, ä»¥æœ€å°åŒ–å®¡æŸ¥å’Œæ›´æ­£ä»»ä½•é—®é¢˜æ‰€éœ€çš„æ—¶é—´ã€‚ä¹Ÿå¯åœ¨Section 3ä¸­æŸ¥é˜…ç¼–ç æ ·å¼å®è·µ å¦åˆ™: æ‚¨å¯èƒ½è®©ä¸€äº›åæ¨¡å¼å’Œæ˜“å—æ”»å‡»çš„ä»£ç ä¼ é€’åˆ°æ‚¨çš„ç”Ÿäº§ç¯å¢ƒä¸­ã€‚ ä»£ç ç¤ºä¾‹ï¼ˆhuskyï¼‰ 123456&#123; &quot;husky&quot;: &#123; &quot;hooks&quot;: &#123; &quot;pre-commit&quot;: &quot;standard &amp;&amp; yarn test&quot; &#125; &#125; 4.3 ç»å¸¸æ£€æŸ¥æ˜“å—æ”»å‡»çš„ä¾èµ–å®šä¹‰: å³ä½¿æ˜¯é‚£äº›æœ€æœ‰åçš„ä¾èµ–æ¨¡å—ï¼Œæ¯”å¦‚Expressï¼Œä¹Ÿæœ‰å·²çŸ¥çš„æ¼æ´ã€‚ä½¿ç”¨ç¤¾åŒºå’Œå•†ä¸šå·¥å…·ï¼Œæ¯”å¦‚ ğŸ”— nsp ï¼Œé›†æˆåœ¨æ‚¨çš„CIå¹³å°ä¸Šï¼Œåœ¨æ¯ä¸€æ¬¡æ„å»ºçš„æ—¶å€™éƒ½ä¼šè¢«è°ƒç”¨ï¼Œè¿™æ ·å¯ä»¥å¾ˆå®¹æ˜“åœ°è§£å†³æ¼æ´é—®é¢˜ã€‚ å¦åˆ™: åœ¨æ²¡æœ‰ä¸“ç”¨å·¥å…·çš„æƒ…å†µä¸‹ï¼Œä½¿ä»£ç æ¸…é™¤æ¼æ´ï¼Œéœ€è¦ä¸æ–­åœ°è·Ÿè¸ªæœ‰å…³æ–°å¨èƒçš„åœ¨çº¿å‡ºç‰ˆç‰©ï¼Œç›¸å½“ç¹çã€‚ 4.4 æ£€æŸ¥è¿‡æœŸçš„ä¾èµ–åŒ…å®šä¹‰: ä½¿ç”¨æ‚¨çš„é¦–é€‰å·¥å…· (ä¾‹å¦‚ â€œnpm outdatedâ€ or npm-check-updates æ¥æ£€æµ‹å·²å®‰è£…çš„è¿‡æœŸä¾èµ–åŒ…, å°†æ­¤æ£€æŸ¥æ³¨å…¥æ‚¨çš„ CI ç®¡é“, ç”šè‡³åœ¨ä¸¥é‡çš„æƒ…å†µä¸‹ä½¿æ„å»ºå¤±è´¥ã€‚ä¾‹å¦‚, å½“ä¸€ä¸ªå·²å®‰è£…çš„ä¾èµ–åŒ…æ»å5ä¸ªè¡¥ä¸æ—¶ (ä¾‹å¦‚:æœ¬åœ°ç‰ˆæœ¬æ˜¯1.3.1 çš„, å­˜å‚¨åº“ç‰ˆæœ¬æ˜¯1.3.8 çš„), æˆ–è€…å®ƒè¢«å…¶ä½œè€…æ ‡è®°ä¸ºå·²å¼ƒç”¨, å¯èƒ½ä¼šå‡ºç°ä¸¥é‡çš„æƒ…å†µ - åœæ‰è¿™æ¬¡æ„å»ºå¹¶é˜²æ­¢éƒ¨ç½²æ­¤ç‰ˆæœ¬ã€‚ å¦åˆ™: æ‚¨çš„ç”Ÿäº§ç¯å¢ƒå°†è¿è¡Œå·²è¢«å…¶ä½œè€…æ˜ç¡®æ ‡è®°ä¸ºæœ‰é£é™©çš„ä¾èµ–åŒ… è¿›å…¥ç”Ÿäº§å®è·µ5.1. ç›‘æ§!å®šä¹‰: ç›‘æ§æ˜¯ä¸€ç§åœ¨é¡¾å®¢ä¹‹å‰å‘ç°é—®é¢˜çš„æ¸¸æˆ â€“ æ˜¾ç„¶è¿™åº”è¯¥è¢«èµ‹äºˆå‰æ‰€æœªæœ‰çš„é‡è¦æ€§ã€‚è€ƒè™‘ä»å®šä¹‰ä½ å¿…é¡»éµå¾ªçš„åŸºæœ¬åº¦é‡æ ‡å‡†å¼€å§‹ï¼ˆæˆ‘çš„å»ºè®®åœ¨é‡Œé¢ï¼‰ï¼Œåˆ°æ£€æŸ¥é™„åŠ çš„èŠ±å“¨ç‰¹æ€§å¹¶é€‰æ‹©è§£å†³æ‰€æœ‰é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚å¸‚åœºå·²ç»æ·¹æ²¡å…¶ä¸­ã€‚ç‚¹å‡»ä¸‹é¢çš„ â€˜The Gistâ€™ ï¼Œäº†è§£è§£å†³æ–¹æ¡ˆçš„æ¦‚è¿°ã€‚ å¦åˆ™: é”™è¯¯ === å¤±æœ›çš„å®¢æˆ·. éå¸¸ç®€å•. ç›‘æ§ç¤ºä¾‹ï¼šStackDriveré»˜è®¤ä»ªè¡¨æ¿ã€‚å¾ˆéš¾æå–åº”ç”¨å†…æŒ‡æ ‡null ### ç›‘æ§ç¤ºä¾‹ï¼šGrafanaä½œä¸ºå¯è§†åŒ–åŸå§‹æ•°æ®çš„UIå±‚null 5.2. ä½¿ç”¨æ™ºèƒ½æ—¥å¿—å¢åŠ é€æ˜åº¦å®šä¹‰: æ—¥å¿—å¯ä»¥æ˜¯è°ƒè¯•è¯­å¥çš„ä¸€ä¸ªä¸èƒ½è¯´è¯çš„ä»“åº“ï¼Œæˆ–è€…è¡¨è¿°åº”ç”¨è¿è¡Œè¿‡ç¨‹çš„ä¸€ä¸ªæ¼‚äº®ä»ªè¡¨æ¿çš„é©±åŠ¨ã€‚ä»ç¬¬1å¤©è®¡åˆ’æ‚¨çš„æ—¥å¿—å¹³å°ï¼šå¦‚ä½•æ”¶é›†ã€å­˜å‚¨å’Œåˆ†ææ—¥å¿—ï¼Œä»¥ç¡®ä¿æ‰€éœ€ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œé”™è¯¯ç‡ã€é€šè¿‡æœåŠ¡å’ŒæœåŠ¡å™¨ç­‰å®Œæˆæ•´ä¸ªäº‹åŠ¡ï¼‰éƒ½èƒ½è¢«æå–å‡ºæ¥ã€‚ å¦åˆ™: æ‚¨æœ€ç»ˆåƒæ˜¯é¢å¯¹ä¸€ä¸ªé»‘ç›’ï¼Œä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆäº‹æƒ…ï¼Œç„¶åä½ å¼€å§‹é‡æ–°å†™æ—¥å¿—è¯­å¥æ·»åŠ é¢å¤–çš„ä¿¡æ¯ã€‚ ä¸€æ®µè§£é‡Šæ— è®ºå¦‚ä½•ï¼Œæ‚¨è¦æ‰“å°æ—¥å¿—ï¼Œæ˜¾ç„¶éœ€è¦ä¸€äº›å¯ä»¥åœ¨å…¶ä¸­è·Ÿè¸ªé”™è¯¯å’Œæ ¸å¿ƒæŒ‡æ ‡çš„æ¥å£æ¥åŒ…è£…ç”Ÿäº§ç¯å¢ƒä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œæ¯å°æ—¶å‘ç”Ÿäº†å¤šå°‘é”™è¯¯ï¼Œæœ€æ…¢çš„APIèŠ‚ç‚¹æ˜¯å“ªä¸€ä¸ªï¼‰ä¸ºä»€ä¹ˆä¸åœ¨å¥å£®çš„æ—¥å¿—æ¡†æ¶ä¸­è¿›è¡Œä¸€äº›é€‚åº¦çš„å°è¯•å‘¢? è¦å®ç°è¿™ä¸€ç›®æ ‡ï¼Œéœ€è¦åœ¨ä¸‰ä¸ªæ­¥éª¤ä¸Šåšå‡ºæ·±æ€ç†Ÿè™‘çš„å†³å®š: æ™ºèƒ½æ—¥å¿— â€“ åœ¨æœ€åŸºæœ¬çš„æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦ä½¿ç”¨åƒWinston, Bunyanè¿™æ ·æœ‰ä¿¡èª‰çš„æ—¥å¿—åº“ï¼Œåœ¨æ¯ä¸ªäº‹åŠ¡å¼€å§‹å’Œç»“æŸæ—¶è¾“å‡ºæœ‰æ„ä¹‰çš„ä¿¡æ¯ã€‚è¿˜å¯ä»¥è€ƒè™‘å°†æ—¥å¿—è¯­å¥æ ¼å¼åŒ–ä¸ºJSONï¼Œå¹¶æä¾›æ‰€æœ‰ä¸Šä¸‹æ–‡å±æ€§ï¼ˆå¦‚ç”¨æˆ·idã€æ“ä½œç±»å‹ç­‰ï¼‰ã€‚è¿™æ ·è¿ç»´å›¢é˜Ÿå°±å¯ä»¥åœ¨è¿™äº›å­—æ®µä¸Šæ“ä½œã€‚åœ¨æ¯ä¸ªæ—¥å¿—è¡Œä¸­åŒ…å«ä¸€ä¸ªå”¯ä¸€çš„transaction IDï¼Œæ›´å¤šçš„ä¿¡æ¯æŸ¥é˜…æ¡æ¬¾ â€œWrite transaction-id to logâ€ã€‚æœ€åè¦è€ƒè™‘çš„ä¸€ç‚¹è¿˜åŒ…æ‹¬ä¸€ä¸ªä»£ç†ï¼Œå®ƒè®°å½•ç³»ç»Ÿèµ„æºï¼Œå¦‚å†…å­˜å’ŒCPUï¼Œæ¯”å¦‚Elastic Beatã€‚ æ™ºèƒ½èšåˆ â€“ ä¸€æ—¦æ‚¨åœ¨æœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸­æœ‰äº†å…¨é¢çš„ä¿¡æ¯ï¼Œå°±åº”è¯¥å®šæœŸå°†è¿™äº›ä¿¡æ¯æ¨é€åˆ°ä¸€ä¸ªå¯ä»¥èšåˆã€å¤„ç†å’Œå¯è§†åŒ–æ•°æ®çš„ç³»ç»Ÿä¸­ã€‚ä¾‹å¦‚ï¼ŒElastic stackæ˜¯ä¸€ç§æµè¡Œçš„ã€è‡ªç”±çš„é€‰æ‹©ï¼Œå®ƒæä¾›æ‰€æœ‰ç»„ä»¶å»èšåˆå’Œäº§ç”Ÿå¯è§†åŒ–æ•°æ®ã€‚è®¸å¤šå•†ä¸šäº§å“æä¾›äº†ç±»ä¼¼çš„åŠŸèƒ½ï¼Œåªæ˜¯å®ƒä»¬å¤§å¤§å‡å°‘äº†å®‰è£…æ—¶é—´ï¼Œä¸éœ€è¦ä¸»æœºæ‰˜ç®¡ã€‚ æ™ºèƒ½å¯è§†åŒ– â€“ ç°åœ¨çš„ä¿¡æ¯æ˜¯èšåˆå’Œå¯æœç´¢çš„, ä¸€ä¸ªå¯ä»¥æ»¡è¶³ä»…ä»…æ–¹ä¾¿åœ°æœç´¢æ—¥å¿—çš„èƒ½åŠ›, å¯ä»¥èµ°å¾—æ›´è¿œ, æ²¡æœ‰ç¼–ç æˆ–èŠ±è´¹å¤ªå¤šçš„åŠªåŠ›ã€‚æˆ‘ä»¬ç°åœ¨å¯ä»¥æ˜¾ç¤ºä¸€äº›é‡è¦çš„æ“ä½œæŒ‡æ ‡, å¦‚é”™è¯¯ç‡ã€å¹³å‡ä¸€å¤©CPUä½¿ç”¨, åœ¨è¿‡å»ä¸€å°æ—¶å†…æœ‰å¤šå°‘æ–°ç”¨æˆ·é€‰æ‹©, ä»¥åŠä»»ä½•å…¶ä»–æœ‰åŠ©äºç®¡ç†å’Œæ”¹è¿›æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„æŒ‡æ ‡ã€‚ å¯è§†åŒ–ç¤ºä¾‹: Kibana(Elastic stackçš„ä¸€éƒ¨åˆ†)ä¿ƒè¿›äº†å¯¹æ—¥å¿—å†…å®¹çš„é«˜çº§æœç´¢null### å¯è§†åŒ–ç¤ºä¾‹: Kibana(Elastic stackçš„ä¸€éƒ¨åˆ†)åŸºäºæ—¥å¿—æ¥å¯è§†åŒ–æ•°æ®null 5.3 é”ä½ä¾èµ–å®šä¹‰: æ‚¨çš„ä»£ç å¿…é¡»åœ¨æ‰€æœ‰çš„ç¯å¢ƒä¸­æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯ä»¤äººæƒŠè®¶çš„æ˜¯ï¼ŒNPMé»˜è®¤æƒ…å†µä¸‹ä¼šè®©ä¾èµ–åœ¨ä¸åŒç¯å¢ƒä¸‹å‘ç”Ÿåç§» â€“ å½“åœ¨ä¸åŒçš„ç¯å¢ƒä¸­å®‰è£…åŒ…çš„æ—¶å€™ï¼Œå®ƒè¯•å›¾æ‹¿åŒ…çš„æœ€æ–°ç‰ˆæœ¬ã€‚å…‹æœè¿™ç§é—®é¢˜å¯ä»¥åˆ©ç”¨NPMé…ç½®æ–‡ä»¶ï¼Œ .npmrcï¼Œå‘Šè¯‰æ¯ä¸ªç¯å¢ƒä¿å­˜å‡†ç¡®çš„ï¼ˆä¸æ˜¯æœ€æ–°çš„ï¼‰åŒ…çš„ç‰ˆæœ¬ã€‚å¦å¤–ï¼Œå¯¹äºæ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œä½¿ç”¨NPM â€œshrinkwrapâ€ã€‚*æ›´æ–°ï¼šä½œä¸ºNPM5ï¼Œä¾èµ–é»˜è®¤é”å®šã€‚æ–°çš„åŒ…ç®¡ç†å·¥å…·ï¼ŒYarnï¼Œä¹Ÿé»˜è®¤é”å®šã€‚ å¦åˆ™: QAæµ‹è¯•é€šè¿‡çš„ä»£ç å’Œæ‰¹å‡†çš„ç‰ˆæœ¬ï¼Œåœ¨ç”Ÿäº§ä¸­è¡¨ç°ä¸ä¸€è‡´ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼ŒåŒä¸€ç”Ÿäº§é›†ç¾¤ä¸­çš„ä¸åŒæœåŠ¡å™¨å¯èƒ½è¿è¡Œä¸åŒçš„ä»£ç ã€‚ ä¸€æ®µè§£é‡Šæ‚¨çš„ä»£ç ä¾èµ–äºè®¸å¤šå¤–éƒ¨åŒ…ï¼Œå‡è®¾å®ƒâ€œéœ€è¦â€å’Œä½¿ç”¨momentjs-2.1.4ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå½“å¸ƒç½²åˆ°ç”Ÿäº§ä¸­æ—¶ï¼Œnpmå¯èƒ½ä¼šè·å¾—momentjs 2.1.5ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œè¿™å°†å¸¦æ¥ä¸€äº›æ–°çš„bugã€‚ä½¿ç”¨npmé…ç½®æ–‡ä»¶å’Œè®¾ç½® â€“save-exact=true æŒ‡ç¤ºnpmå»å®Œæˆå®‰è£…ï¼Œä»¥ä¾¿ä¸‹æ¬¡è¿è¡Œ npm installï¼ˆåœ¨ç”Ÿäº§æˆ–åœ¨Dockerå®¹å™¨ä¸­ï¼Œæ‚¨è®¡åˆ’å°†å…¶ç”¨äºæµ‹è¯•ï¼‰æ—¶ï¼Œå°†è·å–ç›¸åŒçš„ä¾èµ–ç‰ˆæœ¬ã€‚å¦ä¸€ç§å¯é€‰æ‹©å—æ¬¢è¿çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªshrinkwrapæ–‡ä»¶ï¼ˆå¾ˆå®¹æ˜“ä½¿ç”¨npmç”Ÿæˆï¼‰æŒ‡å‡ºåº”è¯¥å®‰è£…å“ªäº›åŒ…å’Œç‰ˆæœ¬ï¼Œè¿™æ ·å°±ä¸éœ€è¦ç¯å¢ƒæ¥è·å–æ–°ç‰ˆæœ¬äº†ã€‚ æ›´æ–°: åœ¨npm5ä¸­ï¼Œä½¿ç”¨.shrinkwrapä¾èµ–é¡¹ä¼šè¢«è‡ªåŠ¨é”å®šã€‚Yarnï¼Œä¸€ä¸ªæ–°å…´çš„åŒ…ç®¡ç†å™¨ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¹Ÿä¼šé”å®šä¾èµ–é¡¹ã€‚ä»£ç ç¤ºä¾‹: .npmrcæ–‡ä»¶æŒ‡ç¤ºnpmä½¿ç”¨ç²¾ç¡®çš„ç‰ˆæœ¬12// åœ¨é¡¹ç›®ç›®å½•ä¸Šä¿å­˜è¿™ä¸ªä¸º.npmrc æ–‡ä»¶save-exact:true ### ä»£ç ç¤ºä¾‹: shirnkwrap.jsonæ–‡ä»¶è·å–å‡†ç¡®çš„ä¾èµ–å…³ç³»æ ‘12345678910111213&#123; &quot;name&quot;: &quot;A&quot;, &quot;dependencies&quot;: &#123; &quot;B&quot;: &#123; &quot;version&quot;: &quot;0.0.1&quot;, &quot;dependencies&quot;: &#123; &quot;C&quot;: &#123; &quot;version&quot;: &quot;0.1.0&quot; &#125; &#125; &#125; &#125;&#125; ### ä»£ç ç¤ºä¾‹: npm5ä¾èµ–é”æ–‡ä»¶ - package.json123456789101112131415161718192021222324&#123; &quot;name&quot;: &quot;package-name&quot;, &quot;version&quot;: &quot;1.0.0&quot;, &quot;lockfileVersion&quot;: 1, &quot;dependencies&quot;: &#123; &quot;cacache&quot;: &#123; &quot;version&quot;: &quot;9.2.6&quot;, &quot;resolved&quot;: &quot;https://registry.npmjs.org/cacache/-/cacache-9.2.6.tgz&quot;, &quot;integrity&quot;: &quot;sha512-YK0Z5Np5t755edPL6gfdCeGxtU0rcW/DBhYhYVDckT+7AFkCCtedf2zru5NRbBLFk6e7Agi/RaqTOAfiaipUfg==&quot; &#125;, &quot;duplexify&quot;: &#123; &quot;version&quot;: &quot;3.5.0&quot;, &quot;resolved&quot;: &quot;https://registry.npmjs.org/duplexify/-/duplexify-3.5.0.tgz&quot;, &quot;integrity&quot;: &quot;sha1-GqdzAC4VeEV+nZ1KULDMquvL1gQ=&quot;, &quot;dependencies&quot;: &#123; &quot;end-of-stream&quot;: &#123; &quot;version&quot;: &quot;1.0.0&quot;, &quot;resolved&quot;: &quot;https://registry.npmjs.org/end-of-stream/-/end-of-stream-1.0.0.tgz&quot;, &quot;integrity&quot;: &quot;sha1-1FlucCc0qT5A6a+GQxnqvZn/Lw4=&quot; &#125; &#125; &#125; &#125;&#125; #","categories":[{"name":"æ€»ç»“","slug":"æ€»ç»“","permalink":"https://sensitivemix.github.io/categories/æ€»ç»“/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"https://sensitivemix.github.io/tags/Node-js/"},{"name":"BestPractice","slug":"BestPractice","permalink":"https://sensitivemix.github.io/tags/BestPractice/"}]},{"title":"MongoDB Aggregation ä¸šåŠ¡åœºæ™¯å®æˆ˜","slug":"MongoDB-Aggregation-ä¸šåŠ¡åœºæ™¯å®æˆ˜","date":"2018-08-13T07:12:35.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/08/13/MongoDB-Aggregation-ä¸šåŠ¡åœºæ™¯å®æˆ˜/","link":"","permalink":"https://sensitivemix.github.io/2018/08/13/MongoDB-Aggregation-ä¸šåŠ¡åœºæ™¯å®æˆ˜/","excerpt":"","text":"å¯¹äºæŠ€æœ¯äººå‘˜æ¥è¯´ï¼Œâ€œç®¡é“â€ ç›¸ä¿¡å¤§å®¶éƒ½ä¸ä¼šæ„Ÿåˆ°é™Œç”Ÿï¼Œåœ¨å¾ˆå¤šæŠ€æœ¯é¢†åŸŸéƒ½æœ‰ç®¡é“çš„æ¦‚å¿µï¼Œä¾‹å¦‚Linux ç®¡é“ï¼ŒCI/CD ç®¡é“ã€‚åŒæ ·çš„ï¼ŒMongoDB 2.2 ç‰ˆæœ¬ä¹Ÿæ–°å¢äº†èšåˆç®¡é“åŠŸèƒ½ï¼Œè™½ç„¶åŠŸèƒ½å‘å¸ƒå·²ä¹…ï¼Œä½†æ˜¯ç¤¾åŒºçš„å¤æ‚åœºæ™¯çš„å®è·µå¹¶ä¸å¤šï¼Œç»™å¤§å®¶é€ æˆäº†èšåˆç®¡é“â€œä¸å¥½ç”¨â€çš„é”™è§‰ ã€‚å®é™…åœ¨ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œé€‚å½“çš„è¿ç”¨èšåˆå¾€å¾€ä¼šå¸¦æ¥äº‹åŠåŠŸå€çš„æ•ˆæœã€‚ å®šä¹‰è¦æƒ³äº†è§£èšåˆç®¡é“åœ¨ä¸šåŠ¡åœºæ™¯ä¸­çš„ä½¿ç”¨ï¼Œé¦–å…ˆéœ€è¦äº†è§£èšåˆç®¡é“çš„å®šä¹‰ï¼š èšåˆç®¡é“ç”¨äºæ•°æ®å¤„ç†ï¼Œæ¯ä¸ªæ–‡æ¡£é€šè¿‡ä¸€ä¸ªæˆ–è€…æ˜¯å¤šä¸ªé˜¶æ®µç»„æˆï¼Œå¯ä»¥å¯¹æ¯ä¸ªåˆ†ç»„è¿›è¡Œåˆ†ç»„å’Œè¿‡æ»¤ç­‰åŠŸèƒ½ï¼Œç„¶åç»è¿‡ä¸€ç³»åˆ—å¤„ç†ï¼Œè¾“å‡ºç›¸åº”çš„ç»“æœã€‚ é€šè¿‡è¿™å¼ å›¾ï¼Œå¯ä»¥æ¸…æ™°çš„äº†è§£åˆ°èšåˆç®¡é“çš„å¤„ç†è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„ç®¡é“æ“ä½œç¬¦ä¸€èˆ¬æœ‰ä»¥ä¸‹è¿™äº›ï¼š $match ä¸»è¦ç”¨äºå¯¹æ–‡æ¡£é›†åˆçš„ç­›é€‰ $project ä¸»è¦ç”¨äºä»å­æ–‡æ¡£ä¸­æå–å­—æ®µï¼Œå¯ä»¥é‡å‘½åå­—æ®µï¼Œä¹Ÿå¯ä»¥ç§»é™¤å­—æ®µ $group ä¸»è¦ç”¨äºæ ¹æ®æ–‡æ¡£çš„ç‰¹å®šå­—æ®µè¿›è¡Œåˆ†ç»„ $unwind ä¸»è¦ç”¨äºåˆ†å‰²æ•°ç»„åµŒå…¥åˆ°è‡ªå·±çš„é¡¶å±‚æ–‡ä»¶ $lookup ä¸»è¦ç”¨äºä¸¤ä¸ªé›†åˆä¹‹é—´çš„å·¦è¿æ¥æ“ä½œ $skip æ¥å—ä¸€ä¸ªæ•°å­— nï¼Œä¸¢å¼ƒç»“æœé›†ä¸­çš„å‰ n ä¸ªæ–‡æ¡£ $limit æ¥å—ä¸€ä¸ªæ•°å­— nï¼Œè¿”å›ç»“æœé›†ä¸­çš„å‰ n ä¸ªæ–‡æ¡£ $sort ä¸»è¦ç”¨äºç»“æœé›†çš„æ’åºåº”ç”¨çœ‹å®Œäº†å„ç§å„æ ·çš„ç®¡é“æ“ä½œç¬¦ï¼Œæˆ–è®¸æœ‰çš„äººåœ¨æƒ³æ€ä¹ˆæŠŠå®ƒåˆ©ç”¨åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­å‘¢ï¼Ÿä¸‹é¢æˆ‘å°±é€šè¿‡å®¢æˆ·ç®¡ç†ç³»ç»Ÿä»‹ç»ä¸€ä¸‹èšåˆç®¡é“çš„æœ€ä½³å®è·µï¼Œå¤§å®¶å¬åˆ°å®¢æˆ·ç®¡ç†ç³»ç»Ÿå¯èƒ½æœ‰äº›é™Œç”Ÿï¼Œå®ƒè¿˜æœ‰ä¸€ä¸ªâ€œåˆ«åâ€ CRMã€‚CRM ç³»ç»Ÿä¸­å­˜åœ¨æœºä¼šã€å®¢æˆ·ã€è”ç³»äººè¿™ä¸‰ä¸ªå¤§çš„å¯¹è±¡ï¼Œå¯¹è±¡ä¹‹é—´éƒ½æ˜¯å­˜åœ¨å…³è”å…³ç³»çš„ï¼Œæœºä¼šå¯ä»¥å…³è”å¤šä¸ªè”ç³»äººï¼Œå¯ä»¥å…³è”ä¸€ä¸ªå®¢æˆ·ï¼Œè€Œè”ç³»äººå’Œå®¢æˆ·æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚é€šè¿‡ä¸‰ä¸ªåŸºæœ¬å¯¹è±¡æˆ‘ä»¬å¯ä»¥è¡ç”Ÿå‡ºå¾ˆå¤šèšåˆä¸šåŠ¡åœºæ™¯ï¼ŒåŸºç¡€æ¶æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼šå›¾ä¸€ï¼šåŸºç¡€æ¶æ„å›¾ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ä¸šåŠ¡åœºæ™¯ä¸­ç»å¸¸ä¼šå‡ºç°ç­›é€‰æ•°æ®çš„éœ€æ±‚ï¼Œå¦‚æ¡ä»¶ç­›é€‰å’Œè‡ªå®šä¹‰å­—æ®µæŸ¥è¯¢ç­‰éœ€æ±‚ï¼Œæ ¹æ®ç‰¹å®šçš„æ¡ä»¶ç­›é€‰å‡ºæˆ‘ä»¬æƒ³è¦çš„æ•°æ®ã€‚é’ˆå¯¹ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šæ¶‰åŠåˆ°ä»¥ä¸‹åœºæ™¯ï¼š åŸºç¡€å¯¹è±¡æŸ¥è¯¢ è¡¨ join æŸ¥è¯¢ åˆ†ç±»ç»Ÿè®¡ åµŒå¥—å¯¹è±¡æ’åº â€¦ è¯´åˆ°äº†å¸¸è§çš„åº”ç”¨åœºæ™¯ï¼Œä¸‹é¢ä¹Ÿä»‹ç»ä¸€ä¸‹æˆ‘ä»¬çš„ç³»ç»Ÿä¸šåŠ¡æ•°æ®æ¨¡å‹ï¼š æœºä¼šæ•°æ®æ¨¡å‹ 1234567891011db.deals&#123; &apos;_id&apos;: ObjectId, &apos;title&apos;: String, // æœºä¼šæ ‡é¢˜ &apos;status&apos;: String, // æœºä¼šçŠ¶æ€ &apos;peoples&apos;: Array, // å…³è”è”ç³»äºº &apos;_organizationId&apos;: ObjectIdï¼Œ // å…³è”å®¢æˆ· &apos;createdTime&apos;: Date, // åˆ›å»ºæ—¶é—´ &apos;updatedTime&apos;: Date, // åˆ›å»ºæ—¶é—´ &apos;owner&apos;: Object // æ‹¥æœ‰è€…&#125; è”ç³»äººæ•°æ®æ¨¡å‹ 1234567891011db.peoples&#123; &apos;_id&apos;: ObjectId, &apos;name&apos;: String, // è”ç³»äººåç§° &apos;phone&apos;: Array, // ç”µè¯ &apos;email&apos;: Array, // é‚®ç®± &apos;isArchive&apos;: Booleanï¼Œ // å½’æ¡£çŠ¶æ€ &apos;createdTime&apos;: Date, // åˆ›å»ºæ—¶é—´ &apos;updatedTime&apos;: Date, // åˆ›å»ºæ—¶é—´ &apos;owner&apos;: Object // æ‹¥æœ‰è€…&#125; å®¢æˆ·æ•°æ®æ¨¡å‹ 12345678910db.organizations&#123; &apos;_id&apos;: ObjectId, &apos;name&apos;: String, // å®¢æˆ·åç§° &apos;address&apos;: Array, // åœ°å€ &apos;isArchive&apos;: Booleanï¼Œ // å½’æ¡£çŠ¶æ€ &apos;createdTime&apos;: Date, // åˆ›å»ºæ—¶é—´ &apos;updatedTime&apos;: Date, // åˆ›å»ºæ—¶é—´ &apos;owner&apos;: Object // æ‹¥æœ‰è€…&#125; æœ‰äº†æ•°æ®æ¨¡å‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨å®ƒæ¥åšæ•°æ®èšåˆäº†ï¼Œä¸‹é¢ä¼šåˆ—ä¸¾å‡ºå®¢æˆ·ç®¡ç†ç³»ç»Ÿä¸­å¸¸ç”¨çš„æ•°æ®èšåˆå®è·µã€‚ åœ¨ CRM ç³»ç»Ÿä¸­ï¼Œä½œä¸ºé”€å”®ç®¡ç†ï¼Œä»–ç®¡è¾–çš„åœ°åŒºåœ¨æŒ‡å®šæ—¶é—´ç”Ÿæˆçš„æœºä¼šæ˜¯ä»–æ‰€å…³æ³¨çš„ã€‚å¦‚æœä»–éœ€è¦ç­›é€‰å‡º2018å¹´5æœˆ1æ—¥ä¹‹ååˆ›å»ºçš„æœºä¼šçš„è·Ÿè¿›ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡åˆ›å»ºæ—¶é—´çš„ç­›é€‰å®ç°ä»–çš„ç›®æ ‡ï¼Œèšåˆç®¡é“è¯­å¥å¦‚ä¸‹ï¼š æ¶‰åŠåˆ°çš„ç»„åˆï¼š$match -&gt; $project 1234db.deals.aggregate([ &#123; $match: &#123; createdTime: &#123; &apos;$gte&apos;: ISODate(&apos;2018-05-01&apos;) &#125; &#125; &#125;, &#123; $project: &#123; title: 1, owner: 1, status: 1, updatedTime: 1 &#125; &#125;]) åœ¨ CRM ç³»ç»Ÿä¸­ï¼Œä½œä¸ºé”€å”®ç®¡ç†ï¼Œç»å¸¸éœ€è¦ç»Ÿè®¡æ¯ä¸ªé”€å”®ä¸šç»©æƒ…å†µï¼Œç”¨äºä»–ä»¬çš„ä¸šç»©è€ƒæ ¸æŒ‡æ ‡ã€‚æ‰€ä»¥ä»–éœ€è¦ç»Ÿè®¡æ¯ä¸ªé”€å”®èµ¢å•çš„æœºä¼šæ•°ç›®ï¼Œä¸ºäº†è¾¾æˆè¿™ä¸€ç›®æ ‡ä»–å¯ä»¥å…ˆé€šè¿‡åŒ¹é…æ¡ä»¶ç­›é€‰å‡ºæ‰€æœ‰èµ¢å•çš„æœºä¼šï¼Œå¹¶è¿‡æ»¤æ‰€æœ‰æ‹¥æœ‰è€…ä¸ºç©ºï¼Œç„¶åå†é€šè¿‡äººå‘˜åˆ†ç»„ï¼Œè®¡ç®—æ¯ä¸ªé”€å”®èµ¢å•çš„æœºä¼šæ•°ï¼Œèšåˆç®¡é“è¯­å¥å¦‚ä¸‹æ‰€ç¤ºï¼š æ¶‰åŠåˆ°çš„ç»„åˆï¼š$match -&gt; $group 1234db.deals.aggregate([ &#123; $match: &#123; status: &apos;won&apos;, owner: &#123; &apos;$ne&apos;: null &#125; &#125; &#125;, &#123; $group: &#123; _id: &apos;$owner._id&apos;ï¼Œnum_deals: &#123; $sum: 1 &#125; &#125; &#125;]) åœ¨ CRM ç³»ç»Ÿä¸­ï¼Œä½œä¸ºä¸€åé”€å”®ï¼Œç»å¸¸éœ€è¦æ‹œè®¿å®¢æˆ·ï¼Œæ‹œè®¿å®Œæˆä¹‹åéœ€è¦åœ¨æœºä¼šä¸­å¡«å†™ç›¸åº”çš„è·Ÿè¿›è®°å½•ï¼Œæ‰€ä»¥å¯¹äºä»–ä»¬æ¥è¯´éœ€è¦å®Œæ•´çš„å®¢æˆ·åœ°å€ä¿¡æ¯ï¼Œç”¨äºæ—¥åçš„æ‹œè®¿ä½¿ç”¨ã€‚è¿™æ—¶å€™ä»–å°±å¯ä»¥æ ¹æ®æ‹¥æœ‰è€…æ˜¯è‡ªå·±ï¼Œå¹¶ä¸”å…³è”çš„å®¢æˆ·åœ°å€ä¿¡æ¯ä¸ºç©ºçš„ç­›é€‰æ¡ä»¶æ¥æ‰¾åˆ°é‚£äº›æœºä¼šä¿¡æ¯ç¼ºå¤±ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¾¿äºè®°å¿†æˆ‘ä»¬æŒ‰ç…§åˆ›å»ºæ—¶é—´å€’åºè¦æ˜¾ç¤ºæœºä¼šä¿¡æ¯ï¼Œèšåˆç®¡é“è¯­å¥å¦‚ä¸‹æ‰€ç¤ºï¼š æ¶‰åŠåˆ°çš„ç»„åˆï¼š$match -&gt; $lookup -&gt; $match -&gt; $sort 1234567891011db.deals.aggregate([ &#123; $match: &#123; &apos;owner.name&apos;: &apos;å¼ ä¸‰&apos; &#125; &#125;, &#123; $lookup: &#123; from: &apos;organizations&apos;, localField: &apos;_organizationId&apos;, foreignField: &apos;_id&apos;, as: &apos;organization&apos; &#125; &#125;, &#123; $match: &#123; &apos;organization.address&apos;: &#123;&apos;$ne&apos;: &apos;&apos;&#125; &#125; &#125;, &#123; $sort: &#123; &apos;createdTime&apos;: -1 &#125; &#125;]) åœ¨ CRM ç³»ç»Ÿä¸­ï¼Œä½œä¸ºä¸€ååˆšå…¥èŒçš„é”€å”®ï¼Œå¯ä»¥é€šè¿‡æŸ¥çœ‹åˆ«äººçš„èµ¢å•çš„è·Ÿå•æœºä¼šæ¥å­¦ä¹ å¦‚ä½•è·Ÿå•ã€‚è¿™æ—¶å€™ä»–å°±å¯ä»¥æ ¹æ®çŠ¶æ€æ˜¯èµ¢å•ä¸”æ‹¥æœ‰è€…æ˜¯å¼ ä¸‰çš„ç­›é€‰æ¡ä»¶ï¼Œæ‰¾å‡ºåˆ«äººæœ€è¿‘èµ¢å•çš„50æ¡é”€å”®æœºä¼šæ¥è¿›è¡Œå­¦ä¹ ã€‚èšåˆç®¡é“è¯­å¥å¦‚ä¸‹æ‰€ç¤ºï¼š æ¶‰åŠåˆ°çš„ç»„åˆï¼š$match -&gt; $project -&gt; $sort -&gt; $skip -&gt; $limit 1234567db.deals.aggregate([ &#123; $match: &#123; &apos;status&apos;: &apos;won&apos;, &apos;owner.name&apos;: &apos;å¼ ä¸‰&apos; &#125; &#125;, &#123; $project: &#123; &apos;name&apos;: 1, &apos;status&apos;: 1, &apos;wonTime&apos;: 1, &apos;note&apos;: 1 &#125;, &#123; $sort: &#123; &apos;wonTime&apos;: -1 &#125;, &#123; $skip: 0 &#125;, &#123; $limit: 50 &#125;]) åœ¨ CRM ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ä¹ æƒ¯æŠŠæ•°æ®çš„å®Œæ•´æ€§å’Œæˆå•æ¦‚ç‡æŒ‚é’©ï¼Œå¦‚æœé”€å”®æœºä¼šå…³è”çš„è”ç³»äººå’Œå®¢æˆ·ä¿¡æ¯ç¼ºå¤±ï¼Œå¾€å¾€ä»£è¡¨è¿™æ˜¯ä¸€æ¡æˆå•ç‡è¾ƒä½çš„æœºä¼šã€‚å› ä¸ºç¼ºå¤±è”ç³»äººä¿¡æ¯æ— æ³•åŠæ—¶ä¸å®¢æˆ·è”ç³»ä¼šé€ æˆå¤±å•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡èšåˆç®¡é“å…³è”æ“ä½œï¼Œå¯»æ‰¾å­˜åœ¨ä¸€ä¸ªå·²å½’æ¡£æˆ–è€…æ‹¥æœ‰è€…ä¸ºç©ºçš„è”ç³»äººå’Œå®¢æˆ·ï¼Œæ‰¾å‡ºå¯¹åº”çš„é”€å”®æœºä¼šï¼Œè¯„ä¼°è¯¥æœºä¼šçš„ä¿¡æ¯ç¼ºå¤±ç‡ï¼Œç„¶åå®Œå–„å…³è”ä¿¡æ¯ã€‚èšåˆç®¡é“è¯­å¥å¦‚ä¸‹ï¼š æ¶‰åŠåˆ°çš„ç»„åˆï¼š$match -&gt; $lookup -&gt; $lookup -&gt; $match -&gt; $sort -&gt; $skip -&gt; $limit 123456789101112131415161718192021222324252627282930313233db.deals.aggregate([ &#123; $match: &#123; &apos;owner.name&apos;: &apos;å¼ ä¸‰&apos;, &apos;$or&apos;: [ &#123; &apos;peoples&apos;: &#123; &apos;$ne&apos;: null &#125; &#125;, &#123; &apos;_organizationId&apos;:&#123; &apos;$ne&apos;: null &#125; &#125; ] &#125; &#125;, &#123; $lookup: &#123; from: &apos;peoples&apos;, localField: &apos;peoples&apos;, foreignField: &apos;_id&apos;, as: &apos;peoples&apos; &#125; &#125;, &#123; $lookup: &#123; from: &apos;organizations&apos;, localField: &apos;_organizationId&apos;, foreignField: &apos;_id&apos;, as: &apos;organization&apos; &#125; &#125;, &#123; $match: &#123; &apos;$or&apos;: [ &#123; &apos;peoples.isArchive&apos;: true &#125;, &#123; &apos;peoples.owner&apos;: &#123; &apos;$ne&apos;: null &#125; &#125;, &#123; &apos;organization.isArchive&apos;: true &#125;, &#123; &apos;organization.owner&apos;: &#123; &apos;$ne&apos;: null &#125; &#125; ] &#125;, &#123; $sort: &#123; &apos;createdTime&apos;: -1 &#125; &#125;, &#123; $skip: 0 &#125;, &#123; $limit: 50 &#125;]) æŠ€å·§æˆ‘ä»¬åœ¨ä½¿ç”¨èšåˆç®¡é“æ»¡è¶³æˆ‘ä»¬çš„ä¸šåŠ¡åœºæ™¯çš„åŒæ—¶ï¼Œå‘ç°æœ‰å¾ˆå¤šå°çš„æŠ€å·§èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ä¼˜åŒ–æ•°æ®æŸ¥è¯¢ï¼Œä¸‹é¢ç»™å¤§å®¶åˆ—ä¸¾ä¸€ä¸‹ï¼š ç®¡é“æ“ä½œç¬¦ä¹‹$ifNull å®šä¹‰ï¼šå¦‚æœè¡¨è¾¾å¼è®¡ç®—ä¸ºéç©ºå€¼ï¼Œåˆ™è®¡ç®—è¡¨è¾¾å¼å¹¶è¿”å›è¡¨è¾¾å¼çš„å€¼ã€‚å¦‚æœè¡¨è¾¾å¼è®¡ç®—ä¸ºç©ºå€¼ï¼ŒåŒ…æ‹¬æœªå®šä¹‰çš„å€¼æˆ–ç¼ºå°‘å­—æ®µçš„å®ä¾‹ï¼Œåˆ™è¿”å›æ›¿æ¢è¡¨è¾¾å¼çš„å€¼ã€‚ å¦‚æœéœ€æ±‚æ˜¯æŒ‰ç…§æ›´æ–°æ—¶é—´å¯¹æœªå½’æ¡£æœºä¼šè¿›è¡Œæ’åºï¼Œæ™®é€šçš„åšæ³•æ˜¯ï¼š1234db.deals.aggregate([ &#123; $match: &#123; &apos;isArchive&apos;: false &#125; &#125;, &#123; $sort: &#123; &apos;updatedTime&apos;: -1 &#125;]) è¿™æ ·å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œç”±äºå­˜åœ¨æ›´æ–°æ—¶é—´å­—æ®µä¸å­˜åœ¨æˆ–è€…å€¼ä¸ºç©ºçš„è„æ•°æ®ï¼Œå¯¼è‡´æ’åºç»“æœä¸å‡†ç¡®ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™æ ·å»åšï¼Œæ’åºé‡Œé¢æŒ‡å®šå¤šä¸ªå­—æ®µæ’åºï¼š1234db.deals.aggregate([ &#123; $match: &#123; &apos;isArchive&apos;: false &#125; &#125;, &#123; $sort: &#123; &apos;updatedTime&apos;: -1ï¼Œ&apos;_id&apos;: -1 &#125;]) å¦‚æœæˆ‘ä»¬è¿ç”¨ç®¡é“æ“ä½œç¬¦ $ifNull å»å®ç°çš„è¯ï¼Œå¯ä»¥æ›´æ”¹æ›´æ–°æ—¶é—´ç»“æ„ï¼Œå¹¶å¡«å……é»˜è®¤å€¼æ¥è¾¾åˆ°æˆ‘ä»¬æœŸæœ›çš„æ’åºç»“æœï¼š12345678db.deals.aggregate([ &#123; $match: &#123; &apos;isArchive&apos;: false &#125; &#125;, &#123; $project: &#123; title: 1, updatedTime: &#123; $ifNull: [ &quot;$updatedTime&quot;, ISODate(&apos;9000-01-01&apos;)] &#125; &#125; &#125; &#123; $sort: &#123; &apos;updatedTime&apos;: -1&#125;]) ä½¿ç”¨ $ifNull æ•°æ®å¡«å……æ¥è¿›è¡Œæ’åºæ•ˆç‡æ¯”ç©ºå€¼æ¯”è¾ƒæ’åºæ•ˆç‡è¦é«˜ï¼ŒMongoDB å®˜æ–¹ä¹Ÿç»™å‡ºäº†æ’åºç±»å‹æ•ˆç‡é¡ºåºå›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š å›¾äºŒï¼šä¸åŒç±»å‹æ’å€¼å›¾ ç®¡é“æ“ä½œç¬¦ä¹‹$cond å®šä¹‰ï¼šè¯„ä¼°å¸ƒå°”è¡¨è¾¾å¼ä»¥è¿”å›ä¸¤ä¸ªæŒ‡å®šçš„è¿”å›è¡¨è¾¾å¼ä¹‹ä¸€ã€‚å¦‚æœæˆ‘ä»¬è¦å®ç°æŒ‰ç…§æ›´æ–°æ—¶é—´å¯¹æœªå½’æ¡£æœºä¼šè¿›è¡Œæ’åºï¼Œæ›´æ–°æ—¶é—´ä¸ºç©ºçš„å¡«å……é»˜è®¤å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®ç°ï¼š123456789101112db.deals.aggregate([ &#123; $match: &#123; &apos;isArchive&apos;: false &#125; &#125;, &#123; $project: &#123; title: 1, updatedTime: &#123; $cond: &#123; ifï¼š&#123;&apos;$eq&apos;: [&apos;$updatedTime&apos;, null]&#125; , then: ISODate(&apos;9000-01-01&apos;) else &apos;$updatedTime&apos; &#125; &#125; &#125; &#125; &#123; $sort: &#123; &apos;updatedTime&apos;: -1&#125;]) ä¼˜åŒ– ç­–ç•¥ä¼˜åŒ– å°† $match å’Œ $sort æ”¾åˆ°ç®¡é“çš„å‰é¢ï¼Œå¯ä»¥ç»™é›†åˆå»ºç«‹ç´¢å¼•ï¼Œæ¥æé«˜å¤„ç†æ•°æ®çš„æ•ˆç‡ å¯ä»¥ç”¨ $matchã€$limitã€$skip å¯¹æ–‡æ¡£è¿›è¡Œæå‰è¿‡æ»¤ï¼Œä»¥å‡å°‘åç»­å¤„ç†æ–‡æ¡£çš„æ•°é‡ MongoDB è‡ªèº«ä¼˜åŒ–å™¨ $sort + $match é¡ºåºä¼˜åŒ– å¦‚æœ $match å‡ºç°åœ¨ $sort ä¹‹åï¼Œä¼˜åŒ–å™¨ä¼šè‡ªåŠ¨æŠŠ $match æ”¾åˆ° $sort å‰é¢ $skip + $limit é¡ºåºä¼˜åŒ– å¦‚æœ $skip åœ¨ $limit ä¹‹åï¼Œä¼˜åŒ–å™¨ä¼šæŠŠ $limit ç§»åŠ¨åˆ° $skip çš„å‰é¢ï¼Œç§»åŠ¨å $limitçš„å€¼ç­‰äºåŸæ¥çš„å€¼åŠ ä¸Š $skip çš„å€¼æ³¨æ„äº‹é¡¹ è¿”å›ç»“æœå¤§å° èšåˆç»“æœè¿”å›çš„æ˜¯ä¸€ä¸ªæ–‡æ¡£ï¼Œä¸èƒ½è¶…è¿‡ 16Mï¼Œä» MongoDB 2.6ç‰ˆæœ¬ä»¥åï¼Œè¿”å›çš„ç»“æœå¯ä»¥æ˜¯ä¸€ä¸ªæ¸¸æ ‡æˆ–è€…å­˜å‚¨åˆ°é›†åˆä¸­ï¼Œè¿”å›çš„ç»“æœä¸å— 16M çš„é™åˆ¶ã€‚ å†…å­˜ åœ¨è¿›è¡Œ Group æ“ä½œçš„æ—¶å€™ï¼Œå¦‚æœå†…å®¹è¶…è¿‡ 100 Mï¼Œå°†ä¼šæŠ›é”™ â€œExceeded memory limit for $group, but not allow enternal sort, put allowDiskUse trueâ€ï¼Œå¦‚æœéœ€è¦å¤„ç†å¤§æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ allowDiskUse é€‰é¡¹ï¼Œå­˜å‚¨åˆ°ç£ç›˜ä¸Šã€‚ èšåˆæ“ä½œç¬¦ä½¿ç”¨ åœ¨è¿›è¡Œ $project æ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ—¶å¸¸ä¼šæŠŠä¸éœ€è¦çš„å€¼è¿‡æ»¤æ‰ï¼Œä»¥æ­¤æ¥å‡å°‘èšåˆæ“ä½œå¯¹å†…å­˜çš„æ¶ˆè€—ï¼Œä½†æ˜¯ä¸å¯ä»¥åˆ é™¤é»˜è®¤çš„ _id, å¦‚æœåˆ é™¤ä¼šæŠ›é”™ â€œexception: The top-level _id field is the only field currently supported for exclusionâ€ï¼Œ_id ä½œä¸ºå®˜æ–¹å­—æ®µä¸å¯ä»¥åˆ é™¤æ‰ã€‚ å°ç»“ä»Šå¤©æˆ‘ä¸ºä½ ä»‹ç»äº† MongoDB èšåˆç®¡é“çš„åº”ç”¨å®è·µã€æŠ€å·§ã€ä¼˜åŒ–ä»¥åŠæ³¨æ„äº‹é¡¹ï¼Œè§£é‡Šäº†èšåˆç®¡é“æ“ä½œç¬¦çš„åŸºç¡€æ¦‚å¿µï¼Œå¸Œæœ›èƒ½å¤Ÿå¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚ è¿™å°±æ˜¯ä»¥ä¸Šå…¨éƒ¨çš„å†…å®¹ï¼Œç•™å‡ é“æ€è€ƒé¢˜ç»™ä½ å§ã€‚ä½ ä»¬å…¬å¸ä½¿ç”¨ MongoDB èšåˆç®¡é“å—ï¼Ÿä¸€èˆ¬ä½¿ç”¨åœ¨ä»€ä¹ˆä¸šåŠ¡ä¸Šé¢ï¼Ÿä½ è§‰å¾—å¥½ç”¨å—ï¼Ÿ","categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://sensitivemix.github.io/categories/æ•°æ®åº“/"}],"tags":[{"name":"Database","slug":"Database","permalink":"https://sensitivemix.github.io/tags/Database/"},{"name":"MongoDB","slug":"MongoDB","permalink":"https://sensitivemix.github.io/tags/MongoDB/"}]},{"title":"åŒºå—é“¾çš„è¿è¡ŒåŸç†","slug":"åŒºå—é“¾çš„è¿è¡ŒåŸç†","date":"2018-04-08T07:17:12.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/04/08/åŒºå—é“¾çš„è¿è¡ŒåŸç†/","link":"","permalink":"https://sensitivemix.github.io/2018/04/08/åŒºå—é“¾çš„è¿è¡ŒåŸç†/","excerpt":"","text":"åŒºå—é“¾åˆ°åº•æ˜¯å¦‚ä½•è¿è¡Œçš„ï¼Ÿ è¿™ä¸€ç¯‡æ–‡ç« æˆ‘å°†ä»¥æ¯”ç‰¹å¸åŒºå—é“¾ä¸ºä¾‹æ¥è¿›è¡Œè®²è§£ï¼Œç†ç”±æœ‰ä¸¤ä¸ªï¼š ç”±äºåŒºå—é“¾å‘å±•åˆ°ç›®å‰é˜¶æ®µï¼Œå„ä¸ªæŠ€æœ¯æ–¹å‘éƒ½æœ‰é•¿è¶³çš„å‘å±•ï¼Œé‚£ä¹ˆä¸ºäº†æ–¹ä¾¿ä½ ç†è§£ï¼Œæˆ‘åœ¨è¿™é‡Œä»‹ç»æœ€ç®€å•ã€æœ€å®¹æ˜“ç†è§£çš„\bæ¯”ç‰¹å¸åŒºå—é“¾ï¼› ç”±äºå¤§éƒ¨åˆ†åŒºå—é“¾éƒ½æ˜¯ä»¥æ¯”ç‰¹å¸åŒºå—é“¾ä¸ºåŸºç¡€è¿›è¡Œæ‰©å……çš„ï¼Œæ‰€ä»¥é¦–å…ˆäº†è§£æ¯”ç‰¹å¸åŒºå—é“¾æœ‰åŠ©äºå…¶ä»–é¡¹ç›®åŒºå—é“¾çš„åç»­å­¦ä¹ ã€‚ ä¸­å¿ƒåŒ–è®°è´¦çš„é—®é¢˜é¦–å…ˆï¼Œæˆ‘ä»¬å€Ÿé‰´äº†ä¸€ä¸ªåŒºå—é“¾æè¿°ä¸­çš„ç»å…¸æƒ…æ™¯æ¥æ¨¡æ‹Ÿä¸­å¿ƒåŒ–è®°è´¦ã€‚ å‡è®¾æœ‰ä¸€ä¸ªæœ‰ç™¾æˆ·å±…æ°‘çš„æ‘å­ï¼Œå…¶ä¸­æœ‰ä¸€ä½å¾·é«˜æœ›é‡çš„æ‘é•¿ï¼Œæ‘é•¿æœ‰ä¸€ä¸ªå„¿å­ã€‚æ‘æ°‘ä»¬éƒ½æŠŠé’±å­˜åˆ°æ‘é•¿å®¶ï¼Œæ‘é•¿è´Ÿè´£è®°è´¦ã€‚æ¯”å¦‚ï¼Œå¼ ä¸‰ç”¨ 1000 ä¹°äº†æå››å®¶çš„ç‰›ï¼Œæ‘é•¿å°±æŠŠå¼ ä¸‰åä¸‹çš„å­˜æ¬¾å‡å» 1000ï¼Œæå››å®¶åŠ ä¸Š 1000ã€‚å¬èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆåƒé“¶è¡Œçš„æ“ä½œï¼Ÿ å¯¹ï¼Œæˆ‘ä»¬å°±æ˜¯å…ˆä»ä¸­å¿ƒåŒ–çš„é“¶è¡Œè®°è´¦å¼€å§‹èŠèµ·ã€‚æ‘æ°‘éƒ½ç›¸ä¿¡æ‘é•¿ï¼Œæ‰æ„¿æ„æŠŠé’±å­˜åˆ°æ‘é•¿å®¶ï¼Œä»–ä»¬ç›¸ä¿¡æ‘é•¿ä¸ä¼šä½œæ¶ã€‚ å¯æƒœå¥½æ™¯ä¸é•¿ï¼Œè€æ‘é•¿ç”±äºæ“åŠ³è¿‡åº¦ï¼Œé©¾é¹¤è¥¿å»äº†ã€‚æ–°ä¸Šä»»çš„æ‘é•¿å„¿å­é“è›‹å¾ˆæ˜¯èªæ˜ï¼Œä½†ä¹Ÿæœ‰ä¸ªæ¯›ç—…ï¼Œå°±æ˜¯ç²—å¿ƒå¤§æ„ã€‚ä»–ä¸ä½†ç»å¸¸ç®—é”™è´¦ï¼Œä¸€æ¬¡è¿˜è¢«äººå·æ”¹äº†è´¦å•ã€‚ ä¸è¿‡ï¼Œå¹¸å¥½æ‘æ°‘è‡ªå·±éƒ½æœ‰è®°è´¦ï¼Œä½†æ˜¯ç”±äºé“è›‹æ¯æ¬¡é”™è´¦åéƒ½è¦å’Œåˆ«äººæ ¸å¯¹åŠå¤©ï¼Œå¯¼è‡´æ‘æ°‘å¯¹æ–°æ‘é•¿çš„è®°è´¦èƒ½åŠ›ååˆ†ä¸æ»¡ã€‚ æ—¶é—´å°±è¿™ä¹ˆè¿‡ç€ï¼Œç„¶è€Œæœ€å¯æ€•çš„äº‹æƒ…è¿˜æ˜¯å‘ç”Ÿäº†ï¼Œé“è›‹çš„è€å©†ç«Ÿç„¶ç§ä¸‹ç¯¡æ”¹è´¦æœ¬ï¼Œç»™é“è›‹ä¸ƒå¤§å§‘å…«å¤§å§¨çš„ä½™é¢å…¨éƒ¨å·å·åŠ äº†å¥½å¤šï¼Œç»ˆäºæœ‰ä¸€å¤©äº‹æƒ…æš´éœ²ï¼Œæ‘æ°‘ä»¬æ°”å†²å†²åœ°è·‘åˆ°é“è›‹å®¶é‡Œè®¨è¯´æ³•ï¼Œäºæ˜¯ä¸€ç‰‡æ··ä¹±ã€‚ è¿™æ—¶å€™æœ‰ä¸ªå«ä¸­æœ¬èªçš„äººç«™äº†å‡ºæ¥ï¼Œä»–è¯´ä»–è®¾è®¡äº†ä¸€å¥—ç³»ç»Ÿï¼Œå¯ä»¥ä¸ä¾èµ–ä»»ä½•äººè®°è´¦ï¼Œäºæ˜¯ï¼Œä¼—äººå¼€å§‹å°†ç›®å…‰é›†ä¸­åˆ°ä»–çš„èº«ä¸Šã€‚ 1. å…¬å¼€è®°è´¦ä¸­æœ¬èªè¯´ä»–çš„ç³»ç»Ÿç¨å¾®éº»çƒ¦ä¸€ç‚¹ï¼Œéœ€è¦å¹²ä¸‰ä»¶äº‹å„¿ã€‚ æ¯å®¶æ¯æˆ·éƒ½æ´¾å‘ä¸€åªä¿¡é¸½ã€‚è¿™å°±æ˜¯ P2P ç½‘ç»œï¼Œæ˜¯ä¸€ä¸ªç‚¹å¯¹ç‚¹çš„åˆ†å¸ƒå¼ç½‘ç»œï¼Œå¦‚æœä¸å¥½ç†è§£ï¼Œä½ å…ˆä¸ç”¨ç†ä¼šï¼Œæˆ‘ä¼šåœ¨åé¢è®²åˆ°ã€‚ æ¯å®¶æ¯æˆ·éƒ½å‘ä¸€ä¸ªç‰¹æ®Šçš„å°ç« å’Œä¸€ä¸ªæ‰«æå™¨ã€‚è¿™ä¸ªæ‰«æå™¨æœ‰ä¸¤ä¸ªåŠŸæ•ˆï¼Œä¸€æ˜¯è¯†åˆ«ä»–äººçš„äº¤æ˜“æ˜¯å¦çœŸå®æœ‰æ•ˆï¼ŒäºŒæ˜¯è¯†åˆ«è¿™ä¸ªäº¤æ˜“æ˜¯ä¸æ˜¯è‡ªå·±è´¦å·çš„ï¼Œ\båŒæ—¶è¯†åˆ«å¹¶è§£é”æœªèŠ±è´¹çš„ä½™é¢ã€‚è¿™å°±æ˜¯éå¯¹ç§°åŠ å¯†ã€‚ æ¯å®¶æ¯æˆ·å¯ä»¥å‚ä¸è®°è´¦ï¼Œä¸è¿‡ä¸å†è®°ä½™é¢ï¼Œè€Œæ˜¯è®°äº¤æ˜“æœ¬èº«çš„å†…å®¹ã€‚è¿™å°±æ˜¯åŒºå—é“¾ä¸­çš„äº¤æ˜“ï¼Œè¿™ä¸ªâ€œäº¤æ˜“â€å¯¹åº”çš„è‹±æ–‡å•è¯æ˜¯â€œTransactionâ€ï¼Œè¿™æ˜¯ä¸ªä¸“æœ‰åè¯ï¼Œä¸“æŒ‡ä¸€ç¬”è´¦ï¼Œä¸åŒäºé‡‘èäº¤æ˜“çš„ Tradeã€‚ è¿™ä¸‰æ¡æ€»ä½“æ¥è¯´å…¶å®æ˜¯å¹²ä¸€ä»¶äº‹æƒ…ï¼Œå°±æ˜¯ï¼š æ¯å®¶æ¯æˆ·éƒ½è®°è´¦ï¼Œè´¦ç°¿ä¸Šä¸å†è®°è½½æ¯æˆ·æ‘æ°‘çš„ä½™é¢ï¼Œè€Œåªè®°è½½æ¯ä¸€ç¬” Transactionï¼Œå³è®°è½½æ¯ä¸€ç¬”äº¤æ˜“çš„ä»˜æ¬¾äººã€æ”¶æ¬¾äººå’Œä»˜æ¬¾é‡‘é¢ã€‚ é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼šå¦‚æœæ¯æˆ·éƒ½è®°è´¦ï¼Œè‚¯å®šæ¯æˆ·çš„è´¦éƒ½ä¸ç»Ÿä¸€å•Šï¼Œä½ è®°ä½ çš„ï¼Œæˆ‘è®°æˆ‘çš„ï¼Œæœ€åä¸å…¨ä¹±äº†ä¹ˆï¼Ÿ è¿™ä¸ªæ—¶å€™éœ€è¦å¤§å®¶ç»Ÿä¸€è´¦æœ¬ï¼Œä¿è¯å¤§å®¶çš„è´¦æœ¬éƒ½æ˜¯ä¸€è‡´çš„ã€‚å› ä¸ºè®°å½•çš„äº¤æ˜“æ˜¯å…¨æ‘æ‰€æœ‰äººæœ‰åºäº§ç”Ÿçš„ï¼Œæ‰€ä»¥è¿™å°±éœ€è¦æœ‰ä¸€ä¸ªå¹¿æ’­æœºåˆ¶ã€‚è¿™ä¸ªå¹¿æ’­æœºåˆ¶ï¼Œæˆ‘å…ˆå–ä¸ªå…³å­ï¼Œåé¢å†è®²ã€‚ ä¸­æœ¬èªè¯´ï¼Œå…¶å®å¾ˆç®€å•ï¼Œæˆ‘ä»¬ç°åœ¨å…ˆæŠŠå…¨æ‘æ‰€æœ‰äººçš„èµ„äº§éƒ½åŠ èµ·æ¥ã€‚è¿˜çœŸå·§äº†ï¼Œåˆšå¥½ 100 ä¸‡ã€‚ ä¸­æœ¬èªæ¥ç€è¯´ï¼šâ€œåªè¦è´¦ç°¿çš„åˆå§‹çŠ¶æ€ç¡®å®šï¼Œå¹¶ä¸”æ¯ä¸€ç¬”äº¤æ˜“å¯é å¹¶æŒ‰ç…§ç‰©ç†æ—¶é—´è‡ªç„¶è®°å½•ï¼Œå¹¶ä¸”åªåŠ ä¸æ”¹ä¸åˆ ï¼Œè¿™æ ·ï¼Œå½“å‰æ¯æˆ·æŒæœ‰å¤šå°‘èµ„äº§æ˜¯å¯ä»¥æ¨ç®—å‡ºæ¥çš„ã€‚â€ ä¸­æœ¬èªè¯´æˆ‘ç°åœ¨æŠŠæˆ‘çš„å°ç« ç»™ä½ ä»¬çœ‹ï¼Œè¿™ä¸ªå°ç« å¾ˆç‰¹æ®Šï¼Œç›–çš„ç« æœ‰ä¸¤å—æ ‡è®°ï¼Œç¬¬ä¸€å—æ˜¯ä¸€ä¸ªå¯ä»¥è¯†åˆ«çš„æ ‡è®°ï¼Œæ¯”å¦‚æˆ‘å¾€çº¸ä¸Šä¸€æ•²ï¼Œå¯è¯†åˆ«çš„æ ‡è®°æ˜¯ 1MsTg2ã€‚ è¿™å°±æ˜¯ä½ ä»¬çš„ä»£å·ï¼Œç”±äºæˆ‘ä»¬è´¦æœ¬æ˜¯å…¬å¼€çš„ï¼Œä½¿ç”¨çœŸå®å§“åä¼šå¾ˆå±é™©ï¼Œæ‰€ä»¥ä½ ä»¬è®°è´¦çš„äº¤æ˜“å•ä¸Šæ”¶æ¬¾äººã€ä»˜æ¬¾äººéƒ½å¡«è¿™ä¸ªç ï¼Œä¸ç”¨å†™å§“åã€‚ä½ çš„æ‰«æå™¨å’Œä½ çš„å°ç« ç”Ÿæˆçš„ä»£å·æ˜¯å…³è”çš„ï¼Œæœ‰ä¸”ä»…æœ‰æŒæœ‰å¯¹åº”æ‰«æå™¨çš„äººæ‰èƒ½èŠ±è´¹é‡‘é¢ï¼Œè¿™ä¸€æ­¥å³ä¸ºâ€œè§£å¼€äº¤æ˜“â€ã€‚ åˆšåˆšè¯´å°ç« æœ‰ä¸¤å—ï¼Œè¿™ç¬¬äºŒå—å†…å®¹é…åˆè¿™ä¸ªæ‰«æå™¨æ‰èƒ½çœ‹ï¼Œè‚‰çœ¼çœ‹åˆ™éƒ½æ˜¯ä¹±ç ï¼Œæ‰«æå™¨ä¸€æ‰«å°±çŸ¥é“ç¬¬äºŒå—å†…å®¹æ˜¯å¦æœ‰æ•ˆï¼Œè¿™ä¸€æ­¥ä¹Ÿå°±æ˜¯â€œäº¤æ˜“éªŒè¯â€ã€‚ å¹¶ä¸”æ‰€æœ‰äº¤æ˜“å¤§å®¶éƒ½èƒ½æ¥æ”¶ï¼Œéƒ½èƒ½çœ‹åˆ°ï¼Œä½†å´è§£ä¸å¼€å°ç« ä¹±ç éƒ¨åˆ†çš„å†…å®¹ï¼Œä»…ä»…æ”¶æ¬¾æ–¹æ‰èƒ½è§£å¼€ï¼Œå› ä¸ºä½ çš„æ‰«æå™¨å’Œä½ å°ç« ç”Ÿæˆçš„ä»£å·æ˜¯å…³è”çš„ï¼Œæœ‰ä¸”ä»…æœ‰æŒæœ‰å¯¹åº”æ‰«æå™¨çš„äººæ‰èƒ½è§£å¼€äº¤æ˜“ã€‚ ä»¥ä¸Šå°±æ˜¯åŒºå—é“¾ä¸­â€œå…¬å¼€è®°è´¦â€çš„è¿‡ç¨‹ã€‚â€œå…¬å¼€è®°è´¦â€å°±æ˜¯å…¨ç½‘æ‰€æœ‰äººéƒ½å¯ä»¥éšæ—¶æŸ¥çœ‹ä¸€å¥—è´¦æœ¬ï¼Œç„¶åæŒ‰ç…§è§„åˆ™é€æ˜å…¬å¼€åœ°è¿›è¡Œè®°è´¦ã€‚ 2. åˆ›å»ºåˆ›ä¸–åŒºå—åˆ›ä¸–åŒºå—æ˜¯æˆ‘ä»¬ç”Ÿæˆå…¨æ‘å…¬å¼€è´¦æœ¬çš„ç¬¬ä¸€ç¬”äº¤æ˜“çš„ç¬¬ä¸€ä¸ªä¿¡å°ï¼Œå¥½æ¯”ä¸€ç¯‡æ–‡ç« æ€»å¾—æœ‰ä¸ªå¼€å¤´ä¸€æ ·ã€‚ äºæ˜¯ä¹ï¼Œä¸­æœ¬èªè¯´æˆ‘å…ˆç”Ÿæˆç¬¬ä¸€ä¸ª Transactionï¼Œè¿™ä¸ªäº¤æ˜“å•çš„ä»˜æ¬¾äººä¸ºç©ºï¼Œæ”¶æ¬¾äººæ˜¯æ‘é•¿ï¼Œä»˜æ¬¾é‡‘é¢æ˜¯ 100 ä¸‡ï¼Œå› ä¸ºæ˜¯åˆ›ä¸–åŒºå—ï¼Œäº§å‡ºå¤šå°‘ä¸ªæ˜¯å¯ä»¥éšæ„è§„å®šçš„ï¼Œç”±äºæˆ‘ä»¬ä¸Šé¢ç»Ÿè®¡äº†å…¨æ‘çš„è´¦ç›®æƒ…å†µï¼Œæ‰€ä»¥æˆ‘å°±å†™äº† 100 ä¸‡ï¼Œå¾…ä¼šå„¿ä»˜æ¬¾ç»™æ‘é•¿ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§åŸæ¥çš„è´¦æœ¬ç»™å¤§å®¶å‘é€å¯¹åº”çš„é‡‘é¢è¿‡å»ã€‚ å¥½äº†ï¼Œæˆ‘ä»¬æœ‰äº†ç¬¬ä¸€ç¬”äº¤æ˜“ï¼Œç¬¬ä¸€ä¸ªä¿¡å°ä¹Ÿå·²ç»åšå¥½äº†ã€‚ç°åœ¨è®©æ‘é•¿æŠŠä¿¡å°ä¼ ç»™å¼ ä¸‰ï¼Œå¼ ä¸‰å¤å°ä¸€ä»½ï¼Œç„¶åä¼ ç»™æå››ï¼Œæå››ç»§ç»­ä¼ ä¸‹å»ï¼Œä¸€ä¼ åï¼Œåä¼ ç™¾ï¼Œç›´åˆ°ä¼ ç»™å…¨æ‘äººï¼Œè¿™ä¸ªæ­¥éª¤ä¹Ÿå°±æ˜¯â€œåŒæ­¥åŒºå—â€ï¼Œä¹Ÿå°±æ˜¯å…¨ç½‘éƒ½æ‹¿åˆ°è¿™ä¸ªä¿¡å°ï¼Œä»¥åŠä¿¡å°é‡Œé¢çš„ Transactionã€‚ 3. äº¤æ˜“ç”±äºä¸Šä¸€èŠ‚æˆ‘ä»¬çš„åˆ›ä¸–åŒºå—æŠŠ 100 ä¸‡äº¤ç»™äº†æ‘é•¿ï¼Œé‚£ä¹ˆæˆ‘ä»¬å‡è®¾å¼ ä¸‰åœ¨æ‘é•¿é‚£é‡Œçš„å­˜æ¬¾ä½™é¢æ˜¯ 10 ä¸‡ï¼Œè¿™æ—¶å€™æ‘é•¿è¦æ ¹æ®åŸæ¥çš„æ—§è´¦æœ¬ï¼ŒæŠŠè¿™ 10 ä¸‡å‘é€ç»™å¼ ä¸‰ï¼Œç„¶åæŠŠæ—§è´¦æœ¬ä¸Šçš„è´¦åˆ’æ‰ã€‚ä¸‹é¢æˆ‘ä»¬è®¨è®ºä¸€ä¸‹å¦‚ä½•æ„é€ è¿™ç¬”äº¤æ˜“ã€‚ ä¸­æœ¬èªå¼€å§‹æ•™æ‘é•¿å†™äº¤æ˜“å•ï¼ŒæŠŠ 100 ä¸‡åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ† 10 ä¸‡ï¼Œæ”¶æ¬¾äººæ˜¯å¼ ä¸‰ï¼›ç¬¬äºŒéƒ¨åˆ†æ˜¯ 90 ä¸‡ï¼Œæ”¶æ¬¾äººæ˜¯è‡ªå·±ï¼›è¿™æ ·ä¸€ä¸ª Transaction å°±åšæˆå•¦ã€‚ å‰é¢æˆ‘ä»¬è¯´äº†ï¼Œä¸èƒ½ç›´æ¥å†™åå­—ï¼Œè¦å†™ä»£å·ï¼Œè¿™ä¸ªä»£å·ä¹Ÿå°±æ˜¯ä½ çš„é’±åŒ…åœ°å€ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ”¶æ¬¾äººå†™åå­—çš„åœ°æ–¹ï¼Œè®©æ”¶æ¬¾äººæ‹¿å‡ºè‡ªå·±å°ç« ï¼ŒæŠŠä»£å·è¯»å‡ºæ¥ï¼Œç„¶åå‘Šè¯‰æ‘é•¿å³å¯ã€‚ 100 ä¸‡ 10 ä¸‡ï¼Œå¼ ä¸‰ 90 ä¸‡ï¼Œè‡ªå·± æ‘é•¿å†™å¥½ Transaction ä»¥åï¼Œè¿˜éœ€è¦æ‹¿å‡ºè‡ªå·±çš„å°ç« ï¼Œåœ¨ Transaction ä¸Šç›–ç« ï¼Œè¿™ä¸ªç›–ç« çš„è¿‡ç¨‹ä¹Ÿå°±ç›¸å½“äºåŒºå—é“¾ä¸­çš„ç­¾åã€‚è¿™ä¸ªç« ï¼Œå…¨æ‘äººéƒ½å¯ä»¥æ‹¿æ‰«æå™¨æ‰«ä¸€ä¸‹éªŒè¯æ˜¯å¦æœ‰æ•ˆï¼Œå³éªŒè¯ä»˜æ¬¾äººçš„ç« æ˜¯å¦æœ‰æ•ˆã€‚ 100 ä¸‡ 10 ä¸‡ï¼Œå¼ ä¸‰çš„å°ç« ï¼ˆ1s25vRï¼‰ 90 ä¸‡ï¼Œæ‘é•¿çš„å°ç« ï¼ˆ13gYipï¼‰ å°±è¿™æ ·ï¼Œæ‘é•¿ä¸€å…±å†™äº† 10 ä»½ Transactionï¼Œåˆ†åˆ«ä»£è¡¨äº†å‘é€ç»™ä¸åŒäººçš„äº¤æ˜“ï¼Œå¼ ä¸‰ä¸€ç¬” 10 ä¸‡ï¼Œæå››ä¸€ç¬” 1 ä¸‡ï¼Œç­‰ç­‰ã€‚ 4. æ‰“åŒ… Transaction ï¼ˆæŒ–çŸ¿ï¼‰ç°åœ¨æˆ‘ä»¬æœ‰äº† Transactionï¼Œä½†æ˜¯è¿˜éœ€è¦ä¸œè¥¿æŠŠ Transaction è£…èµ·æ¥ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç‰¹æ®Šçš„ä¿¡å°æŠŠ Transaction è£…èµ·æ¥ï¼Œè¿™ä¸ªä¿¡å°å°±æ˜¯åŒºå—é“¾ä¸­çš„â€œåŒºå—â€ï¼Œè¿™ä¸ªå°è£…è¿‡ç¨‹å°±æ˜¯â€œæ‰“åŒ…äº¤æ˜“â€ã€‚ ä¸ºä»€ä¹ˆè¦å°è£…èµ·æ¥å‘¢ï¼Ÿæ˜¯ä¸ºäº†è®©æ‰“åŒ…äº¤æ˜“çš„äººèƒ½å¤Ÿåœ¨ä¿¡å°ä¸Šç½²åï¼Œè¡¨ç¤ºè¿™æ¬¡æ‰“åŒ…æ˜¯ç”±æŸæŸæŸæ‰“åŒ…çš„ï¼Œå…¶æ¬¡å…¨æ‘çš„äº¤æ˜“å¯èƒ½éå¸¸å¤šï¼Œéœ€è¦è£…é…æ ‡å·ï¼Œæ–¹ä¾¿å¤§å®¶æŸ¥è¯¢ã€‚ æˆ‘ä»¬çœ‹åˆ°ä¸Šè¿°çš„ Transaction è™½ç„¶å·²ç»ç”Ÿæˆï¼Œä½†æ˜¯æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ²¡æœ‰è§„å®šè°æœ‰æƒåˆ©æŠŠ Transaction å°è£…åˆ°ä¿¡å°é‡Œã€‚ æˆ‘ä»¬åœ¨å¼€ç¯‡çš„æ•…äº‹ä¸­çœ‹åˆ°äº†ä¸­å¿ƒåŒ–æ“ä½œè‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œå‡è®¾åœ¨å…¨æ‘äººä¸­ï¼Œè¿™æ—¶å€™å¦‚ä½•ç­›é€‰å‡ºè¿™äº›æ‰“åŒ…çš„äººå‘¢ï¼Ÿ ä¸­æœ¬èªè¿™æ—¶å€™è¯´äº†ï¼Œç”±äºæˆ‘ä»¬æ‘çš„äººå£å¢é•¿ï¼Œ100 ä¸‡æœªæ¥å¯èƒ½ä¸å¤Ÿï¼Œæˆ‘ä»¬æš‚å®š 150 ä¸‡ï¼Œé‚£å¤šä½™çš„ 50 ä¸‡ï¼Œæˆ‘ä»¬å°±å½“å¥–åŠ±ç»™è¿™äº›è£…ä¿¡å°çš„äººäº†ï¼Œå½“ç„¶ä¸èƒ½ä¸€æ¬¡æ€§ç»™ï¼Œè°è£…ä¸€æ¬¡ä¿¡å°å°±é¢† 3 ä¸ªå¸ã€‚ è¿™æ—¶å€™å¤§å®¶ä¼™å„¿æ¥åŠ²äº†å‘€ï¼Œåªè¦è£…ä¿¡å°å°±èƒ½å¤Ÿé¢†é’±äº†ï¼Œæˆ‘ä»¬åœ¨è¿™é‡ŒæŠŠç¬¦åˆæ¡ä»¶çš„äººç§°ä½œâ€œçŸ¿å·¥â€ã€‚ ä½†æ˜¯ä¸­æœ¬èªåˆè¯´äº†ï¼Œè¦è·å¾—è¿™ä¸ªè£…ä¿¡å°çš„æƒåˆ©ï¼Œæ˜¯æœ‰æ¡ä»¶çš„ã€‚æˆ‘ç»™å¤§å®¶å‡ºä¸€ä¸ªéš¾é¢˜ï¼Œè°å…ˆè§£å‡ºè¿™ä¸ªéš¾é¢˜çš„ç­”æ¡ˆï¼Œè°å°±æœ‰æƒåˆ©æŠŠ Transaction è£…åˆ°ä¸€ä¸ªä¿¡å°ä¸­ï¼Œå¹¶ä¸”è¦åœ¨æ­¤ä¿¡å°ä¸Šç›–ä¸Šè‡ªå·±çš„ç« ã€‚ è¿™ä¸ªéš¾é¢˜æ˜¯è¿™æ ·çš„ï¼Œå®ƒæœ‰ä¸¤å¤§ç‰¹æ€§ï¼Œç¬¬ä¸€æ˜¯å®¹æ˜“éªŒè¯ï¼Œç¬¬äºŒæ˜¯è®¡ç®—è¿‡ç¨‹éå¸¸å¤æ‚ã€‚ ä¾‹å¦‚ï¼Œæœ‰ç§æ£‹ç‰Œç±»æ¸¸æˆå«ä½œâ€œ24 ç‚¹â€ï¼Œç©æ³•å°±æ˜¯ç»™å‡ºä»»æ„ 4 ä¸ªæ•´æ•°ï¼Œé€šè¿‡æ•´æ•°è¿ç®—å¾—åˆ° 24ï¼Œæ¯”å¦‚ç°åœ¨ç»™å‡º 2ã€9ã€1ã€5 å››ä¸ªæ•°ï¼Œç­”æ¡ˆæ˜¯ï¼ˆ5-2ï¼‰*ï¼ˆ9-1ï¼‰= 24ã€‚å½“ç„¶ï¼Œæœ¬å¤„ä»…æ˜¯ä¸¾ä¾‹ï¼Œâ€œ24 ç‚¹â€æ¸¸æˆçš„ç­”æ¡ˆç©ºé—´éå¸¸å°ï¼Œ\bæ˜¯è¿œè¿œä¸å¤Ÿç”Ÿæˆä¿¡å°çš„ã€‚ ç­”æ¡ˆéå¸¸å¥½éªŒè¯ï¼Œä½†æ˜¯è®¡ç®—è¿‡ç¨‹æ˜¯ä¸€ä¸ªå°è¯•çš„è¿‡ç¨‹ï¼Œéœ€è¦è€—è´¹å¤§é‡çš„ç²¾åŠ›ã€‚è€Œåœ¨çœŸå®çš„æ¯”ç‰¹å¸ä¸­ï¼Œé‡‡ç”¨çš„æ˜¯å¯»æ‰¾ç¬¦åˆæ¡ä»¶çš„ç›®æ ‡å“ˆå¸Œï¼Œè¿™ä¹Ÿå°±æ˜¯æ¯”ç‰¹å¸çŸ¿å·¥æ‰€åšçš„äº‹æƒ…ã€‚ å¥½äº†ï¼Œè¿™æ—¶å€™å¤§å®¶å¼€å§‹è®¡ç®—ç»™å‡ºçš„éš¾é¢˜ï¼Œåˆšå¥½æå››ç¬¬ä¸€ä¸ªè®¡ç®—å‡ºæ¥ï¼Œé‚£ä¹ˆè¿™æ¬¡è£…ä¿¡å°çš„æ“ä½œå°±ç”±æå››å®Œæˆï¼Œæå››æŠŠ 10 ä»½ Transaction è£…åˆ°ä¿¡å°ä¸­ï¼Œä¹Ÿå°±æ˜¯æ‰“åŒ… Transactionï¼Œå¹¶ä¸”è¦åœ¨ä¿¡å°èƒŒé¢å†™ä¸Šä¸€ä¸ªä¿¡å°çš„\bæ‘˜è¦ä¿¡æ¯ã€‚ æ¯”å¦‚ä¸Šä¸€ä¸ªä¿¡å°ä¸­çš„ç¬¬ä¸€ä¸ªäº¤æ˜“æ˜¯ä»€ä¹ˆã€ä¿¡å°å°é¢é•¿ä»€ä¹ˆæ ·ï¼Œæœ€åè¦åœ¨ä¿¡å°ä¸Šç›–ä¸Šç« ï¼Œä¹Ÿå°±æ˜¯â€œç­¾åâ€ï¼ŒçŸ¿å·¥ç­¾åçš„ç›®çš„æ˜¯ä¸ºäº†é¢†å¸ï¼Œä¹Ÿå°±æ˜¯ Coinbase äº¤æ˜“ã€‚ ä»¥ä¸Šè¿‡ç¨‹åœ¨åŒºå—é“¾é¢†åŸŸç§°ä½œâ€œæ‰“åŒ… Transactionâ€ï¼Œä¹Ÿå°±æ˜¯å¤§åé¼é¼çš„â€œæŒ–çŸ¿â€ã€‚ 5. å¹¿æ’­äº¤æ˜“æ¥è¯´è¯´ä¸Šæ–‡æåˆ°çš„å¹¿æ’­äº¤æ˜“ï¼Œå¹¿æ’­æ˜¯ä¸ºäº†è®©å…¨æ‘äººçŸ¥é“å½“å‰æ—¶åˆ»ä½ äº§ç”Ÿäº†ä¸€ç¬” Transactionï¼Œæˆ–è€…æ˜¯ä½ è£…å¥½äº†ä¸€ä¸ªä¿¡å°ã€‚ å¹¿æ’­çš„å†…å®¹åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯å¹¿æ’­ Transactionï¼Œä¸€ç§æ˜¯å¹¿æ’­ä¿¡å°ã€‚ç¬¬ä¸€ç§å¹¿æ’­æ˜¯æ„å‘³ç€è¿˜æœ‰æœªè¢«æ‰“åŒ…çš„ Transactionï¼Œè€Œç¬¬äºŒç§å¹¿æ’­ä¿¡å°åˆ™æ„å‘³ç€è¿™ä¸ª Transaction å·²ç»è¢«æŸä¸ªçŸ¿å·¥ç¡®è®¤ã€‚ æ”¶åˆ°äº†å¹¿æ’­çš„é€šçŸ¥åï¼Œå¤§å®¶å…ˆéªŒè¯ä¿¡å°ä¸Šéš¾é¢˜çš„ç­”æ¡ˆæ˜¯å¦æ­£ç¡®ï¼Œè¿™æ ·ä¾¿å¯ä»¥éªŒè¯å‡ºä¿¡å°æ˜¯å¦è¢«ä¼ªé€ ï¼Œæ¥ç€éªŒé‡Œé¢çš„æ¯ç¬”äº¤æ˜“ï¼Œæœ€åè¿˜è¦éªŒè¯ä¿¡å°èƒŒé¢çš„å†…å®¹ï¼Œå³ä¸Šä¸€ä¸ªä¿¡å°çš„æ‘˜è¦æ˜¯å¦æ­£ç¡®ã€‚å› ä¸ºä¸Šä¸€ä¸ªä¿¡å°å¤§å®¶éƒ½å·²ç»ç¡®è®¤ï¼Œæ‰€ä»¥è¿™æ ·å¯ä»¥æå¤§åœ°è§„é¿ä½œå¼Šçš„å¯èƒ½ã€‚å¦‚æœè§‰å¾—æ²¡é—®é¢˜ï¼Œå°±å¯ä»¥å­˜å…¥æœ¬åœ°æ•°æ®åº“ä¸­äº†ã€‚ \bè‡³æ­¤ï¼Œå…¨æ‘äººçš„è®°è´¦é—®é¢˜å°±å·®ä¸å¤šè§£å†³å•¦ã€‚","categories":[{"name":"å‰æ²¿æŠ€æœ¯","slug":"å‰æ²¿æŠ€æœ¯","permalink":"https://sensitivemix.github.io/categories/å‰æ²¿æŠ€æœ¯/"}],"tags":[{"name":"Blockchain","slug":"Blockchain","permalink":"https://sensitivemix.github.io/tags/Blockchain/"}]},{"title":"åŒºå—é“¾ç®€ä»‹","slug":"åŒºå—é“¾ç®€ä»‹","date":"2018-03-09T07:15:57.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/03/09/åŒºå—é“¾ç®€ä»‹/","link":"","permalink":"https://sensitivemix.github.io/2018/03/09/åŒºå—é“¾ç®€ä»‹/","excerpt":"","text":"æ¦‚å†µä»»ä½•äº‹ç‰©çš„å‘å±•ï¼Œä»æ¥ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ã€‚ å•†è´¸åˆä½œä¸­ç­¾è®¢çš„åˆåŒï¼Œæ€ä¹ˆç¡®ä¿å¯¹æ–¹èƒ½éµå®ˆå’Œæ‰§è¡Œï¼Ÿ é¤å…å®£ç§°åˆšä»æµ·é‡Œæ‰“æä¸Šæ¥çš„ä¸‰æ–‡é±¼ï¼Œæ€ä¹ˆè¯æ˜æ•ææ—¶é—´å’Œè¿è¾“ä¸­çš„å«ç”Ÿï¼Ÿ æ•°å­—ä¸–ç•Œé‡Œï¼Œæ€ä¹ˆè¯æ˜ä½ å¯¹èµ„äº§çš„æ‰€æœ‰ï¼Ÿ è¿™äº›çœ‹ä¼¼å¾ˆéš¾è§£å†³çš„é—®é¢˜ï¼Œåœ¨åŒºå—é“¾çš„ä¸–ç•Œé‡Œå·²ç»æœ‰äº†åˆæ­¥çš„ç­”æ¡ˆã€‚ ä»æ•°å­—è´§å¸è¯´èµ·è´§å¸æ˜¯äººç±»æ–‡æ˜å‘å±•è¿‡ç¨‹ä¸­çš„ä¸€å¤§å‘æ˜ï¼Œæœ€é‡è¦çš„èŒèƒ½åŒ…æ‹¬ä»·å€¼å°ºåº¦ã€æµé€šæ‰‹æ®µã€è´®è—æ‰‹æ®µã€‚å¾ˆéš¾æƒ³è±¡ç¦»å¼€äº†è´§å¸ï¼Œç°ä»£ç¤¾ä¼šåºå¤§è€Œå¤æ‚çš„ç»æµå’Œé‡‘èä½“ç³»è¿˜èƒ½å¦æŒç»­è¿è½¬ã€‚ å†å²ä¸Šï¼Œè´§å¸çš„å½¢æ€ç»å†äº†å¤šä¸ªé˜¶æ®µçš„æ¼”åŒ–ï¼ŒåŒ…æ‹¬å®ç‰©è´§å¸ã€é‡‘å±è´§å¸ã€ä»£ç”¨è´§å¸ã€ä¿¡ç”¨è´§å¸ã€ç”µå­è´§å¸ã€æ•°å­—è´§å¸ç­‰ã€‚è´§å¸è‡ªèº«çš„ä»·å€¼ä¾æ‰˜ä¹Ÿä»å®ç‰©ä»·å€¼ã€å‘è¡Œæ–¹ä¿¡ç”¨ä»·å€¼ï¼Œåˆ°ä»Šå¤©å‡ºç°çš„å¯¹ä¿¡æ¯ç³»ç»Ÿï¼ˆåŒ…æ‹¬ç®—æ³•ã€æ•°å­¦ã€å¯†ç å­¦ã€è½¯ä»¶ç­‰ï¼‰çš„ä¿¡ä»»ä»·å€¼ã€‚ éœ€æ±‚ä¸€èˆ¬ç­‰ä»·ç‰©éƒ½å¯ä»¥ä½œä¸ºè´§å¸ä½¿ç”¨ã€‚ç„¶è€Œå¹³æ—¶æœ€å¸¸è§çš„è¿˜æ˜¯çº¸å¸æœ¬ä½åˆ¶ï¼Œæ—¢æ–¹ä¾¿æºå¸¦ã€ä¸æ˜“ä»¿åˆ¶ã€åˆç›¸å¯¹å®¹æ˜“è¾©ä¼ªã€‚ æ³¨æ„ï¼Œä¸¥æ ¼æ¥è®²ï¼Œè´§å¸ï¼ˆmoneyï¼‰ä¸ç­‰äºç°é‡‘æˆ–é€šè´§ï¼ˆcashï¼Œcurrencyï¼‰ï¼Œè´§å¸çš„èŒƒå›´æ›´å¹¿ã€‚ æˆ–è®¸æœ‰äººè®¤ä¸ºä¿¡ç”¨å¡ç›¸å¯¹çº¸å¸å½¢å¼æ›´æ–¹ä¾¿ã€‚ç›¸å¯¹äºä¿¡ç”¨å¡è¿™æ ·çš„é›†ä¸­å¼æ”¯ä»˜ä½“ç³»æ¥è¯´ï¼Œè´§å¸æä¾›äº†æ›´å¥½çš„åŒ¿åæ€§ã€‚å¦å¤–ï¼Œä¸€æ—¦ç¢°åˆ°ç³»ç»Ÿæ•…éšœã€æ–­ç½‘ã€æ²¡æœ‰åˆ·å¡æœºå™¨ç­‰æƒ…å†µï¼Œä¿¡ç”¨å¡å°±ä¸å¯ç”¨äº†ã€‚ æ— è®ºæ˜¯è´§å¸ï¼Œè¿˜æ˜¯ä¿¡ç”¨å¡æ¨¡å¼ï¼Œéƒ½éœ€è¦é¢å¤–çš„ç³»ç»Ÿï¼ˆä¾‹å¦‚é“¶è¡Œï¼‰æ¥å®Œæˆç”Ÿäº§ã€åˆ†å‘ã€ç®¡ç†ç­‰æ“ä½œï¼Œå¸¦æ¥å¾ˆå¤§çš„é¢å¤–æˆæœ¬å’Œä½¿ç”¨é£é™©ã€‚è¯¸å¦‚ä¼ªé€ ã€ä¿¡ç”¨å¡è¯ˆéª—ã€ç›—åˆ·ã€è½¬è´¦ç­‰å®‰å…¨äº‹ä»¶å±¡è§ä¸é²œã€‚ å¾ˆè‡ªç„¶çš„ï¼Œå¦‚æœèƒ½å®ç°ä¸€ç§æ•°å­—è´§å¸ï¼Œä¿æŒæ—¢æœ‰è´§å¸çš„è¿™äº›ç‰¹æ€§ï¼Œæ¶ˆé™¤çº¸è´¨è´§å¸çš„ç¼ºé™·ï¼Œæ— ç–‘å°†å¸¦æ¥å·¨å¤§çš„ç¤¾ä¼šå˜é©ï¼Œæå¤§æé«˜ç»æµæ´»åŠ¨çš„è¿ä½œæ•ˆç‡ã€‚ æ•°å­—è´§å¸ç›¸æ¯”äºä¼ ç»Ÿè´§å¸è®©æˆ‘ä»¬æ¥å¯¹æ¯”ç°åœ¨çš„æ•°å­—è´§å¸å’Œç°å®ç”Ÿæ´»ä¸­çš„çº¸å¸ï¼š å±æ€§ åˆ†æ èƒœå‡ºæ–¹ ä¾¿æº è¿™ç‚¹ä¸Šåº”è¯¥æ²¡æœ‰äº‰è®®ï¼Œæ˜¾ç„¶æ•°å­—å½¢å¼çš„è´§å¸èƒœå‡ºã€‚ æ•°å­—è´§å¸ é˜²ä¼ª è¿™ç‚¹ä¸Šåº”è¯¥è¯´ä¸¤è€…å„æœ‰åƒç§‹ï¼Œä½†æ•°å­—è´§å¸å¯èƒ½ç•¥èƒœä¸€ç­¹ã€‚çº¸å¸ä¾é çš„æ˜¯å„ç§è®¾è®¡ï¼ˆçº¸å¼ ã€æ²¹å¢¨ã€æš—çº¹ã€å¤¹å±‚ç­‰ï¼‰ä¸Šçš„ç²¾å·§ï¼Œæ•°å­—è´§å¸ä¾é çš„åˆ™æ˜¯å¯†ç å­¦ä¸Šçš„ä¿éšœã€‚äº‹å®ä¸Šï¼Œçº¸å¸çš„ä¼ªé€ æ—¶æœ‰å‘ç”Ÿï¼Œä½†æ•°å­—è´§å¸çš„ä¼ªé€ æ˜é¢ä¸Šè¿˜æ²¡èƒ½å®ç°ã€‚ æ•°å­—è´§å¸ è¾©ä¼ª çº¸å¸å³ä½¿ä¾æ‰˜éªŒé’æœºä»ä¼šæœ‰è¯¯åˆ¤æƒ…å†µï¼Œæ•°å­—è´§å¸ä¾é å¯†ç å­¦åŸºæœ¬ä¸å¯èƒ½å‡ºé”™ã€‚æ•°å­—è´§å¸èƒœå‡ºã€‚ æ•°å­—è´§å¸ åŒ¿å é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸¤è€…éƒ½èƒ½æä¾›å¾ˆå¥½çš„åŒ¿åæ€§ã€‚ä½†éƒ½æ— æ³•é˜²å¾¡æœ‰æ„çš„è¿½è¸ªã€‚ å¹³å±€ äº¤æ˜“ å¯¹çº¸å¸æ¥è¯´ï¼Œè°æŒæœ‰çº¸å¸è°å°±æ˜¯åˆæ³•æ‹¥æœ‰è€…ï¼Œäº¤æ˜“é€šè¿‡çº¸å¸è‡ªèº«çš„è½¬ç§»å³å¯å®Œæˆã€‚å¯¹æ•°å­—è´§å¸æ¥è¯´åˆ™å¤æ‚çš„å¤šï¼Œå› ä¸ºä»»ä½•æ•°å­—ç‰©å“éƒ½æ˜¯å¯ä»¥è¢«å¤åˆ¶çš„ï¼Œå› æ­¤éœ€è¦é¢å¤–çš„æœºåˆ¶ã€‚ä¸ºæ­¤ï¼Œæ¯”ç‰¹å¸å‘æ˜äº†åŒºå—é“¾æŠ€æœ¯æ¥ç¡®ä¿å¯é ä¸å¯ç¯¡æ”¹çš„äº¤æ˜“ã€‚ çº¸å¸ èµ„æº 100 ç¾å…ƒé’ç¥¨çš„ç”Ÿäº§æˆæœ¬æ˜¯ 0.1 ç¾å…ƒå·¦å³ã€‚100 é¢é¢äººæ°‘å¸çš„ç”Ÿäº§æˆæœ¬è¯´æ³•ä¼—å¤šï¼Œä½†ä¼°è®¡åº”è¯¥åœ¨å‡ æ¯›åˆ°å‡ å—èŒƒå›´å†…ã€‚æ•°å­—è´§å¸æ¶ˆè€—çš„èµ„æºåˆ™å¤æ‚çš„å¤šï¼Œä»¥æœ€åæƒ…å†µä¼°è®¡ï¼Œç®—å‡ºæ¥å¤šå°‘å°±è¦æ¶ˆè€—å¤šå°‘ç”µï¼ˆå¾€å¾€è¦æ›´å¤šï¼‰ã€‚ çº¸å¸ å‘è¡Œ çº¸å¸çš„å‘è¡Œéœ€è¦ç¬¬ä¸‰æ–¹æœºæ„çš„å‚ä¸ï¼Œæ•°å­—è´§å¸åˆ™é€šè¿‡åˆ†å¸ƒå¼ç®—æ³•æ¥å®Œæˆå‘è¡Œã€‚åœ¨äººç±»å†å²ä¸Šï¼Œé€šèƒ€å’Œé€šç¼©å¾€å¾€æ˜¯ä¸åˆç†åœ°å‘è¡Œè´§å¸é€ æˆçš„ï¼›æ•°å­—è´§å¸å°šæ— æœºä¼šè¢«éªŒè¯ï¼Œåœ¨è¿™æ–¹é¢çš„è¡¨ç°è¿˜æœ‰å¾…è§‚å¯Ÿã€‚ å¹³å±€ å¯è§ï¼Œæ•°å­—è´§å¸å¹¶éåœ¨æ‰€æœ‰é¢†åŸŸéƒ½ä¼˜äºå·²æœ‰çš„è´§å¸å½¢å¼ã€‚ä¸å¸¦å‰æçš„åœ¨æ‰€æœ‰é¢†åŸŸéƒ½é¼“å¹æ•°å­—è´§å¸å¹¶ä¸æ˜¯ä¸€ç§ä¸¥è°¨çš„æ€åº¦ï¼Œåº”è¯¥é’ˆå¯¹å…·ä½“æƒ…å†µå…·ä½“åˆ†æã€‚å®é™…ä¸Šï¼Œä»”ç»†è§‚å¯Ÿç›®å‰æ”¯æŒæ•°å­—è´§å¸çš„äº¤æ˜“æœºæ„å°±ä¼šå‘ç°ç«¯å€ªï¼Œå½“å‰è¿˜æ²¡æœ‰ä¸€ç§æ•°å­—è´§å¸èƒ½å®Œæ•´èµ·åˆ°è´§å¸çš„èŒèƒ½ã€‚ æœ€åï¼Œè™½ç„¶å½“å‰çš„æ•°å­—è´§å¸â€œå®éªŒâ€å·²ç»å–å¾—äº†å·¨å¤§æˆåŠŸï¼Œä½†å¯è§çš„å±€é™ä¹Ÿå¾ˆæ˜æ˜¾ï¼šå…¶ä¾èµ–çš„åˆ†å¸ƒå¼è´¦æœ¬æŠ€æœ¯è¿˜ç¼ºä¹å¤§è§„æ¨¡åœºæ™¯ä¸‹è€ƒéªŒï¼›æ€§èƒ½å’Œå®‰å…¨æ€§è¿˜æœ‰å¾…æå‡ï¼›èµ„æºçš„æ¶ˆè€—è¿˜è¿‡é«˜ç­‰ç­‰ã€‚è¿™äº›é—®é¢˜è¿˜æœ‰å¾…äºç›¸å…³æŠ€æœ¯çš„è¿›ä¸€æ­¥å‘å±•ã€‚ å®ç°æŒ‘æˆ˜è®¾è®¡å’Œå®ç°ä¸€ä¸ªæ•°å­—è´§å¸å¹¶éæ˜“äº‹ã€‚ åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œå› ä¸ºçº¸å¸å…·å¤‡å¯è½¬ç§»æ€§ï¼Œç›¸å¯¹å®¹æ˜“åœ°å®Œæˆä»·å€¼çš„äº¤å‰²ã€‚ä½†æ˜¯å› ä¸ºç”µå­å†…å®¹å¤©ç„¶å…·å¤‡é›¶å¤åˆ¶æˆæœ¬ï¼Œæ— æ³•é€šè¿‡å‘é€ç”µå­å†…å®¹æ¥å®Œæˆä»·å€¼çš„è½¬ç§»ã€‚æŒæœ‰äººå¯ä»¥è¯•å›¾å°†åŒä¸€ä»½ç”µå­è´§å¸å‘ç»™å¤šä¸ªäººï¼Œè¿™ç§è¢«ç§°ä¸ºâ€œåŒé‡æ”¯ä»˜æ”»å‡»ï¼ˆDouble-Spentï¼‰â€ã€‚ ä¹Ÿè®¸æœ‰äººä¼šè®²ï¼Œå½“å‰é“¶è¡Œä¸­çš„è´§å¸éƒ½æ˜¯ç”µå­åŒ–çš„ï¼Œå› ä¸ºé€šè¿‡è´¦å·é‡Œé¢çš„æ•°å­—è®°å½•äº†èµ„äº§ã€‚è¯´çš„æ²¡é”™ï¼Œè¿™ç§ç”µå­è´§å¸æ¨¡å¼æœ‰äººç§°ä¸ºâ€œæ•°å­—è´§å¸ 1.0â€ï¼Œå®ƒå®é™…ä¸Šæ˜¯å‡å®šå­˜åœ¨ä¸€ä¸ªå®‰å…¨å¯é çš„ç¬¬ä¸‰æ–¹è®°è´¦æœºæ„æ¥å®ç°ï¼Œè¿™ä¸ªæœºæ„åˆ©ç”¨ä¿¡ç”¨ä½œä¸ºæŠµæŠ¼ï¼Œæ¥å®Œæˆäº¤æ˜“ã€‚ è¿™ç§ä¸­å¿ƒåŒ–æ§åˆ¶ä¸‹çš„æ•°å­—è´§å¸å®ç°ç›¸å¯¹ç®€å•ï¼Œä½†éœ€è¦ä¸€ä¸ªä¸­å¿ƒç®¡æ§ç³»ç»Ÿã€‚ä½†æ˜¯ï¼Œå¾ˆå¤šæ—¶å€™å¹¶ä¸å­˜åœ¨ä¸€ä¸ªå®‰å…¨å¯é çš„ç¬¬ä¸‰æ–¹è®°è´¦æœºæ„æ¥å……å½“è¿™ä¸ªä¸­å¿ƒç®¡æ§çš„è§’è‰²ã€‚ ä¾‹å¦‚ï¼Œè´¸æ˜“ä¸¤å›½å¯èƒ½ç¼ºä¹è¶³å¤Ÿçš„å¤–æ±‡å‚¨å¤‡ï¼›ç½‘ç»œä¸Šçš„åŒ¿ååŒæ–¹è¿›è¡Œç›´æ¥ä¹°å–ï¼›äº¤æ˜“çš„ä¸¤ä¸ªæœºæ„å½¼æ­¤äº’ä¸ä¿¡ä»»ï¼Œæ‰¾ä¸åˆ°åŒæ–¹éƒ½è®¤å¯çš„ç¬¬ä¸‰æ–¹æ‹…ä¿ï¼›æ±‡ç‡çš„å˜åŒ–ï¼›å¯èƒ½æ— æ³•è¿æ¥åˆ°ç¬¬ä¸‰æ–¹çš„ç³»ç»Ÿï¼›ç¬¬ä¸‰æ–¹çš„ç³»ç»Ÿå¯èƒ½ä¼šå‡ºç°æ•…éšœâ€¦â€¦ æ€»ç»“ä¸€ä¸‹ï¼Œåœ¨å»ä¸­å¿ƒåŒ–çš„åœºæ™¯ä¸‹ï¼Œå­˜åœ¨å‡ ä¸ªéš¾é¢˜ï¼š è´§å¸çš„é˜²ä¼ªï¼šè°æ¥è´Ÿè´£éªŒè¯è´§å¸ï¼› è´§å¸äº¤æ˜“ï¼šå¦‚ä½•ç¡®å®šè´§å¸ä»ä¸€æ–¹è½¬ç§»åˆ°å¦å¤–ä¸€æ–¹ï¼› é¿å…åŒé‡æ”¯ä»˜ï¼šå¦‚ä½•é¿å…å‡ºç°åŒé‡æ”¯ä»˜ã€‚ å¥½å§ï¼Œè¿™äº‹å…¶å®ä¸å¤ªå®¹æ˜“ã€‚ æ¯”ç‰¹å¸å‡ºç°åœ¨ä¸å­˜åœ¨ä¸€ä¸ªç¬¬ä¸‰æ–¹è®°è´¦æœºæ„çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•å®ç°ä¸€ä¸ªæ•°å­—è´§å¸ç³»ç»Ÿå‘¢ï¼Ÿ è¿‘ä¸‰åå¹´æ¥ï¼Œæ•°å­—è´§å¸æŠ€æœ¯æœç€è¿™ä¸ªæ–¹å‘åŠªåŠ›ï¼Œç»å†äº†å‡ ä»£æ¼”è¿›ï¼ŒåŒ…æ‹¬ e-Cashã€HashCashã€B-moneyç­‰ã€‚ 1983 å¹´ï¼ŒDavid Chaum æœ€æ—©æå‡ºecashï¼Œå¹¶äº 1989 å¹´åˆ›å»ºäº† Digicash å…¬å¸ã€‚ecash ç³»ç»Ÿæ˜¯é¦–ä¸ªåŒ¿ååŒ–çš„æ•°å­—åŠ å¯†è´§å¸ï¼ˆanonymous cryptographic electronic money, or electronic cash systemï¼‰ï¼ŒåŸºäº David Chaum å‘æ˜çš„ç›²ç­¾åæŠ€æœ¯ï¼Œæ›¾è¢«åº”ç”¨äºé“¶è¡Œå°é¢æ”¯ä»˜ä¸­ã€‚ecash ä¾èµ–äºä¸€ä¸ªä¸­å¿ƒåŒ–çš„ä¸­ä»‹æœºæ„ï¼Œå¯¼è‡´å®ƒæœ€ç»ˆå¤±è´¥ã€‚ 1997 å¹´ï¼ŒAdam Back å‘æ˜äº† Hashcashï¼Œæ¥è§£å†³é‚®ä»¶ç³»ç»Ÿä¸­ DoS æ”»å‡»é—®é¢˜ã€‚Hashcash é¦–æ¬¡æå‡ºç”¨å·¥ä½œé‡è¯æ˜ï¼ˆProof of Workï¼ŒPoWï¼‰æœºåˆ¶æ¥è·å–é¢åº¦ï¼Œè¯¥æœºåˆ¶åæ¥è¢«åç»­æ•°å­—è´§å¸æŠ€æœ¯æ‰€é‡‡ç”¨ã€‚ 1998 å¹´ï¼ŒWei Dai æå‡ºäº† B-moneyï¼Œå°† PoW å¼•å…¥æ•°å­—è´§å¸ç”Ÿæˆè¿‡ç¨‹ä¸­ã€‚B-money åŒæ—¶æ˜¯é¦–ä¸ªé¢å‘å»ä¸­å¿ƒåŒ–è®¾è®¡çš„æ•°å­—è´§å¸ã€‚ä»æ¦‚å¿µä¸Šçœ‹å·²ç»æ¯”è¾ƒå®Œå–„ï¼Œä½†æ˜¯å¾ˆé—æ†¾çš„æ˜¯ï¼Œå…¶æœªèƒ½æå‡ºå…·ä½“çš„è®¾è®¡å®ç°ã€‚ ä¸Šé¢è¿™äº›æ•°å­—è´§å¸éƒ½æˆ–å¤šæˆ–å°‘çš„ä¾èµ–äºä¸€ä¸ªç¬¬ä¸‰æ–¹ç³»ç»Ÿçš„ä¿¡ç”¨æ‹…ä¿ã€‚ç›´åˆ°æ¯”ç‰¹å¸çš„å‡ºç°ï¼Œå°† PoW ä¸å…±è¯†æœºåˆ¶ç»“åˆåœ¨ä¸€èµ·ï¼Œé¦–æ¬¡ä»å®è·µæ„ä¹‰ä¸Šå®ç°äº†ä¸€å¥—å»ä¸­å¿ƒåŒ–çš„æ•°å­—è´§å¸ç³»ç»Ÿã€‚ æ¯”ç‰¹å¸ç½‘ç»œæ— éœ€ä»»ä½•ç®¡ç†æœºæ„ï¼Œè‡ªèº«é€šè¿‡æ•°å­¦å’Œå¯†ç å­¦åŸç†æ¥ç¡®ä¿äº†æ‰€æœ‰äº¤æ˜“çš„æˆåŠŸè¿›è¡Œï¼Œæ¯”ç‰¹å¸è‡ªèº«çš„ä»·å€¼æ˜¯é€šè¿‡èƒŒåçš„è®¡ç®—åŠ›ä¸ºèƒŒä¹¦ã€‚è¿™ä¹Ÿä¿ƒä½¿äººä»¬å¼€å§‹æ€è€ƒåœ¨æœªæ¥çš„æ•°å­—ä¸–ç•Œä¸­ï¼Œè¯¥å¦‚ä½•è¡¡é‡ä»·å€¼ï¼Œå¦‚ä½•å‘è¡Œè´§å¸ã€‚ ç›®å‰çœ‹æ¥ï¼Œæ•°å­—è´§å¸æ¯”è¾ƒæœ‰å½±å“åŠ›çš„æ¨¡å¼æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ç±»ä¼¼ paypal è¿™æ ·çš„é€‰æ‹©è·Ÿå·²æœ‰çš„ç³»ç»Ÿåˆä½œï¼Œæˆä¸ºä»£ç†ï¼›ä¸€ç§æ˜¯ä»¥æ¯”ç‰¹å¸è¿™æ ·çš„å®Œå…¨ä¸¢å¼ƒå·²æœ‰ä½“ç³»çš„åˆ†å¸ƒå¼æŠ€æœ¯ã€‚ ç°åœ¨è¿˜å¾ˆéš¾è®²å“ªç§æ¨¡å¼å°†æˆä¸ºæœªæ¥çš„ä¸»æµï¼Œç”šè‡³æœªæ¥è¿˜å¯èƒ½å‡ºç°æ›´å…ˆè¿›çš„æŠ€æœ¯ã€‚ä½†å¯¹æ¯”ç‰¹å¸è¿™ä¸€ç±»æ•°å­—è´§å¸çš„è®¾è®¡è¿›è¡Œæ¢ç´¢ï¼Œå°†æ˜¯ä¸€ä»¶ååˆ†æœ‰è¶£çš„äº‹æƒ…ã€‚ ä»€ä¹ˆæ˜¯åŒºå—é“¾å®šä¹‰åŒºå—é“¾ï¼ˆBlockchainï¼‰æŠ€æœ¯è‡ªèº«ä»ç„¶åœ¨é£é€Ÿå‘å±•ä¸­ï¼Œç›®å‰è¿˜ç¼ºä¹ç»Ÿä¸€çš„è§„èŒƒå’Œæ ‡å‡†ã€‚ wikipedia ç»™å‡ºçš„å®šä¹‰ä¸ºï¼š A blockchain â€”originally, block chain â€”is a distributed database that maintains a continuously-growing list of data records hardened against tampering and revision. It consists of data structure blocksâ€”which hold exclusively data in initial blockchain implementations, and both data and programs in some of the more recent implementationsâ€”with each block holding batches of individual transactions and the results of any blockchain executables. Each block contains a timestamp and information linking it to a previous block. æœ€æ—©åŒºå—é“¾æŠ€æœ¯é›å½¢å‡ºç°åœ¨æ¯”ç‰¹å¸é¡¹ç›®ä¸­ã€‚ä½œä¸ºæ¯”ç‰¹å¸èƒŒåçš„åˆ†å¸ƒå¼è®°è´¦å¹³å°ï¼Œåœ¨æ— é›†ä¸­å¼ç®¡ç†çš„æƒ…å†µä¸‹ï¼Œæ¯”ç‰¹å¸ç½‘ç»œç¨³å®šè¿è¡Œäº†è¿‘å…«å¹´æ—¶é—´ï¼Œæ”¯æŒäº†æµ·é‡çš„äº¤æ˜“è®°å½•ï¼Œå¹¶æœªå‡ºç°ä¸¥é‡çš„æ¼æ´ã€‚ æ³¨ï¼šæ¯”ç‰¹å¸å†å²ä¸Šå”¯ä¸€å·²çŸ¥çš„æ¼æ´äº‹ä»¶æ›¾å¯¼è‡´æ¯”ç‰¹å¸çš„æ¶æ„å¢å‘ï¼Œä½†é—®é¢˜å¾ˆå¿«è¢«å‘ç°å¹¶ä¿®æ­£ï¼Œç›¸å…³éæ³•äº¤æ˜“è¢«æ’¤é”€ã€‚ å…¬è®¤çš„æœ€æ—©å…³äºåŒºå—é“¾çš„æè¿°æ€§æ–‡çŒ®æ˜¯ä¸­æœ¬èªæ‰€æ’°å†™çš„ æ¯”ç‰¹å¸ï¼šä¸€ç§ç‚¹å¯¹ç‚¹çš„ç”µå­ç°é‡‘ç³»ç»Ÿï¼Œä½†è¯¥æ–‡çŒ®é‡ç‚¹åœ¨äºè®¨è®ºæ¯”ç‰¹å¸ç³»ç»Ÿï¼Œå®é™…ä¸Šå¹¶æ²¡æœ‰æ˜ç¡®æå‡ºåŒºå—é“¾çš„å®šä¹‰å’Œæ¦‚å¿µã€‚åœ¨å…¶ä¸­ï¼ŒåŒºå—é“¾è¢«æè¿°ä¸ºç”¨äºè®°å½•æ¯”ç‰¹å¸äº¤æ˜“çš„è´¦ç›®å†å²ã€‚ å›¾ 1.4.3.1 - å¤è€çš„è´¦æœ¬ è®°è´¦æŠ€æœ¯å†å²æ‚ ä¹…ï¼Œç°ä»£å¤å¼è®°è´¦ç³»ç»Ÿï¼ˆDouble Entry Bookkeepingï¼‰æ˜¯ç”±æ„å¤§åˆ©æ•°å­¦å®¶å¢å¡Â·å¸•è¥¿å¥¥åˆ©ï¼Œ1494 å¹´åœ¨ã€ŠSumma de arithmetica, geometrica, proportioni et proportionalitÃ ã€‹ä¸€ä¹¦ä¸­æœ€æ—©åˆ¶å®šã€‚å¤å¼è®°è´¦æ³•å¯¹æ¯ä¸€ç¬”è´¦ç›®åŒæ—¶è®°å½•æ¥æºå’Œå»å‘ï¼Œé¦–æ¬¡å°†å¯¹è´¦éªŒè¯åŠŸèƒ½å¼•å…¥è®°è´¦è¿‡ç¨‹ï¼Œæå‡äº†è®°è´¦çš„å¯é æ€§ã€‚ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼ŒåŒºå—é“¾æ˜¯é¦–ä¸ªè‡ªå¸¦å¯¹è´¦åŠŸèƒ½çš„æ•°å­—è®°è´¦æŠ€æœ¯å®ç°ã€‚ æ›´å¹¿æ³›æ„ä¹‰åœ°çœ‹ï¼ŒåŒºå—é“¾å±äºä¸€ç§å»ä¸­å¿ƒåŒ–çš„è®°å½•æŠ€æœ¯ã€‚å‚ä¸åˆ°ç³»ç»Ÿä¸Šçš„èŠ‚ç‚¹ï¼Œå¯èƒ½ä¸å±äºåŒä¸€ç»„ç»‡ã€å½¼æ­¤æ— éœ€ä¿¡ä»»ï¼›åŒºå—é“¾æ•°æ®ç”±æ‰€æœ‰èŠ‚ç‚¹å…±åŒç»´æŠ¤ï¼Œæ¯ä¸ªå‚ä¸ç»´æŠ¤èŠ‚ç‚¹éƒ½èƒ½å¤åˆ¶è·å¾—ä¸€ä»½å®Œæ•´è®°å½•çš„æ‹·è´ã€‚ è·Ÿä¼ ç»Ÿçš„è®°è´¦æŠ€æœ¯ç›¸æ¯”ï¼Œå…¶ç‰¹ç‚¹åº”è¯¥åŒ…æ‹¬ï¼š ç»´æŠ¤ä¸€æ¡ä¸æ–­å¢é•¿çš„é“¾ï¼Œåªå¯èƒ½æ·»åŠ è®°å½•ï¼Œè€Œå‘ç”Ÿè¿‡çš„è®°å½•éƒ½ä¸å¯ç¯¡æ”¹ï¼› å»ä¸­å¿ƒåŒ–ï¼Œæˆ–è€…è¯´å¤šä¸­å¿ƒåŒ–ï¼Œæ— éœ€é›†ä¸­çš„æ§åˆ¶è€Œèƒ½è¾¾æˆå…±è¯†ï¼Œå®ç°ä¸Šå°½é‡åˆ†å¸ƒå¼ï¼› é€šè¿‡å¯†ç å­¦çš„æœºåˆ¶æ¥ç¡®ä¿äº¤æ˜“æ— æ³•æŠµèµ–å’Œç ´åï¼Œå¹¶å°½é‡ä¿æŠ¤ç”¨æˆ·ä¿¡æ¯å’Œè®°å½•çš„éšç§æ€§ã€‚ æ›´è¿›ä¸€æ­¥çš„ï¼Œè¿˜å¯ä»¥å°†æ™ºèƒ½åˆçº¦è·ŸåŒºå—é“¾ç»“åˆåˆ°ä¸€èµ·ï¼Œè®©å…¶æä¾›é™¤äº†äº¤æ˜“ï¼ˆæ¯”ç‰¹å¸åŒºå—é“¾å·²ç»æ”¯æŒç®€å•çš„è„šæœ¬è®¡ç®—ï¼‰åŠŸèƒ½å¤–æ›´çµæ´»çš„åˆçº¦åŠŸèƒ½ï¼Œæ‰§è¡Œæ›´ä¸ºå¤æ‚çš„æ“ä½œã€‚è¿™æ ·æ‰©å±•ä¹‹åçš„åŒºå—é“¾ï¼Œå·²ç»è¶…è¶Šäº†å•çº¯æ•°æ®è®°å½•çš„åŠŸèƒ½äº†ï¼Œå®é™…ä¸Šå¸¦æœ‰ç‚¹â€œæ™®é€‚è®¡ç®—â€çš„æ„å‘³äº†ã€‚ åŸºæœ¬åŸç†åŒºå—é“¾çš„åŸºæœ¬åŸç†ç†è§£èµ·æ¥å¹¶ä¸éš¾ã€‚åŸºæœ¬æ¦‚å¿µåŒ…æ‹¬ï¼š äº¤æ˜“ï¼ˆTransactionï¼‰ï¼šä¸€æ¬¡æ“ä½œï¼Œå¯¼è‡´è´¦æœ¬çŠ¶æ€çš„ä¸€æ¬¡æ”¹å˜ï¼Œå¦‚æ·»åŠ ä¸€æ¡è®°å½•ï¼› åŒºå—ï¼ˆBlockï¼‰ï¼šè®°å½•ä¸€æ®µæ—¶é—´å†…å‘ç”Ÿçš„äº¤æ˜“å’ŒçŠ¶æ€ç»“æœï¼Œæ˜¯å¯¹å½“å‰è´¦æœ¬çŠ¶æ€çš„ä¸€æ¬¡å…±è¯†ï¼› é“¾ï¼ˆChainï¼‰ï¼šç”±ä¸€ä¸ªä¸ªåŒºå—æŒ‰ç…§å‘ç”Ÿé¡ºåºä¸²è”è€Œæˆï¼Œæ˜¯æ•´ä¸ªçŠ¶æ€å˜åŒ–çš„æ—¥å¿—è®°å½•ã€‚ å¦‚æœæŠŠåŒºå—é“¾ä½œä¸ºä¸€ä¸ªçŠ¶æ€æœºï¼Œåˆ™æ¯æ¬¡äº¤æ˜“å°±æ˜¯è¯•å›¾æ”¹å˜ä¸€æ¬¡çŠ¶æ€ï¼Œè€Œæ¯æ¬¡å…±è¯†ç”Ÿæˆçš„åŒºå—ï¼Œå°±æ˜¯å‚ä¸è€…å¯¹äºåŒºå—ä¸­æ‰€æœ‰äº¤æ˜“å†…å®¹å¯¼è‡´çŠ¶æ€æ”¹å˜çš„ç»“æœè¿›è¡Œç¡®è®¤ã€‚ å›¾ 1.4.3.2 - åŒºå—é“¾ç¤ºä¾‹ åˆ†ç±»æ ¹æ®å‚ä¸è€…çš„ä¸åŒï¼Œå¯ä»¥åˆ†ä¸ºå…¬å¼€ï¼ˆPublicï¼‰é“¾ã€è”ç›Ÿï¼ˆConsortiumï¼‰é“¾å’Œç§æœ‰ï¼ˆPrivateï¼‰é“¾ã€‚ å…¬å¼€é“¾ï¼Œé¡¾åæ€ä¹‰ï¼Œä»»ä½•äººéƒ½å¯ä»¥å‚ä¸ä½¿ç”¨å’Œç»´æŠ¤ï¼Œå…¸å‹çš„å¦‚æ¯”ç‰¹å¸åŒºå—é“¾ï¼Œä¿¡æ¯æ˜¯å®Œå…¨å…¬å¼€çš„ã€‚ å¦‚æœå¼•å…¥è®¸å¯æœºåˆ¶ï¼ŒåŒ…æ‹¬ç§æœ‰é“¾å’Œè”ç›Ÿé“¾ä¸¤ç§ã€‚ ç§æœ‰é“¾ï¼Œåˆ™æ˜¯é›†ä¸­ç®¡ç†è€…è¿›è¡Œé™åˆ¶ï¼Œåªèƒ½å¾—åˆ°å†…éƒ¨å°‘æ•°äººå¯ä»¥ä½¿ç”¨ï¼Œä¿¡æ¯ä¸å…¬å¼€ã€‚ è”ç›Ÿé“¾åˆ™ä»‹äºä¸¤è€…ä¹‹é—´ï¼Œç”±è‹¥å¹²ç»„ç»‡ä¸€èµ·åˆä½œç»´æŠ¤ä¸€æ¡åŒºå—é“¾ï¼Œè¯¥åŒºå—é“¾çš„ä½¿ç”¨å¿…é¡»æ˜¯æœ‰æƒé™çš„ç®¡ç†ï¼Œç›¸å…³ä¿¡æ¯ä¼šå¾—åˆ°ä¿æŠ¤ï¼Œå…¸å‹å¦‚é“¶è”ç»„ç»‡ã€‚ ç›®å‰æ¥çœ‹ï¼Œå…¬å¼€é“¾å°†ä¼šæ›´å¤šçš„å¸å¼•ç¤¾åŒºå’Œåª’ä½“çš„çœ¼çƒï¼Œä½†æ›´å¤šçš„å•†ä¸šä»·å€¼åº”è¯¥åœ¨è”ç›Ÿé“¾å’Œç§æœ‰é“¾ä¸Šã€‚ æ ¹æ®ä½¿ç”¨ç›®çš„å’Œåœºæ™¯çš„ä¸åŒï¼Œåˆå¯ä»¥åˆ†ä¸ºä»¥æ•°å­—è´§å¸ä¸ºç›®çš„çš„è´§å¸é“¾ï¼Œä»¥è®°å½•äº§æƒä¸ºç›®çš„çš„äº§æƒé“¾ï¼Œä»¥ä¼—ç­¹ä¸ºç›®çš„çš„ä¼—ç­¹é“¾ç­‰ã€‚ å°ç»“åŒºå—é“¾æ˜¯ç¬¬ä¸€ä¸ªè¯•å›¾è‡ªå¸¦ä¿¡ä»»åŒ–å’Œé˜²æ­¢ç¯¡æ”¹çš„åˆ†å¸ƒå¼è®°å½•ç³»ç»Ÿã€‚å®ƒçš„å‡ºç°ï¼Œè®©å¤§å®¶æ„è¯†åˆ°ï¼Œé™¤äº†äº’è”ç½‘è¿™æ ·çš„å°½åŠ›è€Œä¸ºçš„åŸºç¡€è®¾æ–½å¤–ï¼Œæˆ‘ä»¬è¿˜èƒ½æ‰“é€ ä¸€ä¸ªå½¼æ­¤ä¿¡ä»»çš„åŸºç¡€è®¾æ–½ã€‚ ç±»ä¼¼æ¯”ç‰¹å¸è¿™æ ·çš„å¤§è§„æ¨¡é•¿æ—¶é—´è‡ªæ²»è¿è¡Œçš„ç³»ç»Ÿï¼Œä¹Ÿä¸ºåŒºå—é“¾æŠ€æœ¯çš„åº”ç”¨å¼€å¯äº†æ›´å¤šéæƒ³çš„ç©ºé—´ã€‚å¦‚æœäººä¸äººä¹‹é—´çš„äº¤æ˜“æ— æ³•ä¼ªé€ ï¼ŒåˆåŒéƒ½èƒ½ç¡®ä¿å¯é æ‰§è¡Œï¼Œä¸–ç•Œæ˜¯ä¸æ˜¯æ›´ç¾å¥½ä¸€äº›äº†å‘¢ï¼Ÿè¿™æ˜¯æŠ€æœ¯è¿›æ­¥å†æ¬¡ç»™äººç±»å‘å±•å¸¦æ¥ç¦åˆ©ã€‚ ä¸æè¿™ç§å»ä¸­å¿ƒåŒ–çš„é‡‘èç³»ç»Ÿæ˜¯å¦èƒ½åœ¨ç°å®ä¸­æ™®åŠï¼Œåœ¨è·¨å›½äº¤æ˜“ã€è·¨ç»„ç»‡åˆä½œæ—¥ç›Šé¢‘ç¹çš„ä»Šå¤©ï¼Œå·²ç»æœ‰äº†ä¸å°‘æœ‰æ„ä¹‰çš„å°è¯•å’Œå‚è€ƒã€‚ æ›´è¿›ä¸€æ­¥ï¼Œæ¯”ç‰¹å¸åªæ˜¯åŸºäºåŒºå—é“¾æŠ€æœ¯çš„ä¸€ç§é‡‘èåº”ç”¨ï¼ˆè€Œä¸”æ˜¯ç›´æ¥åµŒå…¥åŒºå—é“¾ä¸­ï¼‰ï¼ŒåŒºå—é“¾æŠ€æœ¯è¿˜èƒ½å¸¦æ¥æ›´é€šç”¨çš„è®¡ç®—èƒ½åŠ›ã€‚Hyperledger å’Œ Ethereum å°±è¯•å›¾åšç±»ä¼¼çš„äº‹æƒ…ï¼ŒåŸºäºåŒºå—é“¾å†åšä¸€å±‚å¹³å°å±‚ï¼Œè®©åˆ«äººåŸºäºå¹³å°å¼€å‘åº”ç”¨å˜å¾—æ›´ç®€å•ã€‚ å¦å¤–ï¼ŒåŒºå—é“¾æœ¬èº«å¯ä»¥ä½œä¸ºåˆ†å¸ƒå¼å­˜å‚¨ï¼Œä¹Ÿè‡ªç„¶å¯ä»¥ä½œä¸ºåˆ†å¸ƒå¼è®¡ç®—å¼•æ“ã€‚å¯ä»¥æƒ³è±¡ï¼Œæ•´ä¸ªåŠ å…¥é›†ç¾¤çš„è®¾å¤‡éƒ½æ˜¯è®¡ç®—å¼•æ“ï¼Œå¤§å®¶é€šè¿‡ä»˜è´¹æ¥ä½¿ç”¨è®¡ç®—åŠ›ï¼Œæ˜¯ä¸æ˜¯å°±æœ‰ç‚¹æ™®é€‚è®¡ç®—çš„æ„å‘³äº†ï¼Ÿ æœ‰ç†ç”±ç›¸ä¿¡ï¼Œéšç€æ›´å¤šå•†ä¸šåº”ç”¨åœºæ™¯çš„å‡ºç°ï¼ŒåŒºå—é“¾æŠ€æœ¯å°†åœ¨æœªæ¥é‡‘èå’Œä¿¡æ¯æŠ€æœ¯é¢†åŸŸå æ®ä¸€å¸­ä¹‹åœ°ã€‚","categories":[{"name":"å‰æ²¿æŠ€æœ¯","slug":"å‰æ²¿æŠ€æœ¯","permalink":"https://sensitivemix.github.io/categories/å‰æ²¿æŠ€æœ¯/"}],"tags":[{"name":"Blockchain","slug":"Blockchain","permalink":"https://sensitivemix.github.io/tags/Blockchain/"}]},{"title":"Javascript è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µæ€»ç»“","slug":"Javascript-è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µæ€»ç»“","date":"2018-02-26T07:13:59.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2018/02/26/Javascript-è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µæ€»ç»“/","link":"","permalink":"https://sensitivemix.github.io/2018/02/26/Javascript-è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µæ€»ç»“/","excerpt":"","text":"2018.02.04ç¬¬ä¸€ç« ï¼šåŸºç¡€éƒ¨åˆ†1.1 å¤šæ€ç±»å‹è¯­è¨€å’Œé¸­å­è¯­è¨€ é¸­å­ç±»å‹ï¼šèµ°èµ·æ¥åƒé¸­å­ï¼Œå«èµ·æ¥ä¹Ÿåƒé¸­å­ï¼Œé‚£ä¹ˆä»–å°±æ˜¯ä¸€åªé¸­å­ã€‚1.2 å¤šæ€å¤šæ€å«ä¹‰ï¼šåŒä¸€æ“ä½œä½œç”¨äºä¸åŒçš„å¯¹è±¡ä¸Šé¢ï¼Œå¯ä»¥äº§ç”Ÿä¸åŒçš„è§£é‡Šå’Œä¸åŒçš„æ‰§è¡Œç»“æœã€‚æ¢å¥è¯è¯´ï¼Œç»™ä¸åŒçš„å¯¹è±¡å‘é€åŒä¸€ä¸ªæ¶ˆæ¯çš„æ—¶å€™ï¼Œè¿™äº›å¯¹è±¡ä¼šæ ¹æ®è¿™ä¸ªæ¶ˆæ¯åˆ†åˆ«ç»™å‡ºä¸åŒçš„åé¦ˆã€‚ åŸºæœ¬å¤šæ€12345678910111213var makeSound = function (animal) &#123; if (animal instanceOf Duck) &#123; console.log(&apos;å˜å˜å˜&apos;) &#125; else if (animal instanceOf Chicken) &#123; console.log(&apos;å’¯å’¯å’¯&apos;) &#125;&#125;var Duck = function() &#123;&#125;var Chicken = function() &#123;&#125;makeSound(new Duck())makeSound(new Chicken()) ä¼˜åŒ–å¤šæ€12345678910111213var makeSound = function (animal) &#123; animal.sound()&#125;var Duck = function() &#123;&#125;Duck.prototype.sound = function() &#123; console.log(&apos;å˜å˜å˜&apos;)&#125;var Chicken = function() &#123;&#125;Chiecken.prototype.sound = function() &#123; console.log(&apos;å’¯å’¯å’¯&apos;)&#125; ES6 å¤šæ€ç±»1234567891011121314151617181920212223class MakeSound &#123; sound (animal) &#123; animal.sound() &#125;&#125;class Duck &#123; sound () &#123; console.log(&apos;å˜å˜å˜&apos;) &#125;&#125;class Chicken &#123; sound () &#123; console.log(&apos;å’¯å’¯å’¯&apos;) &#125;&#125;var makesound = new MakeSound()var duck = new Duck()var chicken = new Chicken()makesound.sound(duck)makesound.sound(chicken) 1.2.6 å¤šæ€åœ¨é¢å‘å¯¹è±¡ä¸­çš„è®¾è®¡å‡è®¾æˆ‘ä»¬è¦ç¼–å†™ä¸€ä¸ªåœ°å›¾åº”ç”¨ï¼Œç°åœ¨æœ‰ä¸¤å®¶å¯é€‰çš„åœ°å›¾ API æä¾›å•†ä¾›æˆ‘ä»¬æ¥å…¥è‡ªå·±çš„åº”ç”¨ã€‚ ç›®å‰æˆ‘ä»¬é€‰æ‹©çš„æ˜¯è°·æ­Œåœ°å›¾ï¼Œè°·æ­Œåœ°å›¾çš„ API ä¸­æä¾›äº† show æ–¹æ³•ï¼Œè´Ÿè´£åœ¨é¡µé¢ä¸Šå±•ç¤ºæ•´ä¸ªåœ°å›¾ã€‚ ç¤ºä¾‹ä»£ç å¦‚ä¸‹ ï¼š 12345678910var googleMap = &#123; show: function()&#123;console.log( &apos;å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾&apos; ); &#125;&#125;;var renderMap = function()&#123; googleMap.show();&#125;;renderMap(); // è¾“å‡º:å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾ åæ¥å› ä¸ºæŸäº›åŸå› ï¼Œè¦æŠŠè°·æ­Œåœ°å›¾æ¢æˆç™¾åº¦åœ°å›¾ï¼Œä¸ºäº†è®© renderMap å‡½æ•°ä¿æŒä¸€å®šçš„å¼¹æ€§ï¼Œ æˆ‘ä»¬ç”¨ä¸€äº›æ¡ä»¶åˆ†æ”¯æ¥è®© renderMap å‡½æ•°åŒæ—¶æ”¯æŒè°·æ­Œåœ°å›¾å’Œç™¾åº¦åœ°å›¾: 12345678910111213141516171819var googleMap = &#123; show: function()&#123;console.log( &apos;å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾&apos; ); &#125;&#125;;var baiduMap = &#123; show: function()&#123;console.log( &apos;å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾&apos; ); &#125;&#125;;var renderMap = function( type )&#123; if ( type === &apos;google&apos; )&#123; googleMap.show();&#125;else if ( type === &apos;baidu&apos; )&#123; baiduMap.show();&#125; &#125;;renderMap( &apos;google&apos; ); // è¾“å‡º:å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾ renderMap( &apos;baidu&apos; ); // è¾“å‡º:å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾ å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ renderMap å‡½æ•°ç›®å‰ä¿æŒäº†ä¸€å®šçš„å¼¹æ€§ï¼Œä½†è¿™ç§å¼¹æ€§æ˜¯å¾ˆè„†å¼±çš„ï¼Œä¸€æ—¦éœ€è¦ æ›¿æ¢æˆæœæœåœ°å›¾ï¼Œé‚£æ— ç–‘å¿…é¡»å¾—æ”¹åŠ¨ renderMap å‡½æ•°ï¼Œç»§ç»­å¾€é‡Œé¢å †ç Œæ¡ä»¶åˆ†æ”¯è¯­å¥ã€‚ ä¼˜åŒ–å®ç°ï¼š 123456789101112131415161718192021class RenderMap &#123; start (Map) &#123; new Map().show() &#125;&#125;class BaiduMap &#123; show () &#123; console.log(&apos;å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾&apos;) &#125;&#125;class GoogleMap &#123; show () &#123; console.log(&apos;å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾&apos;) &#125;&#125;const rendermap = new RenderMap()rendermap.start(BaiduMap)rendermap.start(GoogleMap) ### 1.4.1 ä½¿ç”¨å…‹éš†çš„åŸå‹æ¨¡å¼ä»è®¾è®¡æ¨¡å¼çš„è§’åº¦è®²ï¼ŒåŸå‹æ¨¡å¼æ˜¯ç”¨äºåˆ›å»ºå¯¹è±¡çš„ä¸€ç§æ¨¡å¼ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œ ä¸€ç§æ–¹æ³•æ˜¯å…ˆæŒ‡å®šå®ƒçš„ç±»å‹ï¼Œç„¶åé€šè¿‡ç±»æ¥åˆ›å»ºè¿™ä¸ªå¯¹è±¡ã€‚åŸå‹æ¨¡å¼é€‰æ‹©äº†å¦å¤–ä¸€ç§æ–¹å¼ï¼Œæˆ‘ä»¬ ä¸å†å…³å¿ƒå¯¹è±¡çš„å…·ä½“ç±»å‹ï¼Œè€Œæ˜¯æ‰¾åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åé€šè¿‡å…‹éš†æ¥åˆ›å»ºä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„å¯¹è±¡ã€‚ æ—¢ç„¶åŸå‹æ¨¡å¼æ˜¯é€šè¿‡å…‹éš†æ¥åˆ›å»ºå¯¹è±¡çš„ï¼Œé‚£ä¹ˆå¾ˆè‡ªç„¶åœ°ä¼šæƒ³åˆ°ï¼Œå¦‚æœéœ€è¦ä¸€ä¸ªè·ŸæŸä¸ªå¯¹è±¡ä¸€ æ¨¡ä¸€æ ·çš„å¯¹è±¡ï¼Œå°±å¯ä»¥ä½¿ç”¨åŸå‹æ¨¡å¼ã€‚ å‡è®¾æˆ‘ä»¬åœ¨ç¼–å†™ä¸€ä¸ªé£æœºå¤§æˆ˜çš„ç½‘é¡µæ¸¸æˆã€‚æŸç§é£æœºæ‹¥æœ‰åˆ†èº«æŠ€èƒ½ï¼Œå½“å®ƒä½¿ç”¨åˆ†èº«æŠ€èƒ½çš„æ—¶ å€™ï¼Œè¦åœ¨é¡µé¢ä¸­åˆ›å»ºä¸€äº›è·Ÿå®ƒä¸€æ¨¡ä¸€æ ·çš„é£æœºã€‚å¦‚æœä¸ä½¿ç”¨åŸå‹æ¨¡å¼ï¼Œé‚£ä¹ˆåœ¨åˆ›å»ºåˆ†èº«ä¹‹å‰ï¼Œæ—  ç–‘å¿…é¡»å…ˆä¿å­˜è¯¥é£æœºçš„å½“å‰è¡€é‡ã€ç‚®å¼¹ç­‰çº§ã€é˜²å¾¡ç­‰çº§ç­‰ä¿¡æ¯ï¼Œéšåå°†è¿™äº›ä¿¡æ¯è®¾ç½®åˆ°æ–°åˆ›å»ºçš„ é£æœºä¸Šé¢ï¼Œè¿™æ ·æ‰èƒ½å¾—åˆ°ä¸€æ¶ä¸€æ¨¡ä¸€æ ·çš„æ–°é£æœºã€‚ 1å¦‚æœä½¿ç”¨åŸå‹æ¨¡å¼ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨è´Ÿè´£å…‹éš†çš„æ–¹æ³•ï¼Œä¾¿èƒ½å®ŒæˆåŒæ ·çš„åŠŸèƒ½ã€‚ åŸå‹æ¨¡å¼çš„å®ç°å…³é”®ï¼Œæ˜¯è¯­è¨€æœ¬èº«æ˜¯å¦æä¾›äº† clone æ–¹æ³•ã€‚ECMAScript 5 æä¾›äº† Object.create æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å…‹éš†å¯¹è±¡ã€‚ä»£ç å¦‚ä¸‹: 123456789101112131415161718192021Object.create = Object.create || function( obj )&#123; var F = function() &#123;&#125; F.prototype = obj return new F() &#125;class Flane &#123; constructor () &#123; this.height = 100 this.width = 200 &#125;&#125;var flane = new Flane()flane.height = 101flane.width = 201console.log(flane)const cloneFlane = Object.create(new Flane())console.log(cloneFlane) 2018.02.051.4.4 åŸå‹ç¼–ç¨‹è§„èŒƒ æ‰€æœ‰æ•°æ®éƒ½æ˜¯å¯¹è±¡ è¦å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œä¸æ˜¯å®ä¾‹åŒ–ä¸€ä¸ªç±»ï¼Œè€Œæ˜¯æ‰¾åˆ°ä¸€ä¸ªå¯¹è±¡ä½œä¸ºåŸå‹å¹¶å…‹éš†å®ƒ å¯¹è±¡ä¼šè®°ä½ä»–çš„åŸå‹ å¦‚æœå¯¹è±¡æ— æ³•å“åº”æŸä¸ªè¯·æ±‚ï¼Œå®ƒä¼šæŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™å®ƒçš„åŸå‹ç¬¬äºŒç« ï¼šthisã€apply å’Œ call2.1.1 å…³äº this çš„æŒ‡å‘ ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨ 123456789var obj = &#123; a: 1, getA: function()&#123; alert ( this === obj ); // è¾“å‡º:true alert ( this.a ); // è¾“å‡º: 1 &#125; &#125;;obj.getA(); ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨ 1234567window.globalName = &apos;jack&apos;var map = function () &#123; return this.globalName&#125;console.log(map()) æ„é€ å™¨è°ƒç”¨ 123456var MyClass = function () &#123; this.name = &apos;jack&apos;&#125;var myclass = new MyClass()console.log(myclass.name) Function.prototype.apply å’Œ Function.prototype.call 12345678910111213var object = &#123; name: &apos;jack&apos;, getName: function () &#123; return this.name &#125;&#125;var objectClone = &#123; name: &apos;rose&apos;&#125;console.log(object.getName())console.log(object.getName.call(objectClone)) 2.2 call å’Œ applyå…³é”®åœ¨äºä¼ å…¥å‚æ•°çš„å½¢å¼ä¸åŒ apply æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å‘ this çš„æŒ‡å‘ï¼Œç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºä¸€ä¸ªå¸¦ä¸‹æ ‡çš„é›†åˆï¼Œè¿™ä¸ªé›†åˆå¯ä»¥æ˜¯ä¸ªæ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç±»æ•°ç»„ï¼Œapply æ–¹æ³•å°†è¿™ä¸ªå‚æ•°ä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°ï¼š 12345var func = function (a, b, c) &#123; console.log([a, b, c])&#125;func.apply(null, [1, 2, 3]) call æ¥å—å¤šä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å‘ this çš„æŒ‡å‘ï¼Œåé¢çš„å‚æ•°ä¾æ¬¡ä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•° 1234var func = function (a, b, c) &#123; console.log([a, b, c])&#125;func.call(null, 1, 2, 3) ç”¨é€” æ”¹å˜ this æŒ‡å‘ Function.prototype.bind 12345678910111213141516171819Function.prototype.bind = function()&#123; var self = this, // ä¿å­˜åŸå‡½æ•° var context = [].shift.call( arguments ), var args = [].slice.call( arguments ); return function()&#123; // è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•° // éœ€è¦ç»‘å®šçš„ this ä¸Šä¸‹æ–‡ // å‰©ä½™çš„å‚æ•°è½¬æˆæ•°ç»„ return self.apply( context, [].concat.call( args, [].slice.call( arguments ) ) ); // æ‰§è¡Œæ–°çš„å‡½æ•°çš„æ—¶å€™ï¼Œä¼šæŠŠä¹‹å‰ä¼ å…¥çš„ context å½“ä½œæ–°å‡½æ•°ä½“å†…çš„ this// å¹¶ä¸”ç»„åˆä¸¤æ¬¡åˆ†åˆ«ä¼ å…¥çš„å‚æ•°ï¼Œä½œä¸ºæ–°å‡½æ•°çš„å‚æ•°&#125; &#125;;var obj = &#123; name: &apos;sven&apos;&#125;;var func = function( a, b, c, d )&#123;alert ( this.name ); // è¾“å‡º:svenalert ( [ a, b, c, d ] ) // è¾“å‡º:[ 1, 2, 3, 4 ]&#125;.bind( obj, 1, 2 ); func( 3, 4 ); å€Ÿç”¨å…¶ä»–å¯¹è±¡çš„æ–¹æ³• 1234567891011121314var a = function (name) &#123; this.name = name&#125;var B = function () &#123; a.apply(this, arguments)&#125;B.prototype.getName = function () &#123; return this.name&#125;var b = new B(&apos;hello&apos;)console.log(b.getName()) 2018.02.07ç¬¬äºŒéƒ¨åˆ†ï¼šè®¾è®¡æ¨¡å¼ å•ä¾‹æ¨¡å¼ å•ä¾‹æ¨¡å¼çš„å®šä¹‰ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›å”¯ä¸€è®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚ 2018.02.10 å•ä¾‹æ¨¡å¼å®ä¾‹1234567891011121314151617181920212223242526var createLoginLayer = function()&#123; var div = document.createElement( &apos;div&apos; ) div.innerHTML = &apos;æˆ‘æ˜¯ç™»å½•æµ®çª—&apos; div.style.display = &apos;none&apos; document.body.appendChild( div ) return div&#125;var createSingleLoginLayer = getSingle( createLoginLayer )document.getElementById( &apos;loginBtn&apos; ).onclick = function()&#123; var loginLayer = createSingleLoginLayer() loginLayer.style.display = &apos;block&apos;&#125;ä¸‹é¢æˆ‘ä»¬å†è¯•è¯•åˆ›å»ºå”¯ä¸€çš„ iframe ç”¨äºåŠ¨æ€åŠ è½½ç¬¬ä¸‰æ–¹é¡µé¢:var createSingleIframe = getSingle( function() &#123; var iframe = document.createElement ( &apos;iframe&apos; ) document.body.appendChild( iframe ) return iframe&#125;)document.getElementById( &apos;loginBtn&apos; ).onclick = function()&#123; var loginLayer = createSingleIframe() loginLayer.src = &apos;http://baidu.com&apos; })2018.02.12 ç¬¬äº”ç« ï¼š ç­–ç•¥æ¨¡å¼å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠä»–ä»¬å°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿ä»–ä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ 5.1.3 å®ä¾‹ä»£ç 12345678910111213141516171819202122232425262728var financeA = function () &#123;&#125;financeA.prototype.calculate = function (salary) &#123; return salary * 2&#125;var financeB = function () &#123;&#125; financeB.prototype.calculate = function (salary) &#123; return salary * 3&#125;var financeC = function () &#123;&#125;financeC.prototype.calculate = function (salary) &#123; return salary * 4&#125;var Bonus = function () &#123; this.stragety = null this.salary = null &#125;Bonus.protoType.setStragety = function (stragety) &#123; return this.stragety = stragety&#125;Bouns.protoType.getBonus = function (stragety) &#123; // å–å¾—å¥–é‡‘æ•°é¢ this.setStragety(stragety).calculate(this.salary) // å°†è®¡ç®—å¥–é‡‘æ“ä½œå§”æ‰˜ç»™å¯¹åº”çš„ç­–ç•¥å¯¹è±¡&#125; 5.7 ç­–ç•¥æ¨¡å¼çš„ä¼˜ç¼ºç‚¹ ç­–ç•¥æ¨¡å¼åˆ©ç”¨ç»„åˆå’Œå§”æ‰˜å’Œå¤šæ€æŠ€æœ¯çš„æ€æƒ³ï¼Œå¯ä»¥æœ‰æ•ˆçš„é¿å…å¤šé‡æ¡ä»¶é€‰æ‹©æ¡ä»¶ã€‚ ç­–ç•¥æ¨¡å¼æä¾›äº†å¯¹å¼€æ”¾-å°é—­åŸåˆ™çš„å®Œç¾æ”¯æŒï¼Œå°†ç®—æ³•å°è£…åˆ° strategy ä¸­ï¼Œä½¿å¾—ä»–ä»¬æ˜“äºåˆ‡æ¢ï¼Œæ˜“äºç†è§£ï¼Œæ˜“äºæ‰©å±•ã€‚ ç­–ç•¥æ¨¡å¼çš„ç®—æ³•ä¹Ÿå¯ä»¥å¤ç”¨åœ¨ç³»ç»Ÿå…¶å®ƒåœ°æ–¹ï¼Œä»è€Œé¿å…è®¸å¤šé‡å¤çš„å¤åˆ¶ç²˜è´´å·¥ä½œã€‚ åœ¨ç­–ç•¥æ¨¡å¼ä¸­ï¼Œåˆ©ç”¨ç»„åˆå’Œå§”æ‰˜å®ç°äº† context æ‰§è¡Œç®—æ³•çš„èƒ½åŠ›ï¼Œè¿™ä¹Ÿæ˜¯ç»§æ‰¿ä¸€ç§æ›´è½»ä¾¿çš„å®ç°æ–¹æ¡ˆã€‚### ç¬¬å…­ç« ï¼šä»£ç†æ¨¡å¼6.2 è™šæ‹Ÿä»£ç†è™šæ‹Ÿä»£ç å°±æ˜¯æŠŠå¼€é”€å¾ˆå¤§çš„å¯¹è±¡ï¼Œç•™å­˜åˆ°éœ€è¦å®ƒçš„åœ°æ–¹å†å»åˆ›å»ºã€‚6.8 ç¼“å­˜ä»£ç†ç¼“å­˜ä»£ç†å¯ä»¥ä¸ºä¸€äº›å¼€é”€å¤§çš„è¿ç®—ç»“æœæä¾›æš‚æ—¶çš„å­˜å‚¨ï¼Œå¯ç”¨äº AJAX è¯·æ±‚å¯¹è±¡6.10 å…¶ä»–ä»£ç†æ¨¡å¼ ä¿æŠ¤ä»£ç† ä¿æŠ¤ä»£ç†ç”¨äºæ§åˆ¶ä¸åŒæƒé™çš„å¯¹è±¡å¯¹ç›®æ ‡å¯¹è±¡è®¿é—® é˜²ç«å¢™ä»£ç† æ§åˆ¶ç½‘ç»œèµ„æºçš„è®¿é—® è¿œç¨‹ä»£ç† ä¸ºä¸€ä¸ªå¯¹è±¡åœ¨ä¸åŒåœ°å€ç©ºé—´æä¾›å±€éƒ¨ä»£è¡¨ æ™ºèƒ½å¼•ç”¨ä»£ç† å–ä»£ç®€å•çš„æŒ‡é’ˆï¼Œåœ¨å¯¹è±¡è®¿é—®çš„æ—¶å€™æä¾›ä¸€äº›ç‰¹æ®Šçš„æ“ä½œï¼Œæ¯”å¦‚è®¡ç®—ä¸€ä¸ªå¯¹è±¡è¢«å¼•ç”¨çš„æ¬¡æ•° å†™æ—¶å¤åˆ¶ä»£ç† é€šå¸¸ç”¨äºå¤åˆ¶ä¸€ä¸ªåºå¤§çš„å¯¹è±¡ï¼Œå†™æ—¶å¤åˆ¶å»¶è¿Ÿäº†å¤åˆ¶çš„è¿‡ç¨‹ã€‚å½“å¯¹è±¡çœŸæ­£è¢«ä¿®æ”¹çš„æ—¶å€™ï¼Œæ‰å»è¿›è¡Œå¤åˆ¶æ“ä½œã€‚å†™æ—¶å¤åˆ¶æ˜¯è™šæ‹Ÿä»£ç†çš„ä¸€ç§å˜ä½“ï¼ŒDLL ï¼ˆæ“ä½œç³»ç»Ÿçš„åŠ¨æ€é“¾æ¥åº“ï¼‰æ˜¯å…¸å‹çš„è¿ç”¨åœºæ™¯ 2018.02.26äº«å…ƒæ¨¡å¼ï¼šè§£å†³æ€§èƒ½é—®é¢˜è€Œç”Ÿé€‚ç”¨åœºæ™¯ï¼š ä¸€ä¸ªç¨‹åºä¸­ä½¿ç”¨äº†å¤§é‡é‡å¤å¯¹è±¡ ç”±äºä½¿ç”¨å¤§é‡å¯¹è±¡ï¼Œé€ æˆå†…å­˜å¼€é”€ å¯¹è±¡çš„å¤§å¯¹æ•°çŠ¶æ€å¤šå¯ä»¥å˜æˆå¤–éƒ¨çŠ¶æ€ å‰¥ç¦»å‡ºå¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€ä¹‹å¤–ï¼Œå¯ä»¥ç”¨è¾ƒå°‘çš„å…±äº«å¯¹è±¡å–ä»£å¤§é‡å¯¹è±¡ å¯¹è±¡æ± ï¼šæ•°æ®åº“è¿æ¥å¯¹è±¡ï¼ŒHTTPè¿æ¥æ± é€‚ç”¨åœºæ™¯","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://sensitivemix.github.io/categories/è®¾è®¡æ¨¡å¼/"}],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://sensitivemix.github.io/tags/Javascript/"},{"name":"DesignPattern","slug":"DesignPattern","permalink":"https://sensitivemix.github.io/tags/DesignPattern/"}]},{"title":"å•ç‚¹ç™»å½•åŸºæœ¬æ¦‚å¿µ","slug":"å•ç‚¹ç™»å½•åŸºæœ¬æ¦‚å¿µ","date":"2017-06-19T13:40:28.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2017/06/19/å•ç‚¹ç™»å½•åŸºæœ¬æ¦‚å¿µ/","link":"","permalink":"https://sensitivemix.github.io/2017/06/19/å•ç‚¹ç™»å½•åŸºæœ¬æ¦‚å¿µ/","excerpt":"","text":"å‰è¨€ ç›®å‰å¤§éƒ¨åˆ†ç½‘ç«™éƒ½æ”¯æŒå•ç‚¹ç™»å½•ï¼Œä½•è°“å•ç‚¹ç™»å½•ï¼Œå°±æ˜¯ä¸€ä¸ªè´¦å·å¯ä»¥ç™»å½•å¤šä¸ªç½‘ç«™ï¼Œä¸ç”¨åœ¨æ¯ä¸ªç½‘ç«™éƒ½æ³¨å†Œä¸€ä¸ªè´¦å·ã€‚ æµç¨‹ è®¿é—®ç½‘ç«™ è·³è½¬åˆ°æˆæƒæœåŠ¡å™¨è¯·æ±‚codeæˆæƒç  æˆæƒæœåŠ¡å™¨æ¥å—åˆ°è¯·æ±‚æ ¹æ®å›è°ƒåœ°å€ï¼Œå“åº”æˆæƒç  å®¢æˆ·ç«¯æ”¶åˆ°æˆæƒç ï¼Œè½¬æ¢æˆæˆæƒtokenè®¤è¯ å­˜å…¥sessionæˆ–è€…æŒä¹…åŒ–å­˜å‚¨","categories":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://sensitivemix.github.io/categories/å¼€å‘/"}],"tags":[{"name":"Login","slug":"Login","permalink":"https://sensitivemix.github.io/tags/Login/"}]},{"title":"å‰ç«¯å…¥é—¨å­¦ä¹ èµ„æ–™","slug":"å‰ç«¯å…¥é—¨å­¦ä¹ èµ„æ–™","date":"2017-06-17T01:58:59.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2017/06/17/å‰ç«¯å…¥é—¨å­¦ä¹ èµ„æ–™/","link":"","permalink":"https://sensitivemix.github.io/2017/06/17/å‰ç«¯å…¥é—¨å­¦ä¹ èµ„æ–™/","excerpt":"","text":"ç¬¬ä¸€é˜¶æ®µï¼š åŸºç¡€ï¼ŒåŒ…å« HTML CSS JavaScriptå¯å­¦ä¹ çš„ç½‘ç«™ï¼šw3cï¼šhttp://www.w3school.com.cn/ ï¼ˆåªçœ‹HTML/CSS JavaScriptæ¨¡å—å³å¯ï¼‰æ…•è¯¾ç½‘ï¼šhttp://www.imooc.com/course/programdetail/pid/32html/cssåŸºç¡€è¯¾ç¨‹ï¼š https://www.codecademy.com/learn/weblessï¼š http://www.bootcss.com/p/lesscss/sassï¼š http://www.sasschina.com/guide/flex å¸ƒå±€ï¼šè¯­æ³•ç¯‡å’Œå®ä¾‹ç¯‡ http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html http://www.ruanyifeng.com/blog/2015/07/flex-examples.htmlæ³¨ï¼šlesså’Œsasséƒ½æ˜¯è®©ç¼–å†™csså˜å¾—æ›´ç®€å•ï¼Œä½ å¯ä»¥å…ˆç†Ÿæ‚‰å…¶ä¸­ä¸€ç§ï¼Œæ¨èlessï¼Œç®€å•äº›flexæ˜¯ä¸€ç§å¸ƒå±€ï¼Œå¯ä»¥é¿å…å„ç§ç›¸å¯¹ç»å¯¹å®šä½å¼•èµ·çš„æµ®åŠ¨ã€‚ ä»¿å†™çš„é¡µé¢ http://www.thatsitmag.com/ ç”¨HTMLå’ŒCSSå®ç°è¿™ä¸ªé¡µé¢ï¼ŒCSSç”¨lesså†™ï¼Œé¡µé¢å¸ƒå±€ç”¨flexï¼Œå¦‚æœèƒ½å¤Ÿå®Œæˆï¼Œä½ çš„HTMLå’ŒCSSå°±å·®ä¸å¤šäº†ã€‚è¦æœ‰è€å¿ƒã€‚ ä¸€äº›ä¸é”™çš„æŠ€æœ¯è®ºå›ï¼Œæœ‰é—®é¢˜å¯ä»¥å»é‚£æ‰¾ç­”æ¡ˆæˆ–è€…å‘å¸–æ±‚åŠ©ï¼šsegmentfaultï¼šhttps://segmentfault.com/dio.ioï¼šhttp://div.io/#/welcomev2exï¼šhttps://www.v2ex.com/ä¸€äº›ä¸é”™çš„appï¼šsegmentfaultå¼€å‘è€…å¤´æ¡æ¨é…·36æ°ªå‰ç«¯å·¥ç¨‹å¸ˆä¸€äº›ä¸é”™çš„å¾®ä¿¡å…¬ä¼—å·ï¼šå‰ç«¯å¤§å…¨å‰ç«¯åœˆå‰ç«¯æ—©è¯»è¯¾ç¨‹åºå‘˜é‚£äº›äº‹äº’è”ç½‘å®ä¹ byæ‹‰å‹¾ç½‘ä¹”å¸ƒç®€å†æ³¨ï¼šåœ¨ä¸€äº›è®ºå›å’Œå¾®ä¿¡å…¬ä¼—å·ä¸Šèƒ½çœ‹åˆ°æ‹›è˜ä¿¡æ¯ï¼Œä½ å¯ä»¥çœ‹çœ‹ç›®å‰çš„æ‹›è˜è¦æ±‚ï¼Œè‡ªå·±è¦å­¦çš„æŠ€æœ¯æœ‰å“ªäº›ï¼Œå¢åŠ åŠ¨åŠ›ã€‚ç­‰ä½ åŸºç¡€å·®ä¸å¤šäº†ï¼Œæˆ‘å†ç»™ä½ æ•´ç†æ·±ä¸€ç‚¹çš„ä¸œè¥¿ã€‚åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­å­¦åˆ°çš„æ–°çš„çŸ¥è¯†ç‚¹ï¼Œé‡åˆ°é—®é¢˜æ˜¯å¦‚ä½•è§£å†³çš„ï¼Œéƒ½å¯ä»¥è®°å½•ä¸‹æ¥ï¼Œæ¨èä½ ç”¨çŸ³å¢¨æ–‡æ¡£è®°å½•ã€‚ js: http://es6.ruanyifeng.com/ reactä¸­æ–‡:http://www.css88.com/react/docs/getting-started.htmlreactè‹±æ–‡ï¼š http://reactjs.cn/react/docs/reusable-components.html#prop- reduxä¸­æ–‡: http://cn.redux.js.org/reduxè‹±æ–‡:http://redux.js.org/ githubåŸºæœ¬æ“ä½œå‘½ä»¤æ¼”ç¤º http://learngitbranching.js.org/?locale=zh_CNsourcetree: https://www.sourcetreeapp.com/","categories":[{"name":"å­¦ä¹ èµ„æ–™","slug":"å­¦ä¹ èµ„æ–™","permalink":"https://sensitivemix.github.io/categories/å­¦ä¹ èµ„æ–™/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://sensitivemix.github.io/tags/Tutorial/"},{"name":"Frontend","slug":"Frontend","permalink":"https://sensitivemix.github.io/tags/Frontend/"}]},{"title":"ç¼–ç åŸºç¡€ä¹‹ c è¯­è¨€æŒ‡é’ˆåˆ†æ","slug":"ç¼–ç åŸºç¡€ä¹‹ c è¯­è¨€æŒ‡é’ˆåˆ†æ","date":"2017-06-12T14:55:07.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2017/06/12/ç¼–ç åŸºç¡€ä¹‹ c è¯­è¨€æŒ‡é’ˆåˆ†æ/","link":"","permalink":"https://sensitivemix.github.io/2017/06/12/ç¼–ç åŸºç¡€ä¹‹ c è¯­è¨€æŒ‡é’ˆåˆ†æ/","excerpt":"","text":"ç¬¬ä¸€ç«  æŒ‡é’ˆçš„æ¦‚å¿µæŒ‡é’ˆæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ï¼Œå®ƒé‡Œé¢å­˜å‚¨çš„æ•°å€¼è¢«è§£é‡Šæˆä¸ºå†…å­˜é‡Œçš„ä¸€ä¸ªåœ°å€ã€‚ è¦ææ¸…ä¸€ä¸ªæŒ‡é’ˆéœ€è¦ææ¸…æŒ‡é’ˆçš„å››æ–¹é¢çš„å†…å®¹ï¼šæŒ‡é’ˆçš„ç±»å‹ï¼ŒæŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹ï¼ŒæŒ‡é’ˆçš„å€¼æˆ–è€…å«æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜åŒºï¼Œè¿˜æœ‰æŒ‡é’ˆæœ¬èº«æ‰€å æ®çš„å†…å­˜åŒºã€‚è®©æˆ‘ä»¬åˆ†åˆ«è¯´æ˜ã€‚å…ˆå£°æ˜å‡ ä¸ªæŒ‡é’ˆæ”¾ç€åšä¾‹å­ï¼šä¾‹ä¸€ï¼š(1)int ptr;(2)char ptr;(3)int *ptr;(4)int (ptr)[3];(5)int (ptr)[4];å¦‚æœçœ‹ä¸æ‡‚åå‡ ä¸ªä¾‹å­çš„è¯ï¼Œè¯·å‚é˜…æˆ‘å‰æ®µæ—¶é—´è´´å‡ºçš„æ–‡?lt;&lt;å¦‚ä½•ç†è§£cå’Œc++çš„å¤æ‚ç±»å‹å£°æ˜&gt;&gt;ã€‚ 1.æŒ‡é’ˆçš„ç±»å‹ã€‚ä»è¯­æ³•çš„è§’åº¦çœ‹ï¼Œä½ åªè¦æŠŠæŒ‡é’ˆå£°æ˜è¯­å¥é‡Œçš„æŒ‡é’ˆåå­—å»æ‰ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†å°±æ˜¯è¿™ä¸ªæŒ‡é’ˆçš„ç±»å‹ã€‚è¿™æ˜¯æŒ‡é’ˆæœ¬èº«æ‰€å…·æœ‰çš„ç±»å‹ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¾‹ä¸€ä¸­å„ä¸ªæŒ‡é’ˆçš„ç±»å‹ï¼š(1)int ptr; //æŒ‡é’ˆçš„ç±»å‹æ˜¯int (2)char ptr; //æŒ‡é’ˆçš„ç±»å‹æ˜¯char (3)int ptr; //æŒ‡é’ˆçš„ç±»å‹æ˜¯ int (4)int (ptr)[3]; //æŒ‡é’ˆçš„ç±»å‹æ˜¯ int()[3](5)int (ptr)[4]; //æŒ‡é’ˆçš„ç±»å‹æ˜¯ int ()[4]æ€ä¹ˆæ ·ï¼Ÿæ‰¾å‡ºæŒ‡é’ˆçš„ç±»å‹çš„æ–¹æ³•æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿ 2.æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹ã€‚å½“ä½ é€šè¿‡æŒ‡é’ˆæ¥è®¿é—®æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜åŒºæ—¶ï¼ŒæŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹å†³å®šäº†ç¼–è¯‘å™¨å°†æŠŠé‚£ç‰‡å†…å­˜åŒºé‡Œçš„å†…å®¹å½“åšä»€ä¹ˆæ¥çœ‹å¾…ã€‚ä»è¯­æ³•ä¸Šçœ‹ï¼Œä½ åªé¡»æŠŠæŒ‡é’ˆå£°æ˜è¯­å¥ä¸­çš„æŒ‡é’ˆåå­—å’Œåå­—å·¦è¾¹çš„æŒ‡é’ˆå£°æ˜ç¬¦å»æ‰ï¼Œå‰©ä¸‹çš„å°±æ˜¯æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼š(1)int ptr; //æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹æ˜¯int(2)char ptr; //æŒ‡é’ˆæ‰€æŒ‡å‘çš„çš„ç±»å‹æ˜¯char(3)int **ptr; //æŒ‡é’ˆæ‰€æŒ‡å‘çš„çš„ç±»å‹æ˜¯ int (4)int (ptr)[3]; //æŒ‡é’ˆæ‰€æŒ‡å‘çš„çš„ç±»å‹æ˜¯ int()[3](5)int (ptr)[4]; //æŒ‡é’ˆæ‰€æŒ‡å‘çš„çš„ç±»å‹æ˜¯ int ()[4]åœ¨æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—ä¸­ï¼ŒæŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹æœ‰å¾ˆå¤§çš„ä½œç”¨ã€‚æŒ‡é’ˆçš„ç±»å‹(å³æŒ‡é’ˆæœ¬èº«çš„ç±»å‹)å’ŒæŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹æ˜¯ä¸¤ä¸ªæ¦‚å¿µã€‚å½“ä½ å¯¹Cè¶Šæ¥è¶Šç†Ÿæ‚‰æ—¶ï¼Œä½ ä¼šå‘ç°ï¼ŒæŠŠä¸æŒ‡é’ˆæ…å’Œåœ¨ä¸€èµ·çš„â€ç±»å‹â€è¿™ä¸ªæ¦‚å¿µåˆ†æˆâ€æŒ‡é’ˆçš„ç±»å‹â€å’Œâ€æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹â€ä¸¤ä¸ªæ¦‚å¿µï¼Œæ˜¯ç²¾é€šæŒ‡é’ˆçš„å…³é”®ç‚¹ä¹‹ä¸€ã€‚æˆ‘çœ‹äº†ä¸å°‘ä¹¦ï¼Œå‘ç°æœ‰äº›å†™å¾—å·®çš„ä¹¦ä¸­ï¼Œå°±æŠŠæŒ‡é’ˆçš„è¿™ä¸¤ä¸ªæ¦‚å¿µæ…åœ¨ä¸€èµ·äº†ï¼Œæ‰€ä»¥çœ‹èµ·ä¹¦æ¥å‰åçŸ›ç›¾ï¼Œè¶Šçœ‹è¶Šç³Šæ¶‚ã€‚ æŒ‡é’ˆçš„å€¼ï¼Œæˆ–è€…å«æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜åŒºæˆ–åœ°å€ã€‚æŒ‡é’ˆçš„å€¼æ˜¯æŒ‡é’ˆæœ¬èº«å­˜å‚¨çš„æ•°å€¼ï¼Œè¿™ä¸ªå€¼å°†è¢«ç¼–è¯‘å™¨å½“ä½œä¸€ä¸ªåœ°å€ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸€èˆ¬çš„æ•°å€¼ã€‚åœ¨32ä½ç¨‹åºé‡Œï¼Œæ‰€æœ‰ç±»å‹çš„æŒ‡é’ˆçš„å€¼éƒ½æ˜¯ä¸€ä¸ª32ä½æ•´æ•°ï¼Œå› ä¸º32ä½ç¨‹åºé‡Œå†…å­˜åœ°å€å…¨éƒ½æ˜¯32ä½é•¿ã€‚æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜åŒºå°±æ˜¯ä»æŒ‡é’ˆçš„å€¼æ‰€ä»£è¡¨çš„é‚£ä¸ªå†…å­˜åœ°å€å¼€å§‹ï¼Œé•¿åº¦ä¸ºsizeof(æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹)çš„ä¸€ç‰‡å†…å­˜åŒºã€‚ä»¥åï¼Œæˆ‘ä»¬è¯´ä¸€ä¸ªæŒ‡é’ˆçš„å€¼æ˜¯XXï¼Œå°±ç›¸å½“äºè¯´è¯¥æŒ‡é’ˆæŒ‡å‘äº†ä»¥XXä¸ºé¦–åœ°å€çš„ä¸€ç‰‡å†…å­˜åŒºåŸŸï¼›æˆ‘ä»¬è¯´ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘äº†æŸå—å†…å­˜åŒºåŸŸï¼Œå°±ç›¸å½“äºè¯´è¯¥æŒ‡é’ˆçš„å€¼æ˜¯è¿™å—å†…å­˜åŒºåŸŸçš„é¦–åœ°å€ã€‚æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜åŒºå’ŒæŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„æ¦‚å¿µã€‚åœ¨ä¾‹ä¸€ä¸­ï¼ŒæŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹å·²ç»æœ‰äº†ï¼Œä½†ç”±äºæŒ‡é’ˆè¿˜æœªåˆå§‹åŒ–ï¼Œæ‰€ä»¥å®ƒæ‰€æŒ‡å‘çš„å†…å­˜åŒºæ˜¯ä¸å­˜åœ¨çš„ï¼Œæˆ–è€…è¯´æ˜¯æ— æ„ä¹‰çš„ã€‚ä»¥åï¼Œæ¯é‡åˆ°ä¸€ä¸ªæŒ‡é’ˆï¼Œéƒ½åº”è¯¥é—®é—®ï¼šè¿™ä¸ªæŒ‡é’ˆçš„ç±»å‹æ˜¯ä»€ä¹ˆï¼ŸæŒ‡é’ˆæŒ‡å‘çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿè¯¥æŒ‡é’ˆæŒ‡å‘äº†å“ªé‡Œï¼Ÿ æŒ‡é’ˆæœ¬èº«æ‰€å æ®çš„å†…å­˜åŒºã€‚æŒ‡é’ˆæœ¬èº«å äº†å¤šå¤§çš„å†…å­˜ï¼Ÿä½ åªè¦ç”¨å‡½æ•°sizeof(æŒ‡é’ˆçš„ç±»å‹)æµ‹ä¸€ä¸‹å°±çŸ¥é“äº†ã€‚åœ¨32ä½å¹³å°é‡Œï¼ŒæŒ‡é’ˆæœ¬èº«å æ®äº†4ä¸ªå­—èŠ‚çš„é•¿åº¦ã€‚æŒ‡é’ˆæœ¬èº«å æ®çš„å†…å­˜è¿™ä¸ªæ¦‚å¿µåœ¨åˆ¤æ–­ä¸€ä¸ªæŒ‡é’ˆè¡¨è¾¾å¼æ˜¯å¦æ˜¯å·¦å€¼æ—¶å¾ˆæœ‰ç”¨ã€‚ ç¬¬äºŒç«  æŒ‡é’ˆçš„ç®—æœ¯è¿ç®— æŒ‡é’ˆå¯ä»¥åŠ ä¸Šæˆ–å‡å»ä¸€ä¸ªæ•´æ•°ã€‚æŒ‡é’ˆçš„è¿™ç§è¿ç®—çš„æ„ä¹‰å’Œé€šå¸¸çš„æ•°å€¼çš„åŠ å‡è¿ç®—çš„æ„ä¹‰æ˜¯ä¸ä¸€æ ·çš„ã€‚ä¾‹å¦‚ï¼šä¾‹äºŒï¼š char a[20]; int *ptr=a;â€¦â€¦ ptr++;åœ¨ä¸Šä¾‹ä¸­ï¼ŒæŒ‡é’ˆptrçš„ç±»å‹æ˜¯int,å®ƒæŒ‡å‘çš„ç±»å‹æ˜¯intï¼Œå®ƒè¢«åˆå§‹åŒ–ä¸ºæŒ‡å‘æ•´å½¢å˜é‡aã€‚æ¥ä¸‹æ¥çš„ç¬¬3å¥ä¸­ï¼ŒæŒ‡é’ˆptrè¢«åŠ äº†1ï¼Œç¼–è¯‘å™¨æ˜¯è¿™æ ·å¤„ç†çš„ï¼šå®ƒæŠŠæŒ‡é’ˆptrçš„å€¼åŠ ä¸Šäº†sizeof(int)ï¼Œåœ¨32ä½ç¨‹åºä¸­ï¼Œæ˜¯è¢«åŠ ä¸Šäº†4ã€‚ç”±äºåœ°å€æ˜¯ç”¨å­—èŠ‚åšå•ä½çš„ï¼Œæ•…ptræ‰€æŒ‡å‘çš„åœ°å€ç”±åŸæ¥çš„å˜é‡açš„åœ°å€å‘é«˜åœ°å€æ–¹å‘å¢åŠ äº†4ä¸ªå­—èŠ‚ã€‚ç”±äºcharç±»å‹çš„é•¿åº¦æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ï¼ŒåŸæ¥ptræ˜¯æŒ‡å‘æ•°ç»„açš„ç¬¬0å·å•å…ƒå¼€å§‹çš„å››ä¸ªå­—èŠ‚ï¼Œæ­¤æ—¶æŒ‡å‘äº†æ•°ç»„aä¸­ä»ç¬¬4å·å•å…ƒå¼€å§‹çš„å››ä¸ªå­—èŠ‚ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæŒ‡é’ˆå’Œä¸€ä¸ªå¾ªç¯æ¥éå†ä¸€ä¸ªæ•°ç»„ï¼Œçœ‹ä¾‹å­ï¼šä¾‹ä¸‰ï¼šä¾‹ä¸‰ï¼šint array[20];int ptr=array;â€¦//æ­¤å¤„ç•¥å»ä¸ºæ•´å‹æ•°ç»„èµ‹å€¼çš„ä»£ç ã€‚â€¦for(i=0;i&lt;20;i++){(*ptr)++;ptr++ï¼›}è¿™ä¸ªä¾‹å­å°†æ•´å‹æ•°ç»„ä¸­å„ä¸ªå•å…ƒçš„å€¼åŠ 1ã€‚ç”±äºæ¯æ¬¡å¾ªç¯éƒ½å°†æŒ‡é’ˆptråŠ 1ï¼Œæ‰€ä»¥æ¯æ¬¡å¾ªç¯éƒ½èƒ½è®¿é—®æ•°ç»„çš„ä¸‹ä¸€ä¸ªå•å…ƒã€‚å†çœ‹ä¾‹å­ï¼šä¾‹å››ï¼š char a[20]; int *ptr=a;â€¦â€¦ ptr+=5;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œptrè¢«åŠ ä¸Šäº†5ï¼Œç¼–è¯‘å™¨æ˜¯è¿™æ ·å¤„ç†çš„ï¼šå°†æŒ‡é’ˆptrçš„å€¼åŠ ä¸Š5ä¹˜sizeof(int)ï¼Œåœ¨32ä½ç¨‹åºä¸­å°±æ˜¯åŠ ä¸Šäº†5ä¹˜4=20ã€‚ç”±äºåœ°å€çš„å•ä½æ˜¯å­—èŠ‚ï¼Œæ•…ç°åœ¨çš„ptræ‰€æŒ‡å‘çš„åœ°å€æ¯”èµ·åŠ 5åçš„ptræ‰€æŒ‡å‘çš„åœ°å€æ¥è¯´ï¼Œå‘é«˜åœ°å€æ–¹å‘ç§»åŠ¨äº†20ä¸ªå­—èŠ‚ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ²¡åŠ 5å‰çš„ptræŒ‡å‘æ•°ç»„açš„ç¬¬0å·å•å…ƒå¼€å§‹çš„å››ä¸ªå­—èŠ‚ï¼ŒåŠ 5åï¼Œptrå·²ç»æŒ‡å‘äº†æ•°ç»„açš„åˆæ³•èŒƒå›´ä¹‹å¤–äº†ã€‚è™½ç„¶è¿™ç§æƒ…å†µåœ¨åº”ç”¨ä¸Šä¼šå‡ºé—®é¢˜ï¼Œä½†åœ¨è¯­æ³•ä¸Šå´æ˜¯å¯ä»¥çš„ã€‚è¿™ä¹Ÿä½“ç°å‡ºäº†æŒ‡é’ˆçš„çµæ´»æ€§ã€‚å¦‚æœä¸Šä¾‹ä¸­ï¼Œptræ˜¯è¢«å‡å»5ï¼Œé‚£ä¹ˆå¤„ç†è¿‡ç¨‹å¤§åŒå°å¼‚ï¼Œåªä¸è¿‡ptrçš„å€¼æ˜¯è¢«å‡å»5ä¹˜sizeof(int)ï¼Œæ–°çš„ptræŒ‡å‘çš„åœ°å€å°†æ¯”åŸæ¥çš„ptræ‰€æŒ‡å‘çš„åœ°å€å‘ä½åœ°å€æ–¹å‘ç§»åŠ¨äº†20ä¸ªå­—èŠ‚ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œä¸€ä¸ªæŒ‡é’ˆptroldåŠ ä¸Šä¸€ä¸ªæ•´æ•°nåï¼Œç»“æœæ˜¯ä¸€ä¸ªæ–°çš„æŒ‡é’ˆptrnewï¼Œptrnewçš„ç±»å‹å’Œptroldçš„ç±»å‹ç›¸åŒï¼Œptrnewæ‰€æŒ‡å‘çš„ç±»å‹å’Œptroldæ‰€æŒ‡å‘çš„ç±»å‹ä¹Ÿç›¸åŒã€‚ptrnewçš„å€¼å°†æ¯”ptroldçš„å€¼å¢åŠ äº†nä¹˜sizeof(ptroldæ‰€æŒ‡å‘çš„ç±»å‹)ä¸ªå­—èŠ‚ã€‚å°±æ˜¯è¯´ï¼Œptrnewæ‰€æŒ‡å‘çš„å†…å­˜åŒºå°†æ¯”ptroldæ‰€æŒ‡å‘çš„å†…å­˜åŒºå‘é«˜åœ°å€æ–¹å‘ç§»åŠ¨äº†nä¹˜sizeof(ptroldæ‰€æŒ‡å‘çš„ç±»å‹)ä¸ªå­—èŠ‚ã€‚ä¸€ä¸ªæŒ‡é’ˆptroldå‡å»ä¸€ä¸ªæ•´æ•°nåï¼Œç»“æœæ˜¯ä¸€ä¸ªæ–°çš„æŒ‡é’ˆptrnewï¼Œptrnewçš„ç±»å‹å’Œptroldçš„ç±»å‹ç›¸åŒï¼Œptrnewæ‰€æŒ‡å‘çš„ç±»å‹å’Œptroldæ‰€æŒ‡å‘çš„ç±»å‹ä¹Ÿç›¸åŒã€‚ptrnewçš„å€¼å°†æ¯”ptroldçš„å€¼å‡å°‘äº†nä¹˜sizeof(ptroldæ‰€æŒ‡å‘çš„ç±»å‹)ä¸ªå­—èŠ‚ï¼Œå°±æ˜¯è¯´ï¼Œptrnewæ‰€æŒ‡å‘çš„å†…å­˜åŒºå°†æ¯”ptroldæ‰€æŒ‡å‘çš„å†…å­˜åŒºå‘ä½åœ°å€æ–¹å‘ç§»åŠ¨äº†nä¹˜sizeof(ptroldæ‰€æŒ‡å‘çš„ç±»å‹)ä¸ªå­—èŠ‚ã€‚ ç¬¬ä¸‰ç«  è¿ç®—ç¬¦å·&amp;å’Œ* è¿™é‡Œ&amp;æ˜¯å–åœ°å€è¿ç®—ç¬¦ï¼Œæ˜¯â€¦ä¹¦ä¸Šå«åšâ€é—´æ¥è¿ç®—ç¬¦â€ã€‚&amp;açš„è¿ç®—ç»“æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡é’ˆçš„ç±»å‹æ˜¯açš„ç±»å‹åŠ ä¸ªï¼ŒæŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹æ˜¯açš„ç±»å‹ï¼ŒæŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€å˜›ï¼Œé‚£å°±æ˜¯açš„åœ°å€ã€‚pçš„è¿ç®—ç»“æœå°±äº”èŠ±å…«é—¨äº†ã€‚æ€»ä¹‹pçš„ç»“æœæ˜¯pæ‰€æŒ‡å‘çš„ä¸œè¥¿ï¼Œè¿™ä¸ªä¸œè¥¿æœ‰è¿™äº›ç‰¹ç‚¹ï¼šå®ƒçš„ç±»å‹æ˜¯pæŒ‡å‘çš„ç±»å‹ï¼Œå®ƒæ‰€å ç”¨çš„åœ°å€æ˜¯pæ‰€æŒ‡å‘çš„åœ°å€ã€‚ä¾‹äº”ï¼šint a=12;int b;int p;int **ptr;p=&a;//&amp;açš„ç»“æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œç±»å‹æ˜¯intï¼ŒæŒ‡å‘çš„ç±»å‹æ˜¯intï¼ŒæŒ‡å‘çš„åœ°å€æ˜¯açš„åœ°å€ã€‚p=24;//pçš„ç»“æœï¼Œåœ¨è¿™é‡Œå®ƒçš„ç±»å‹æ˜¯intï¼Œå®ƒæ‰€å ç”¨çš„åœ°å€æ˜¯pæ‰€æŒ‡å‘çš„åœ°å€ï¼Œæ˜¾ç„¶ï¼Œpå°±æ˜¯å˜é‡aã€‚ptr=&p;//&amp;pçš„ç»“æœæ˜¯ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆçš„ç±»å‹æ˜¯pçš„ç±»å‹åŠ ä¸ªï¼Œåœ¨è¿™é‡Œæ˜¯intã€‚è¯¥æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹æ˜¯pçš„ç±»å‹ï¼Œè¿™é‡Œæ˜¯intã€‚è¯¥æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€å°±æ˜¯æŒ‡é’ˆpè‡ªå·±çš„åœ°å€ã€‚ ptr=&b;//ptræ˜¯ä¸ªæŒ‡é’ˆï¼Œ&amp;bçš„ç»“æœä¹Ÿæ˜¯ä¸ªæŒ‡é’ˆï¼Œä¸”è¿™ä¸¤ä¸ªæŒ‡é’ˆçš„ç±»å‹å’Œæ‰€æŒ‡å‘çš„ç±»å‹æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ç”¨&amp;bæ¥ç»™ptrèµ‹å€¼å°±æ˜¯æ¯«æ— é—®é¢˜çš„äº†ã€‚ ptr=34;//ptrçš„ç»“æœæ˜¯ptræ‰€æŒ‡å‘çš„ä¸œè¥¿ï¼Œåœ¨è¿™é‡Œæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå¯¹è¿™ä¸ªæŒ‡é’ˆå†åšä¸€æ¬¡è¿ç®—ï¼Œç»“æœå°±æ˜¯ä¸€ä¸ªintç±»å‹çš„å˜é‡ã€‚ ç¬¬å››ç«  æŒ‡é’ˆè¡¨è¾¾å¼ ä¸€ä¸ªè¡¨è¾¾å¼çš„æœ€åç»“æœå¦‚æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œé‚£ä¹ˆè¿™ä¸ªè¡¨è¾¾å¼å°±å«æŒ‡é’ˆè¡¨è¾¾å¼ã€‚ä¸‹é¢æ˜¯ä¸€äº›æŒ‡é’ˆè¡¨è¾¾å¼çš„ä¾‹å­ï¼šä¾‹å…­ï¼šint a,b;int array[10];int pa;pa=&a;//&amp;aæ˜¯ä¸€ä¸ªæŒ‡é’ˆè¡¨è¾¾å¼ã€‚int **ptr=&pa;//&amp;paä¹Ÿæ˜¯ä¸€ä¸ªæŒ‡é’ˆè¡¨è¾¾å¼ã€‚ ptr=&b;//ptrå’Œ&amp;béƒ½æ˜¯æŒ‡é’ˆè¡¨è¾¾å¼ã€‚pa=array;pa++;//è¿™ä¹Ÿæ˜¯æŒ‡é’ˆè¡¨è¾¾å¼ã€‚ä¾‹ä¸ƒï¼šchar arr[20];char *parr=arr;//å¦‚æœæŠŠarrçœ‹ä½œæŒ‡é’ˆçš„è¯ï¼Œarrä¹Ÿæ˜¯æŒ‡é’ˆè¡¨è¾¾å¼char str;str=parr;//parræ˜¯æŒ‡é’ˆè¡¨è¾¾å¼str=(parr+1);//(parr+1)æ˜¯æŒ‡é’ˆè¡¨è¾¾å¼str=(parr+2);//(parr+2)æ˜¯æŒ‡é’ˆè¡¨è¾¾å¼ ç”±äºæŒ‡é’ˆè¡¨è¾¾å¼çš„ç»“æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæ‰€ä»¥æŒ‡é’ˆè¡¨è¾¾å¼ä¹Ÿå…·æœ‰æŒ‡é’ˆæ‰€å…·æœ‰çš„å››ä¸ªè¦ç´ ï¼šæŒ‡é’ˆçš„ç±»å‹ï¼ŒæŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹ï¼ŒæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åŒºï¼ŒæŒ‡é’ˆè‡ªèº«å æ®çš„å†…å­˜ã€‚å¥½äº†ï¼Œå½“ä¸€ä¸ªæŒ‡é’ˆè¡¨è¾¾å¼çš„ç»“æœæŒ‡é’ˆå·²ç»æ˜ç¡®åœ°å…·æœ‰äº†æŒ‡é’ˆè‡ªèº«å æ®çš„å†…å­˜çš„è¯ï¼Œè¿™ä¸ªæŒ‡é’ˆè¡¨è¾¾å¼å°±æ˜¯ä¸€ä¸ªå·¦å€¼ï¼Œå¦åˆ™å°±ä¸æ˜¯ä¸€ä¸ªå·¦å€¼ã€‚åœ¨ä¾‹ä¸ƒä¸­ï¼Œ&amp;aä¸æ˜¯ä¸€ä¸ªå·¦å€¼ï¼Œå› ä¸ºå®ƒè¿˜æ²¡æœ‰å æ®æ˜ç¡®çš„å†…å­˜ã€‚ptræ˜¯ä¸€ä¸ªå·¦å€¼ï¼Œå› ä¸ºptrè¿™ä¸ªæŒ‡é’ˆå·²ç»å æ®äº†å†…å­˜ï¼Œå…¶å®ptrå°±æ˜¯æŒ‡é’ˆpaï¼Œæ—¢ç„¶paå·²ç»åœ¨å†…å­˜ä¸­æœ‰äº†è‡ªå·±çš„ä½ç½®ï¼Œé‚£ä¹ˆptrå½“ç„¶ä¹Ÿæœ‰äº†è‡ªå·±çš„ä½ç½®ã€‚ ç¬¬äº”ç«  æ•°ç»„å’ŒæŒ‡é’ˆçš„å…³ç³» å¦‚æœå¯¹å£°æ˜æ•°ç»„çš„è¯­å¥ä¸å¤ªæ˜ç™½çš„è¯ï¼Œè¯·å‚é˜…æˆ‘å‰æ®µæ—¶é—´è´´å‡ºçš„æ–‡?lt;&lt;å¦‚ä½•ç†è§£cå’Œc++çš„å¤æ‚ç±»å‹å£°æ˜&gt;&gt;ã€‚æ•°ç»„çš„æ•°ç»„åå…¶å®å¯ä»¥çœ‹ä½œä¸€ä¸ªæŒ‡é’ˆã€‚çœ‹ä¸‹ä¾‹ï¼šä¾‹å…«ï¼šint array[10]={0,1,2,3,4,5,6,7,8,9},value;â€¦â€¦value=array[0];//ä¹Ÿå¯å†™æˆï¼švalue=array;value=array[3];//ä¹Ÿå¯å†™æˆï¼švalue=(array+3);value=array[4];//ä¹Ÿå¯å†™æˆï¼švalue=(array+4);ä¸Šä¾‹ä¸­ï¼Œä¸€èˆ¬è€Œè¨€æ•°ç»„åarrayä»£è¡¨æ•°ç»„æœ¬èº«ï¼Œç±»å‹æ˜¯int [10]ï¼Œä½†å¦‚æœæŠŠarrayçœ‹åšæŒ‡é’ˆçš„è¯ï¼Œå®ƒæŒ‡å‘æ•°ç»„çš„ç¬¬0ä¸ªå•å…ƒï¼Œç±»å‹æ˜¯int ï¼Œæ‰€æŒ‡å‘çš„ç±»å‹æ˜¯æ•°ç»„å•å…ƒçš„ç±»å‹å³intã€‚å› æ­¤arrayç­‰äº0å°±ä¸€ç‚¹ä¹Ÿä¸å¥‡æ€ªäº†ã€‚åŒç†ï¼Œarray+3æ˜¯ä¸€ä¸ªæŒ‡å‘æ•°ç»„ç¬¬3ä¸ªå•å…ƒçš„æŒ‡é’ˆï¼Œæ‰€ä»¥(array+3)ç­‰äº3ã€‚å…¶å®ƒä¾æ­¤ç±»æ¨ã€‚ ä¾‹ä¹ï¼šä¾‹ä¹ï¼šchar str[3]={â€œHello,this is a sample!â€,â€œHi,good morning.â€,â€œHello worldâ€};char s[80]ï¼›strcpy(s,str[0]);//ä¹Ÿå¯å†™æˆstrcpy(s,str);strcpy(s,str[1]);//ä¹Ÿå¯å†™æˆstrcpy(s,(str+1));strcpy(s,str[2]);//ä¹Ÿå¯å†™æˆstrcpy(s,(str+2));ä¸Šä¾‹ä¸­ï¼Œstræ˜¯ä¸€ä¸ªä¸‰å•å…ƒçš„æ•°ç»„ï¼Œè¯¥æ•°ç»„çš„æ¯ä¸ªå•å…ƒéƒ½æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™äº›æŒ‡é’ˆå„æŒ‡å‘ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚æŠŠæŒ‡é’ˆæ•°ç»„åstrå½“ä½œä¸€ä¸ªæŒ‡é’ˆçš„è¯ï¼Œå®ƒæŒ‡å‘æ•°ç»„çš„ç¬¬0å·å•å…ƒï¼Œå®ƒçš„ç±»å‹æ˜¯charï¼Œå®ƒæŒ‡å‘çš„ç±»å‹æ˜¯char ã€‚ strä¹Ÿæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒçš„ç±»å‹æ˜¯char*ï¼Œå®ƒæ‰€æŒ‡å‘çš„ç±»å‹æ˜¯charï¼Œå®ƒæŒ‡å‘çš„åœ°å€æ˜¯å­—ç¬¦ä¸²â€Hello,this is a sample!â€çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„åœ°å€ï¼Œå³â€™Hâ€™çš„åœ°å€ã€‚str+1ä¹Ÿæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒæŒ‡å‘æ•°ç»„çš„ç¬¬1å·å•å…ƒï¼Œå®ƒçš„ç±»å‹æ˜¯charï¼Œå®ƒæŒ‡å‘çš„ç±»å‹æ˜¯char ã€‚ (str+1)ä¹Ÿæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒçš„ç±»å‹æ˜¯char*ï¼Œå®ƒæ‰€æŒ‡å‘çš„ç±»å‹æ˜¯charï¼Œå®ƒæŒ‡å‘â€œHi,good morning.â€çš„ç¬¬ä¸€ä¸ªå­—ç¬¦â€™Hâ€™ï¼Œç­‰ç­‰ã€‚ ä¸‹é¢æ€»ç»“ä¸€ä¸‹æ•°ç»„çš„æ•°ç»„åçš„é—®é¢˜ã€‚å£°æ˜äº†ä¸€ä¸ªæ•°ç»„TYPE array[n]ï¼Œåˆ™æ•°ç»„åç§°arrayå°±æœ‰äº†ä¸¤é‡å«ä¹‰ï¼šç¬¬ä¸€ï¼Œå®ƒä»£è¡¨æ•´ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç±»å‹æ˜¯TYPE [n]ï¼›ç¬¬äºŒï¼Œå®ƒæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆçš„ç±»å‹æ˜¯TYPEï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘çš„ç±»å‹æ˜¯TYPEï¼Œä¹Ÿå°±æ˜¯æ•°ç»„å•å…ƒçš„ç±»å‹ï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åŒºå°±æ˜¯æ•°ç»„ç¬¬0å·å•å…ƒï¼Œè¯¥æŒ‡é’ˆè‡ªå·±å æœ‰å•ç‹¬çš„å†…å­˜åŒºï¼Œæ³¨æ„å®ƒå’Œæ•°ç»„ç¬¬0å·å•å…ƒå æ®çš„å†…å­˜åŒºæ˜¯ä¸åŒçš„ã€‚è¯¥æŒ‡é’ˆçš„å€¼æ˜¯ä¸èƒ½ä¿®æ”¹çš„ï¼Œå³ç±»ä¼¼array++çš„è¡¨è¾¾å¼æ˜¯é”™è¯¯çš„ã€‚åœ¨ä¸åŒçš„è¡¨è¾¾å¼ä¸­æ•°ç»„åarrayå¯ä»¥æ‰®æ¼”ä¸åŒçš„è§’è‰²ã€‚åœ¨è¡¨è¾¾å¼sizeof(array)ä¸­ï¼Œæ•°ç»„åarrayä»£è¡¨æ•°ç»„æœ¬èº«ï¼Œæ•…è¿™æ—¶sizeofå‡½æ•°æµ‹å‡ºçš„æ˜¯æ•´ä¸ªæ•°ç»„çš„å¤§å°ã€‚åœ¨è¡¨è¾¾å¼arrayä¸­ï¼Œarrayæ‰®æ¼”çš„æ˜¯æŒ‡é’ˆï¼Œå› æ­¤è¿™ä¸ªè¡¨è¾¾å¼çš„ç»“æœå°±æ˜¯æ•°ç»„ç¬¬0å·å•å…ƒçš„å€¼ã€‚sizeof(array)æµ‹å‡ºçš„æ˜¯æ•°ç»„å•å…ƒçš„å¤§å°ã€‚è¡¨è¾¾å¼array+nï¼ˆå…¶ä¸­n=0ï¼Œ1ï¼Œ2ï¼Œâ€¦.ã€‚ï¼‰ä¸­ï¼Œarrayæ‰®æ¼”çš„æ˜¯æŒ‡é’ˆï¼Œæ•…array+nçš„ç»“æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒçš„ç±»å‹æ˜¯TYPEï¼Œå®ƒæŒ‡å‘çš„ç±»å‹æ˜¯TYPEï¼Œå®ƒæŒ‡å‘æ•°ç»„ç¬¬nå·å•å…ƒã€‚æ•…sizeof(array+n)æµ‹å‡ºçš„æ˜¯æŒ‡é’ˆç±»å‹çš„å¤§å°ã€‚ä¾‹åï¼šint array[10];int (ptr)[10];ptr=&array;ä¸Šä¾‹ä¸­ptræ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒçš„ç±»å‹æ˜¯int ()[10]ï¼Œä»–æŒ‡å‘çš„ç±»å‹æ˜¯int [10]ï¼Œæˆ‘ä»¬ç”¨æ•´ä¸ªæ•°ç»„çš„é¦–åœ°å€æ¥åˆå§‹åŒ–å®ƒã€‚åœ¨è¯­å¥ptr=&amp;arrayä¸­ï¼Œarrayä»£è¡¨æ•°ç»„æœ¬èº«ã€‚ æœ¬èŠ‚ä¸­æåˆ°äº†å‡½æ•°sizeof()ï¼Œé‚£ä¹ˆæˆ‘æ¥é—®ä¸€é—®ï¼Œsizeof(æŒ‡é’ˆåç§°)æµ‹å‡ºçš„ç©¶ç«Ÿæ˜¯æŒ‡é’ˆè‡ªèº«ç±»å‹çš„å¤§å°å‘¢è¿˜æ˜¯æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹çš„å¤§å°ï¼Ÿç­”æ¡ˆæ˜¯å‰è€…ã€‚ä¾‹å¦‚ï¼š int (ptr)[10];åˆ™åœ¨32ä½ç¨‹åºä¸­ï¼Œæœ‰ï¼šsizeof(int()[10])==4sizeof(int [10])==40sizeof(ptr)==4å®é™…ä¸Šï¼Œsizeof(å¯¹è±¡)æµ‹å‡ºçš„éƒ½æ˜¯å¯¹è±¡è‡ªèº«çš„ç±»å‹çš„å¤§å°ï¼Œè€Œä¸æ˜¯åˆ«çš„ä»€ä¹ˆç±»å‹çš„å¤§å°ã€‚ ç¬¬å…­ç«  æŒ‡é’ˆå’Œç»“æ„ç±»å‹çš„å…³ç³» å¯ä»¥å£°æ˜ä¸€ä¸ªæŒ‡å‘ç»“æ„ç±»å‹å¯¹è±¡çš„æŒ‡é’ˆã€‚ä¾‹åä¸€ï¼šstruct MyStruct{int a;int b;int c;}MyStruct ss={20,30,40};//å£°æ˜äº†ç»“æ„å¯¹è±¡ssï¼Œå¹¶æŠŠssçš„ä¸‰ä¸ªæˆå‘˜åˆå§‹åŒ–ä¸º20ï¼Œ30å’Œ40ã€‚MyStruct ptr=&ss;//å£°æ˜äº†ä¸€ä¸ªæŒ‡å‘ç»“æ„å¯¹è±¡ssçš„æŒ‡é’ˆã€‚å®ƒçš„ç±»å‹æ˜¯MyStruct,å®ƒæŒ‡å‘çš„ç±»å‹æ˜¯MyStructã€‚int pstr=(int)&ss;//å£°æ˜äº†ä¸€ä¸ªæŒ‡å‘ç»“æ„å¯¹è±¡ssçš„æŒ‡é’ˆã€‚ä½†æ˜¯å®ƒçš„ç±»å‹å’Œå®ƒæŒ‡å‘çš„ç±»å‹å’Œptræ˜¯ä¸åŒçš„ã€‚ è¯·é—®æ€æ ·é€šè¿‡æŒ‡é’ˆptræ¥è®¿é—®ssçš„ä¸‰ä¸ªæˆå‘˜å˜é‡ï¼Ÿç­”æ¡ˆï¼šptr-&gt;a;ptr-&gt;b;ptr-&gt;c;åˆè¯·é—®æ€æ ·é€šè¿‡æŒ‡é’ˆpstræ¥è®¿é—®ssçš„ä¸‰ä¸ªæˆå‘˜å˜é‡ï¼Ÿç­”æ¡ˆï¼špstrï¼›//è®¿é—®äº†ssçš„æˆå‘˜aã€‚ (pstr+1);//è®¿é—®äº†ssçš„æˆå‘˜bã€‚(pstr+2)//è®¿é—®äº†ssçš„æˆå‘˜cã€‚å‘µå‘µï¼Œè™½ç„¶æˆ‘åœ¨æˆ‘çš„MSVC++6.0ä¸Šè°ƒå¼è¿‡ä¸Šè¿°ä»£ç ï¼Œä½†æ˜¯è¦çŸ¥é“ï¼Œè¿™æ ·ä½¿ç”¨pstræ¥è®¿é—®ç»“æ„æˆå‘˜æ˜¯ä¸æ­£è§„çš„ï¼Œä¸ºäº†è¯´æ˜ä¸ºä»€ä¹ˆä¸æ­£è§„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ€æ ·é€šè¿‡æŒ‡é’ˆæ¥è®¿é—®æ•°ç»„çš„å„ä¸ªå•å…ƒï¼šä¾‹åäºŒï¼šint array[3]={35,56,37};int pa=array;é€šè¿‡æŒ‡é’ˆpaè®¿é—®æ•°ç»„arrayçš„ä¸‰ä¸ªå•å…ƒçš„æ–¹æ³•æ˜¯ï¼špa;//è®¿é—®äº†ç¬¬0å·å•å…ƒ (pa+1);//è®¿é—®äº†ç¬¬1å·å•å…ƒ(pa+2);//è®¿é—®äº†ç¬¬2å·å•å…ƒä»æ ¼å¼ä¸Šçœ‹å€’æ˜¯ä¸é€šè¿‡æŒ‡é’ˆè®¿é—®ç»“æ„æˆå‘˜çš„ä¸æ­£è§„æ–¹æ³•çš„æ ¼å¼ä¸€æ ·ã€‚æ‰€æœ‰çš„C/C++ç¼–è¯‘å™¨åœ¨æ’åˆ—æ•°ç»„çš„å•å…ƒæ—¶ï¼Œæ€»æ˜¯æŠŠå„ä¸ªæ•°ç»„å•å…ƒå­˜æ”¾åœ¨è¿ç»­çš„å­˜å‚¨åŒºé‡Œï¼Œå•å…ƒå’Œå•å…ƒä¹‹é—´æ²¡æœ‰ç©ºéš™ã€‚ä½†åœ¨å­˜æ”¾ç»“æ„å¯¹è±¡çš„å„ä¸ªæˆå‘˜æ—¶ï¼Œåœ¨æŸç§ç¼–è¯‘ç¯å¢ƒä¸‹ï¼Œå¯èƒ½ä¼šéœ€è¦å­—å¯¹é½æˆ–åŒå­—å¯¹é½æˆ–è€…æ˜¯åˆ«çš„ä»€ä¹ˆå¯¹é½ï¼Œéœ€è¦åœ¨ç›¸é‚»ä¸¤ä¸ªæˆå‘˜ä¹‹é—´åŠ è‹¥å¹²?quot;å¡«å……å­—èŠ‚â€ï¼Œè¿™å°±å¯¼è‡´å„ä¸ªæˆå‘˜ä¹‹é—´å¯èƒ½ä¼šæœ‰è‹¥å¹²ä¸ªå­—èŠ‚çš„ç©ºéš™ã€‚æ‰€ä»¥ï¼Œåœ¨ä¾‹åäºŒä¸­ï¼Œå³ä½¿pstrè®¿é—®åˆ°äº†ç»“æ„å¯¹è±¡ssçš„ç¬¬ä¸€ä¸ªæˆå‘˜å˜é‡aï¼Œä¹Ÿä¸èƒ½ä¿è¯(pstr+1)å°±ä¸€å®šèƒ½è®¿é—®åˆ°ç»“æ„æˆå‘˜bã€‚å› ä¸ºæˆå‘˜aå’Œæˆå‘˜bä¹‹é—´å¯èƒ½ä¼šæœ‰è‹¥å¹²å¡«å……å­—èŠ‚ï¼Œè¯´ä¸å®š(pstr+1)å°±æ­£å¥½è®¿é—®åˆ°äº†è¿™äº›å¡«å……å­—èŠ‚å‘¢ã€‚è¿™ä¹Ÿè¯æ˜äº†æŒ‡é’ˆçš„çµæ´»æ€§ã€‚è¦æ˜¯ä½ çš„ç›®çš„å°±æ˜¯æƒ³çœ‹çœ‹å„ä¸ªç»“æ„æˆå‘˜ä¹‹é—´åˆ°åº•æœ‰æ²¡æœ‰å¡«å……å­—èŠ‚ï¼Œå˜¿ï¼Œè¿™å€’æ˜¯ä¸ªä¸é”™çš„æ–¹æ³•ã€‚é€šè¿‡æŒ‡é’ˆè®¿é—®ç»“æ„æˆå‘˜çš„æ­£ç¡®æ–¹æ³•åº”è¯¥æ˜¯è±¡ä¾‹åäºŒä¸­ä½¿ç”¨æŒ‡é’ˆptrçš„æ–¹æ³•ã€‚ ç¬¬ä¸ƒç«  æŒ‡é’ˆå’Œå‡½æ•°çš„å…³ç³» å¯ä»¥æŠŠä¸€ä¸ªæŒ‡é’ˆå£°æ˜æˆä¸ºä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆã€‚int fun1(char,int);int (pfun1)(char,int);pfun1=fun1;â€¦.â€¦.int a=(pfun1)(â€œabcdefgâ€,7);//é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°ã€‚å¯ä»¥æŠŠæŒ‡é’ˆä½œä¸ºå‡½æ•°çš„å½¢å‚ã€‚åœ¨å‡½æ•°è°ƒç”¨è¯­å¥ä¸­ï¼Œå¯ä»¥ç”¨æŒ‡é’ˆè¡¨è¾¾å¼æ¥ä½œä¸ºå®å‚ã€‚ä¾‹åä¸‰ï¼šint fun(char);int a;char str[]=â€abcdefghijklmnâ€;a=fun(str);â€¦â€¦int fun(chars){int num=0;for(int i=0;i{num+=*s;s++;}return num;)è¿™ä¸ªä¾‹å­ä¸­çš„å‡½æ•°funç»Ÿè®¡ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­å„ä¸ªå­—ç¬¦çš„ASCIIç å€¼ä¹‹å’Œã€‚å‰é¢è¯´äº†ï¼Œæ•°ç»„çš„åå­—ä¹Ÿæ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚åœ¨å‡½æ•°è°ƒç”¨ä¸­ï¼Œå½“æŠŠsträ½œä¸ºå®å‚ä¼ é€’ç»™å½¢å‚såï¼Œå®é™…æ˜¯æŠŠstrçš„å€¼ä¼ é€’ç»™äº†sï¼Œsæ‰€æŒ‡å‘çš„åœ°å€å°±å’Œstræ‰€æŒ‡å‘çš„åœ°å€ä¸€è‡´ï¼Œä½†æ˜¯strå’Œså„è‡ªå ç”¨å„è‡ªçš„å­˜å‚¨ç©ºé—´ã€‚åœ¨å‡½æ•°ä½“å†…å¯¹sè¿›è¡Œè‡ªåŠ 1è¿ç®—ï¼Œå¹¶ä¸æ„å‘³ç€åŒæ—¶å¯¹strè¿›è¡Œäº†è‡ªåŠ 1è¿ç®—ã€‚ ç¬¬å…«ç«  æŒ‡é’ˆç±»å‹è½¬æ¢ å½“æˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªæŒ‡é’ˆæˆ–ç»™ä¸€ä¸ªæŒ‡é’ˆèµ‹å€¼æ—¶ï¼Œèµ‹å€¼å·çš„å·¦è¾¹æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œèµ‹å€¼å·çš„å³è¾¹æ˜¯ä¸€ä¸ªæŒ‡é’ˆè¡¨è¾¾å¼ã€‚åœ¨æˆ‘ä»¬å‰é¢æ‰€ä¸¾çš„ä¾‹å­ä¸­ï¼Œç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒæŒ‡é’ˆçš„ç±»å‹å’ŒæŒ‡é’ˆè¡¨è¾¾å¼çš„ç±»å‹æ˜¯ä¸€æ ·çš„ï¼ŒæŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹å’ŒæŒ‡é’ˆè¡¨è¾¾å¼æ‰€æŒ‡å‘çš„ç±»å‹æ˜¯ä¸€æ ·çš„ã€‚ä¾‹åå››ï¼š1.float f=12.3; float *fptr=&f; int p;åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå‡å¦‚æˆ‘ä»¬æƒ³è®©æŒ‡é’ˆpæŒ‡å‘å®æ•°fï¼Œåº”è¯¥æ€ä¹ˆæï¼Ÿæ˜¯ç”¨ä¸‹é¢çš„è¯­å¥å—ï¼Ÿp=&f;ä¸å¯¹ã€‚å› ä¸ºæŒ‡é’ˆpçš„ç±»å‹æ˜¯intï¼Œå®ƒæŒ‡å‘çš„ç±»å‹æ˜¯intã€‚è¡¨è¾¾å¼&amp;fçš„ç»“æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡é’ˆçš„ç±»å‹æ˜¯float,å®ƒæŒ‡å‘çš„ç±»å‹æ˜¯floatã€‚ä¸¤è€…ä¸ä¸€è‡´ï¼Œç›´æ¥èµ‹å€¼çš„æ–¹æ³•æ˜¯ä¸è¡Œçš„ã€‚è‡³å°‘åœ¨æˆ‘çš„MSVC++6.0ä¸Šï¼Œå¯¹æŒ‡é’ˆçš„èµ‹å€¼è¯­å¥è¦æ±‚èµ‹å€¼å·ä¸¤è¾¹çš„ç±»å‹ä¸€è‡´ï¼Œæ‰€æŒ‡å‘çš„ç±»å‹ä¹Ÿä¸€è‡´ï¼Œå…¶å®ƒçš„ç¼–è¯‘å™¨ä¸Šæˆ‘æ²¡è¯•è¿‡ï¼Œå¤§å®¶å¯ä»¥è¯•è¯•ã€‚ä¸ºäº†å®ç°æˆ‘ä»¬çš„ç›®çš„ï¼Œéœ€è¦è¿›è¡Œâ€å¼ºåˆ¶ç±»å‹è½¬æ¢â€ï¼šp=(int)&f;å¦‚æœæœ‰ä¸€ä¸ªæŒ‡é’ˆpï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒçš„ç±»å‹å’Œæ‰€æŒ‡å‘çš„ç±»å‹æ”¹ä¸ºTYEPå’ŒTYPEï¼Œé‚£ä¹ˆè¯­æ³•æ ¼å¼æ˜¯ï¼š(TYPE)pï¼›è¿™æ ·å¼ºåˆ¶ç±»å‹è½¬æ¢çš„ç»“æœæ˜¯ä¸€ä¸ªæ–°æŒ‡é’ˆï¼Œè¯¥æ–°æŒ‡é’ˆçš„ç±»å‹æ˜¯TYPE*ï¼Œå®ƒæŒ‡å‘çš„ç±»å‹æ˜¯TYPEï¼Œå®ƒæŒ‡å‘çš„åœ°å€å°±æ˜¯åŸæŒ‡é’ˆæŒ‡å‘çš„åœ°å€ã€‚è€ŒåŸæ¥çš„æŒ‡é’ˆpçš„ä¸€åˆ‡å±æ€§éƒ½æ²¡æœ‰è¢«ä¿®æ”¹ã€‚ ä¸€ä¸ªå‡½æ•°å¦‚æœä½¿ç”¨äº†æŒ‡é’ˆä½œä¸ºå½¢å‚ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°è°ƒç”¨è¯­å¥çš„å®å‚å’Œå½¢å‚çš„ç»“åˆè¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šå‘ç”ŸæŒ‡é’ˆç±»å‹çš„è½¬æ¢ã€‚ä¾‹åäº”ï¼švoid fun(char);int a=125,b;fun((char)&amp;a);â€¦â€¦void fun(chars){char c;c=(s+3);(s+3)=(s+0);(s+0)=c;c=(s+2);(s+2)=(s+1);(s+1)=c;}}æ³¨æ„è¿™æ˜¯ä¸€ä¸ª32ä½ç¨‹åºï¼Œæ•…intç±»å‹å äº†å››ä¸ªå­—èŠ‚ï¼Œcharç±»å‹å ä¸€ä¸ªå­—èŠ‚ã€‚å‡½æ•°funçš„ä½œç”¨æ˜¯æŠŠä¸€ä¸ªæ•´æ•°çš„å››ä¸ªå­—èŠ‚çš„é¡ºåºæ¥ä¸ªé¢ å€’ã€‚æ³¨æ„åˆ°äº†å—ï¼Ÿåœ¨å‡½æ•°è°ƒç”¨è¯­å¥ä¸­ï¼Œå®å‚&amp;açš„ç»“æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒçš„ç±»å‹æ˜¯int ï¼Œå®ƒæŒ‡å‘çš„ç±»å‹æ˜¯intã€‚å½¢å‚è¿™ä¸ªæŒ‡é’ˆçš„ç±»å‹æ˜¯charï¼Œå®ƒæŒ‡å‘çš„ç±»å‹æ˜¯charã€‚è¿™æ ·ï¼Œåœ¨å®å‚å’Œå½¢å‚çš„ç»“åˆè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»è¿›è¡Œä¸€æ¬¡ä»intç±»å‹åˆ°charç±»å‹çš„è½¬æ¢ã€‚ç»“åˆè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥æƒ³è±¡ç¼–è¯‘å™¨è¿›è¡Œè½¬æ¢çš„è¿‡ç¨‹ï¼šç¼–è¯‘å™¨å…ˆæ„é€ ä¸€ä¸ªä¸´æ—¶æŒ‡é’ˆ chartempï¼Œç„¶åæ‰§è¡Œtemp=(char)&amp;aï¼Œæœ€åå†æŠŠtempçš„å€¼ä¼ é€’ç»™sã€‚æ‰€ä»¥æœ€åçš„ç»“æœæ˜¯ï¼šsçš„ç±»å‹æ˜¯char,å®ƒæŒ‡å‘çš„ç±»å‹æ˜¯charï¼Œå®ƒæŒ‡å‘çš„åœ°å€å°±æ˜¯açš„é¦–åœ°å€ã€‚ æˆ‘ä»¬å·²ç»çŸ¥é“ï¼ŒæŒ‡é’ˆçš„å€¼å°±æ˜¯æŒ‡é’ˆæŒ‡å‘çš„åœ°å€ï¼Œåœ¨32ä½ç¨‹åºä¸­ï¼ŒæŒ‡é’ˆçš„å€¼å…¶å®æ˜¯ä¸€ä¸ª32ä½æ•´æ•°ã€‚é‚£å¯ä¸å¯ä»¥æŠŠä¸€ä¸ªæ•´æ•°å½“ä½œæŒ‡é’ˆçš„å€¼ç›´æ¥èµ‹ç»™æŒ‡é’ˆå‘¢ï¼Ÿå°±è±¡ä¸‹é¢çš„è¯­å¥ï¼šunsigned int a;TYPE ptr;//TYPEæ˜¯intï¼Œcharæˆ–ç»“æ„ç±»å‹ç­‰ç­‰ç±»å‹ã€‚â€¦â€¦a=20345686;ptr=20345686;//æˆ‘ä»¬çš„ç›®çš„æ˜¯è¦ä½¿æŒ‡é’ˆptræŒ‡å‘åœ°å€20345686ï¼ˆåè¿›åˆ¶ï¼‰ptr=a;//æˆ‘ä»¬çš„ç›®çš„æ˜¯è¦ä½¿æŒ‡é’ˆptræŒ‡å‘åœ°å€20345686ï¼ˆåè¿›åˆ¶ï¼‰ç¼–è¯‘ä¸€ä¸‹å§ã€‚ç»“æœå‘ç°åé¢ä¸¤æ¡è¯­å¥å…¨æ˜¯é”™çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„ç›®çš„å°±ä¸èƒ½è¾¾åˆ°äº†å—ï¼Ÿä¸ï¼Œè¿˜æœ‰åŠæ³•ï¼šunsigned int a;TYPE ptr;//TYPEæ˜¯intï¼Œcharæˆ–ç»“æ„ç±»å‹ç­‰ç­‰ç±»å‹ã€‚â€¦â€¦a=æŸä¸ªæ•°ï¼Œè¿™ä¸ªæ•°å¿…é¡»ä»£è¡¨ä¸€ä¸ªåˆæ³•çš„åœ°å€ï¼›ptr=(TYPE)aï¼›//å‘µå‘µï¼Œè¿™å°±å¯ä»¥äº†ã€‚ä¸¥æ ¼è¯´æ¥è¿™é‡Œçš„(TYPE)å’ŒæŒ‡é’ˆç±»å‹è½¬æ¢ä¸­çš„(TYPE)è¿˜ä¸ä¸€æ ·ã€‚è¿™é‡Œçš„(TYPE)çš„æ„æ€æ˜¯æŠŠæ— ç¬¦å·æ•´æ•°açš„å€¼å½“ä½œä¸€ä¸ªåœ°å€æ¥çœ‹å¾…ã€‚ä¸Šé¢å¼ºè°ƒäº†açš„å€¼å¿…é¡»ä»£è¡¨ä¸€ä¸ªåˆæ³•çš„åœ°å€ï¼Œå¦åˆ™çš„è¯ï¼Œåœ¨ä½ ä½¿ç”¨ptrçš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç°éæ³•æ“ä½œé”™è¯¯ã€‚ æƒ³æƒ³èƒ½ä¸èƒ½åè¿‡æ¥ï¼ŒæŠŠæŒ‡é’ˆæŒ‡å‘çš„åœ°å€å³æŒ‡é’ˆçš„å€¼å½“ä½œä¸€ä¸ªæ•´æ•°å–å‡ºæ¥ã€‚å®Œå…¨å¯ä»¥ã€‚ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†æŠŠä¸€ä¸ªæŒ‡é’ˆçš„å€¼å½“ä½œä¸€ä¸ªæ•´æ•°å–å‡ºæ¥ï¼Œç„¶åå†æŠŠè¿™ä¸ªæ•´æ•°å½“ä½œä¸€ä¸ªåœ°å€èµ‹ç»™ä¸€ä¸ªæŒ‡é’ˆï¼šä¾‹åå…­ï¼šint a=123,b;int ptr=&a;char str;b=(int)ptr;//æŠŠæŒ‡é’ˆptrçš„å€¼å½“ä½œä¸€ä¸ªæ•´æ•°å–å‡ºæ¥ã€‚str=(char*)b;//æŠŠè¿™ä¸ªæ•´æ•°çš„å€¼å½“ä½œä¸€ä¸ªåœ°å€èµ‹ç»™æŒ‡é’ˆstrã€‚ å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»çŸ¥é“äº†ï¼Œå¯ä»¥æŠŠæŒ‡é’ˆçš„å€¼å½“ä½œä¸€ä¸ªæ•´æ•°å–å‡ºæ¥ï¼Œä¹Ÿå¯ä»¥æŠŠä¸€ä¸ªæ•´æ•°å€¼å½“ä½œåœ°å€èµ‹ç»™ä¸€ä¸ªæŒ‡é’ˆã€‚ ç¬¬ä¹ç«  æŒ‡é’ˆçš„å®‰å…¨é—®é¢˜ çœ‹ä¸‹é¢çš„ä¾‹å­ï¼šä¾‹åä¸ƒï¼šchar s=â€™aâ€™;int ptr;ptr=(int)&s;ptr=1298ï¼›æŒ‡é’ˆptræ˜¯ä¸€ä¸ªintç±»å‹çš„æŒ‡é’ˆï¼Œå®ƒæŒ‡å‘çš„ç±»å‹æ˜¯intã€‚å®ƒæŒ‡å‘çš„åœ°å€å°±æ˜¯sçš„é¦–åœ°å€ã€‚åœ¨32ä½ç¨‹åºä¸­ï¼Œså ä¸€ä¸ªå­—èŠ‚ï¼Œintç±»å‹å å››ä¸ªå­—èŠ‚ã€‚æœ€åä¸€æ¡è¯­å¥ä¸ä½†æ”¹å˜äº†sæ‰€å çš„ä¸€ä¸ªå­—èŠ‚ï¼Œè¿˜æŠŠå’Œsç›¸ä¸´çš„é«˜åœ°å€æ–¹å‘çš„ä¸‰ä¸ªå­—èŠ‚ä¹Ÿæ”¹å˜äº†ã€‚è¿™ä¸‰ä¸ªå­—èŠ‚æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿåªæœ‰ç¼–è¯‘ç¨‹åºçŸ¥é“ï¼Œè€Œå†™ç¨‹åºçš„äººæ˜¯ä¸å¤ªå¯èƒ½çŸ¥é“çš„ã€‚ä¹Ÿè®¸è¿™ä¸‰ä¸ªå­—èŠ‚é‡Œå­˜å‚¨äº†éå¸¸é‡è¦çš„æ•°æ®ï¼Œä¹Ÿè®¸è¿™ä¸‰ä¸ªå­—èŠ‚é‡Œæ­£å¥½æ˜¯ç¨‹åºçš„ä¸€æ¡ä»£ç ï¼Œè€Œç”±äºä½ å¯¹æŒ‡é’ˆçš„é©¬è™åº”ç”¨ï¼Œè¿™ä¸‰ä¸ªå­—èŠ‚çš„å€¼è¢«æ”¹å˜äº†ï¼è¿™ä¼šé€ æˆå´©æºƒæ€§çš„é”™è¯¯ã€‚è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¾‹ï¼šä¾‹åå…«ï¼š char a; int *ptr=&a;â€¦â€¦ ptr++; ptr=115;è¯¥ä¾‹å­å®Œå…¨å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œå¹¶èƒ½æ‰§è¡Œã€‚ä½†æ˜¯çœ‹åˆ°æ²¡æœ‰ï¼Ÿç¬¬3å¥å¯¹æŒ‡é’ˆptrè¿›è¡Œè‡ªåŠ 1è¿ç®—åï¼ŒptræŒ‡å‘äº†å’Œæ•´å½¢å˜é‡aç›¸é‚»çš„é«˜åœ°å€æ–¹å‘çš„ä¸€å—å­˜å‚¨åŒºã€‚è¿™å—å­˜å‚¨åŒºé‡Œæ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä»¬ä¸çŸ¥é“ã€‚æœ‰å¯èƒ½å®ƒæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ•°æ®ï¼Œç”šè‡³å¯èƒ½æ˜¯ä¸€æ¡ä»£ç ã€‚è€Œç¬¬4å¥ç«Ÿç„¶å¾€è¿™ç‰‡å­˜å‚¨åŒºé‡Œå†™å…¥ä¸€ä¸ªæ•°æ®ï¼è¿™æ˜¯ä¸¥é‡çš„é”™è¯¯ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨æŒ‡é’ˆæ—¶ï¼Œç¨‹åºå‘˜å¿ƒé‡Œå¿…é¡»éå¸¸æ¸…æ¥šï¼šæˆ‘çš„æŒ‡é’ˆç©¶ç«ŸæŒ‡å‘äº†å“ªé‡Œã€‚åœ¨ç”¨æŒ‡é’ˆè®¿é—®æ•°ç»„çš„æ—¶å€™ï¼Œä¹Ÿè¦æ³¨æ„ä¸è¦è¶…å‡ºæ•°ç»„çš„ä½ç«¯å’Œé«˜ç«¯ç•Œé™ï¼Œå¦åˆ™ä¹Ÿä¼šé€ æˆç±»ä¼¼çš„é”™è¯¯ã€‚åœ¨æŒ‡é’ˆçš„å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼šptr1=(TYPE)ptr2ä¸­ï¼Œå¦‚æœsizeof(ptr2çš„ç±»å‹)å¤§äºsizeof(ptr1çš„ç±»å‹)ï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨æŒ‡é’ˆptr1æ¥è®¿é—®ptr2æ‰€æŒ‡å‘çš„å­˜å‚¨åŒºæ—¶æ˜¯å®‰å…¨çš„ã€‚å¦‚æœsizeof(ptr2çš„ç±»å‹)å°äºsizeof(ptr1çš„ç±»å‹)ï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨æŒ‡é’ˆptr1æ¥è®¿é—®ptr2æ‰€æŒ‡å‘çš„å­˜å‚¨åŒºæ—¶æ˜¯ä¸å®‰å…¨çš„ã€‚è‡³äºä¸ºä»€ä¹ˆï¼Œè¯»è€…ç»“åˆä¾‹åä¸ƒæ¥æƒ³ä¸€æƒ³ï¼Œåº”è¯¥ä¼šæ˜ç™½çš„ã€‚","categories":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://sensitivemix.github.io/categories/å¼€å‘/"}],"tags":[{"name":"C Pointer","slug":"C-Pointer","permalink":"https://sensitivemix.github.io/tags/C-Pointer/"}]},{"title":"ä½ ä¸€å®šé‡åˆ° SqlServer å®‰è£…ä¾èµ–çš„å‘ä¹‹Microsoft SqlServer Management SDK SFC","slug":"ä½ ä¸€å®šé‡åˆ° SqlServer å®‰è£…ä¾èµ–çš„å‘ä¹‹Microsoft SqlServer Management SDK SFC","date":"2017-06-11T14:33:02.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2017/06/11/ä½ ä¸€å®šé‡åˆ° SqlServer å®‰è£…ä¾èµ–çš„å‘ä¹‹Microsoft SqlServer Management SDK SFC/","link":"","permalink":"https://sensitivemix.github.io/2017/06/11/ä½ ä¸€å®šé‡åˆ° SqlServer å®‰è£…ä¾èµ–çš„å‘ä¹‹Microsoft SqlServer Management SDK SFC/","excerpt":"","text":"I have installed MS SQL Server 2012 R2 and when I try to update model from database under EDMX file I am facing that error. Could not load file or assembly Microsoft.SqlServer.management.sdk.sfc version 11.0.0.0 Solutions: IF Microsoft.SqlServer.management.sdk.sfc version 12.0.0.0 cannot find by visual studioGoto: http://www.microsoft.com/en-us/download/details.aspx?id=42295 DownLoad: ENU\\x86\\SharedManagementObjects.msi for X64 OS ORENU\\x64\\SharedManagementObjects.msi for X64 OS (According to our computer) IF Microsoft.SqlServer.management.sdk.sfc version 11.0.0.0 cannot find by visual studioGoto: https://www.microsoft.com/en-us/download/details.aspx?id=35580 DownLoad: ENU\\x86\\SharedManagementObjects.msi for X64 OS ORENU\\x64\\SharedManagementObjects.msi for X64 OS (According to our computer) IF Microsoft.SqlServer.management.sdk.sfc version 10.0.0.0 cannot find by visual studioGoto: https://www.microsoft.com/en-us/download/details.aspx?id=26728 DownLoad: ENU\\x86\\SharedManagementObjects.msi for X64 OS ORENU\\x64\\SharedManagementObjects.msi for X64 OS (According to our computer) After intalled,and restart visual studio, you will find everything work normally.","categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://sensitivemix.github.io/categories/æ•°æ®åº“/"}],"tags":[{"name":"Database","slug":"Database","permalink":"https://sensitivemix.github.io/tags/Database/"},{"name":"SqlServer","slug":"SqlServer","permalink":"https://sensitivemix.github.io/tags/SqlServer/"}]},{"title":"ä»£ç è¦†ç›–ç‡å¿…çŸ¥å¿…ä¼š","slug":"ä»£ç è¦†ç›–ç‡å¿…çŸ¥å¿…ä¼š","date":"2017-06-11T14:32:16.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2017/06/11/ä»£ç è¦†ç›–ç‡å¿…çŸ¥å¿…ä¼š/","link":"","permalink":"https://sensitivemix.github.io/2017/06/11/ä»£ç è¦†ç›–ç‡å¿…çŸ¥å¿…ä¼š/","excerpt":"","text":"ä»£ç è¦†ç›–ç‡ï¼ˆCode Coverageï¼‰æ˜¯åæ˜ æµ‹è¯•ç”¨ä¾‹å¯¹è¢«æµ‹è½¯ä»¶è¦†ç›–ç¨‹åº¦çš„é‡è¦æŒ‡æ ‡ï¼Œä¹Ÿæ˜¯è¡¡é‡æµ‹è¯•å·¥ä½œè¿›å±•æƒ…å†µçš„é‡è¦æŒ‡æ ‡ã€‚å®ƒä¹Ÿæ˜¯å¯¹æµ‹è¯•å·¥ä½œè¿›è¡Œé‡åŒ–çš„é‡è¦æŒ‡æ ‡ä¹‹ä¸€ï¼Œæµ‹è¯•å·¥ä½œå¾€å¾€ä¸å¦‚å¼€å‘é‚£æ ·æ¿€åŠ¨äººå¿ƒï¼Œä¸€ä¸ªé‡è¦åŸå› ä¹‹ä¸€å°±æ˜¯æµ‹è¯•éš¾äºé‡åŒ–ï¼Œè€Œä»£ç è¦†ç›–ç‡æ°æ°æ˜¯è§£å†³ç€ä¸€é—®é¢˜çš„é‡è¦æŒ‡æ ‡ã€‚æ ¹æ®å…¶è¦†ç›–å†…å®¹çš„ä¸åŒï¼Œåˆå¯ä»¥ç»†åˆ†ä¸ºï¼šè¯­å¥è¦†ç›–ã€åˆ¤å®šè¦†ç›–ã€æ¡ä»¶è¦†ç›–ã€è·¯å¾„è¦†ç›–ä»¥åŠå¾ªç¯è¦†ç›–ç­‰ç­‰ï¼Œè¿™é‡Œæœ‰ä¸€ç¯‡å¾ˆå¥½çš„åšå®¢ã€Šä»£ç è¦†ç›–ç‡æµ…è°ˆã€‹ä»‹ç»äº†å„ç§ä¸åŒè¦†ç›–ç‡çš„å®šä¹‰ã€‚æœ‰çš„ç†è§£èµ·æ¥è¿˜æ˜¯è›®æ‹—å£çš„ï¼Œä½†å…¶å®ä¸éš¾ï¼Œç”¨åˆ°äº†å†çœ‹å°±æˆï¼åœ¨æ‰€æœ‰è¿™äº›è¦†ç›–ä¸­è¯­å¥è¦†ç›–ï¼ˆStatement coverageï¼‰æ˜¯æœ€ç®€å•çš„ï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ã€æœ€æœ‰æ•ˆçš„è¦†ç›–ç‡ï¼ŒVisual Studioé‡‡ç”¨çš„æ˜¯è¯­å¥è¦†ç›–ä¸­çš„åŸºæœ¬å—è¦†ç›–ï¼ˆBasic block coverageï¼‰ã€‚ å¯¹äºæ•æ·å¼€å‘å›¢é˜Ÿè€Œè¨€ï¼Œä»£ç è¦†ç›–ç‡æ˜¯æ¯ä¸ªSprintè¦å®Œæˆçš„ç¡¬æ€§è´¨é‡æ ‡å‡†ï¼ˆExit Criteriaï¼‰ä¹‹ä¸€ï¼Œè¦†ç›–ç‡é«˜ä½æ ¹æ®é¡¹ç›®çš„ä¸åŒè€Œä¸åŒï¼š75%ï¼Œ80%ç”šè‡³100%éƒ½æ˜¯å¯èƒ½çš„ã€‚ä»£ç è¦†ç›–ç‡æ˜¯ä¸€ä¸ªç™½ç›’æ¦‚å¿µï¼Œæ¯•ç«Ÿå®ƒæœ€ç»ˆè¿˜æ˜¯è¦è½å®åˆ°ä»£ç ã€‚æ—¢ç„¶ä»£ç è¦†ç›–ç‡å¦‚æ­¤é‡è¦ï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™è¯¥ç”¨å®ƒï¼Ÿè¯¥å¦‚ä½•ç”¨å®ƒï¼Ÿ æœ‰äººè®¤ä¸ºä»£ç è¦†ç›–ç‡é‡è¦ï¼Œæ‰€ä»¥ä»é¡¹ç›®çš„ä¸€å¼€å§‹å°±è¦è¿›è¡Œä»£ç è¦†ç›–ç‡çš„æ£€æŸ¥å’Œåˆ†æï¼Œå³ è·å–è¦†ç›–ç‡ â€“&gt; å‘ç°æœªè¦†ç›–çš„ä»£ç  â€“&gt; æ·»åŠ æ–°æµ‹è¯•ç”¨ä¾‹ã€‚è¿™æ ·çš„ä½¿ç”¨æ–¹å¼ï¼Œæˆ‘æŠŠå®ƒå‘½åä¸ºâ€œ**ä»£ç è¦†ç›–ç‡é©±åŠ¨çš„æµ‹è¯•ï¼ˆCCDTï¼ŒCode Coverage Driven Testï¼‰**â€ã€‚CCDTçœ‹èµ·æ¥å¾ˆç¾ï¼Œç†è®ºä¸Šæ— æ‡ˆå¯å‡»ï¼Œä½†å®é™…æ“ä½œåˆ™å®Œå…¨ä¸æ˜¯é‚£ä¹ˆå›äº‹å„¿ã€‚å…ˆä¸è¯´è¿™ç§æ–¹å¼æ˜¯å¦æ­£ç¡®ï¼Œå•å°±ç”±æ­¤å¼•å…¥çš„å¼€é”€æ¥è¯´ï¼Œå°±å¤Ÿé¡¹ç›®ç»„å–ä¸€å£¶çš„ï¼Œå‘µå‘µï¼ä¹‹æ‰€è¿™æ ·è¯´ï¼Œæ˜¯å› ä¸ºCCDTéœ€è¦ç»å†ï¼šè·å–è¦†ç›–ç‡ã€åˆ†æè¦†ç›–ç‡å’Œæ·»åŠ æµ‹è¯•ç”¨ä¾‹è¿™ä¸‰æ­¥ï¼Œæ¯ä¸€æ­¥éƒ½å­˜åœ¨ç€å¾ˆå¤šæ½œåœ¨â€œå‰¯äº§å“â€å¼€é”€ï¼Œå°¤å…¶æ˜¯å‰ä¸¤æ­¥ã€‚è¦è·å–è¦†ç›–ç‡ï¼Œéœ€è¦æ‰§è¡Œæ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹ï¼Œè€Œä½ çŸ¥é“ç°åœ¨ä¸šç•Œ70%çš„æµ‹è¯•ä»ç„¶æ˜¯æ‰‹åŠ¨çš„ï¼Œä»…ä¸ºäº†è¦†ç›–ç‡å°±é¢‘ç¹çš„æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œæ˜¾ç„¶æ˜¯ä¸ç°å®çš„ï¼›é¢‘ç¹åˆ†æè¦†ç›–ç‡ç»“æœä¹Ÿæ˜¯ä¸€ä»¶è€—æ—¶çš„å·¥ä½œï¼Œæ— è®ºå¼€å‘äººå‘˜è¿˜æ˜¯æµ‹è¯•äººå‘˜åšéƒ½æ˜¯å¦‚æ­¤ï¼Œå°¤å…¶æ˜¯å¯¹äºé‡‡ç”¨æ•æ·å¼€å‘æ–¹æ³•çš„å›¢é˜Ÿï¼ŒçŸ­è¿­ä»£ä¸å…è®¸å¼•å…¥å¦‚æ­¤åŠ³ç¥çš„å·¥ä½œå†…å®¹ã€‚èƒ¡å‡¯åœ¨ä»–çš„åšå®¢ä¸­ç§°è¿™ç§å”¯è¦†ç›–ç‡è®ºç—‡çŠ¶ä¸ºâ€œ[æµ‹è¯•è¦†ç›–ç‡å¼ºè¿«ç—‡](http://www.infoq.com/cn/articles/test-coverage-ocd)â€ï¼Œå…¶ä¸­æœ‰ä¸€å¥æè¿°å¾ˆç²¾å½©ï¼š â€œ æµ‹è¯•è¦†ç›–ç‡ä»…ä»…èƒ½å¤Ÿå‘Šè¯‰å›¢é˜Ÿä»€ä¹ˆæ²¡æœ‰è¢«æµ‹è¯•ï¼Œæ ¹æœ¬å°±å›ç­”ä¸äº†è½¯ä»¶æ˜¯å¦ç»è¿‡äº†æœ‰æ•ˆæµ‹è¯•ï¼â€ æˆ‘è®¤ä¸ºå¯¹äºæµ‹è¯•å›¢é˜Ÿè€Œè¨€ï¼Œæµ‹è¯•çš„è¿‡ç¨‹åº”è¯¥æ˜¯**ç”¨æˆ·åœºæ™¯è¦†ç›–é©±åŠ¨çš„æµ‹è¯•ï¼ˆUSCDTï¼ŒUser Scenario Coverage Driven Testï¼‰** ï¼Œå³æµ‹è¯•äººå‘˜åº”è¯¥ä»ç”¨æˆ·çœŸå®ä½¿ç”¨åœºæ™¯å‡ºå‘ï¼Œæ€è€ƒè¦æµ‹è¯•çš„å†…å®¹å’Œè®¾è®¡æµ‹è¯•ç”¨ä¾‹ã€‚ä»£ç è¦†ç›–ç‡æ˜¯å¯¹USCDTçš„**å¿…è¦è¡¥å……**ï¼Œä»¥å‘ç°å…¶ä¸­æœªè¦†ç›–çš„åœºæ™¯ï¼ˆTest Holeï¼‰ã€‚ä»£ç è¦†ç›–åº”è¯¥æ˜¯åœ¨é¡¹ç›®/è¿­ä»£çš„ä¸­åæœŸå¼•å…¥ï¼Œä¸ç”¨å¾ˆé¢‘ç¹ï¼Œç‚¹åˆ°ä¸ºæ­¢ï¼Œä¾‹å¦‚å¯¹ä¸€ä¸ª3-4å‘¨çš„è¿­ä»£ï¼Œ3æ¬¡çš„è¦†ç›–ç‡æ£€æŸ¥å°±å·²ç»è¶³å¤Ÿäº†ã€‚å½“ç„¶ï¼Œå¦‚æœä½ çš„è‡ªåŠ¨åŒ–æµ‹è¯•æ¯”ä¾‹æ¯”è¾ƒé«˜ï¼Œé‡‡ç”¨æŒç»­é›†æˆï¼ˆContinuous Integrationï¼‰çš„æ–¹å¼ï¼Œä¾‹å¦‚ï¼šVisual Studio 2010ä¸­æŒç»­é›†æˆçš„æ„å»ºåŠŸèƒ½ï¼Œæ¯æ¬¡éƒ½èƒ½è‡ªåŠ¨çš„è¿›è¡Œä»£ç è¦†ç›–ç‡çš„ç»Ÿè®¡ï¼Œåˆ™å¯ä»¥æ›´æ—©ï¼Œæ›´é¢‘ç¹è¿›è¡Œä»£ç è¦†ç›–ç‡ï¼Œä½†å‰æä¸€å®šæ˜¯è¿™ä¸ä¼šå¸¦æ¥è¿‡å¤šçš„å¼€é”€ã€‚ è¯´äº†è¿™ä¹ˆå¤šï¼Œä¸‹é¢æ¥ç‚¹å„¿å®é™…çš„å§ï¼Œçœ‹çœ‹Visual Studio 2010ä¸­å¦‚ä½•è·å–ä»£ç è¦†ç›–ç‡æ•°æ®ï¼åœ¨Visual Studioçš„é›†æˆå¼€å‘ç¯å¢ƒä¸­è·è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹çš„ç è¦†ç›–ç‡æ•°æ®æ˜¯æœ€ç®€å•çš„ï¼ˆé‡‡ç”¨å‘½ä»¤è¡Œæ–¹å¼åˆ™ç¨å¤æ‚ä¸€äº›ï¼Œä½†å®ƒè¿˜å¯ä»¥ç”¨æ¥è·å–æ‰‹åŠ¨æµ‹è¯•ç”¨ä¾‹çš„è¦†ç›–æ•°æ®ï¼‰ï¼Œåªéœ€è¦ä¸‹é¢ä¸‰æ­¥: æ­¥éª¤ä¸€ ï¼šåœ¨Test Settingsé…ç½®ä¸­é€‰æ‹©Code Coverage (Updated 2011/6/1) è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå½“é€‰æ‹©Code Coverageé¡¹æ—¶ï¼Œè¿˜è¦é€‰æ‹©â€œConfigureâ€æŒ‰é’®å»é…ç½®ä¸€ä¸‹è¦é’ˆå¯¹å“ªä¸€ä¸ªæ–‡ä»¶ï¼ˆ.exe/.dlï¼‰æ”¶é›†è¦†ç›–æ•°æ®ï¼ŒVisual Studioä¼šè‡ªåŠ¨å¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œinstrumentæ“ä½œï¼Œå¦åˆ™æ˜¯ä¸ä¼šæ”¶é›†åˆ°è¦†ç›–æ•°æ®çš„ã€‚ æ­¥éª¤äºŒ ï¼šæ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ æ­¥éª¤ä¸‰ ï¼šæŸ¥çœ‹ä»£ç è¦†ç›–ç‡ç»“æœ éšç€ç¼–ç¨‹è¯­è¨€å’Œå¼€å‘å·¥å…·çš„ç°ä»£åŒ–å’Œå‚»ç“œåŒ–ï¼Œç°åœ¨è·å–å’Œåˆ†æä»£ç è¦†ç›–ç‡å·¥ä½œè¶Šæ¥è¶Šç®€å•äº†ï¼Œä½†äººä»¬å¯¹ä»£ç è¦†ç›–æ•°æ®çš„ä½¿ç”¨å´ä»ç„¶åœç•™åœ¨æ¯”è¾ƒåŸå§‹çš„é˜¶æ®µã€‚å…¶ä¸­è¿˜æœ‰å¾ˆå¤šå€¼å¾—å»æ·±å…¥å‘æ˜çš„å¥½ä¸œä¸œï¼Œç”¨äºå¸®åŠ©æµ‹è¯•å›¢é˜Ÿä¼˜åŒ–æµ‹è¯•è¿‡ç¨‹å’Œæµ‹è¯•ç”¨ä¾‹çš„è®¾è®¡ã€‚ã€Šä»£ç è¦†ç›–ä»ç®€åˆ°ç¹ (å››) â€“ ä¸ºä»£ç ç­¾å…¥æŠŠé—¨å„¿ ã€‹ä¸€æ–‡ä¸­ä»‹ç»äº†ï¼Œå¦‚ä½•åœ¨ä»£ç ç­¾å…¥çš„æµç¨‹ä¸­å¼•å…¥è¦†ç›–ç‡æ£€æŸ¥ã€‚","categories":[{"name":"æ€»ç»“","slug":"æ€»ç»“","permalink":"https://sensitivemix.github.io/categories/æ€»ç»“/"}],"tags":[{"name":"CI","slug":"CI","permalink":"https://sensitivemix.github.io/tags/CI/"},{"name":"CodeCoverage","slug":"CodeCoverage","permalink":"https://sensitivemix.github.io/tags/CodeCoverage/"}]},{"title":"é‚£äº›å¹´ç”¨è¿‡çš„ JQuery ä¹‹ç»å…¸ QQ è¡¨æƒ…æ’ä»¶","slug":"é‚£äº›å¹´ç”¨è¿‡çš„ JQuery ä¹‹ç»å…¸ QQ è¡¨æƒ…æ’ä»¶","date":"2017-06-11T14:26:45.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2017/06/11/é‚£äº›å¹´ç”¨è¿‡çš„ JQuery ä¹‹ç»å…¸ QQ è¡¨æƒ…æ’ä»¶/","link":"","permalink":"https://sensitivemix.github.io/2017/06/11/é‚£äº›å¹´ç”¨è¿‡çš„ JQuery ä¹‹ç»å…¸ QQ è¡¨æƒ…æ’ä»¶/","excerpt":"","text":"ç”±äºç›®å‰åœ¨æ¥è§¦èŠå¤©å®¤é¡¹ç›®ï¼Œæ¥åˆ°ä¸€ä¸ªéœ€æ±‚å®ç°ä¸€ä¸ªç±»ä¼¼QQè¡¨æƒ…ã€‚åœ¨ç½‘ä¸Šæ‰¾äº†ä¸€æ¬¾jqueryç»å…¸è¡¨æƒ…æ’ä»¶ã€‚ä¸‹é¢ä»‹ç»ä¸€ä¸ªç”¨æ³•ï¼š HTMLï¼š é¦–å…ˆåœ¨htmlé¡µé¢çš„headä¸­å¼•å…¥jQueryåº“æ–‡ä»¶å’ŒQQè¡¨æƒ…æ’ä»¶jquery.qqFace.jsæ–‡ä»¶ ç„¶ååœ¨bodyä¸­åŠ å…¥ä»¥ä¸‹htmlä»£ç ï¼š 1 div> 2 3 4 textarea> 5 è¡¨æƒ…span>p> 6 div> 7 div> CSSï¼š æˆ‘ä»¬ç”¨CSSæ¥ç¾åŒ–é¡µé¢ï¼Œå…³é”®æ˜¯è¡¨æƒ…æŒ‰é’®å›¾ç‰‡span.emotionçš„é¼ æ ‡æ»‘ä¸Šä¸ç§»å¼€æ•ˆæœï¼Œä»¥åŠè°ƒç”¨è¡¨æƒ…æ’ä»¶åï¼Œæ˜¾ç¤ºçš„è¡¨æƒ….qqFaceé¢æ¿æ•ˆæœï¼Œè¯·çœ‹ä»£ç : 1 .comment{width:680px; margin:20px auto; position:relative} 2 .comment h3{height:28px; line-height:28px} 3 .com_form{width:100%; position:relative} 4 .input{width:99%; height:60px; border:1px solid #ccc} 5 .com_form p{height:28px; line-height:28px; position:relative} 6 span.emotion{width:42px; height:20px; background:url(icon.gif) no-repeat 2px 2px; 7 padding-left:20px; cursor:pointer} 8 span.emotion:hover{background-position:2px -28px} 9 .qqFace{margin-top:4px;background:#fff;padding:2px;border:1px #dfe6f6 solid;} 10 .qqFace table td{padding:0px;} 11 .qqFace table td img{cursor:pointer;border:1px #fff solid;} 12 .qqFace table td img:hover{border:1px #0066cc solid;} 13 #show{width:680px; margin:20px auto} jquery: å½“æˆ‘ä»¬ç‚¹å‡»é¡µé¢è¾“å…¥æ¡†ä¸‹æ–¹é‚£ä¸ªç¬‘è„¸æ—¶ï¼Œè§¦å‘è°ƒç”¨qqfaceè¡¨æƒ…æ’ä»¶ï¼Œç®€å•å‡ è¡Œå°±æå®šã€‚ 1 $(function(){ 2 $('.emotion').qqFace({ 3 4 assign:'saytext', //ç»™è¾“å…¥æ¡†èµ‹å€¼ 5 path:'face/' //è¡¨æƒ…å›¾ç‰‡å­˜æ”¾çš„è·¯å¾„ 6 }); 7 ... 8 }); å½“é€‰æ‹©è¡¨æƒ…å›¾ç‰‡åï¼Œè¾“å…¥æ¡†ä¸­ä¼šæ’å…¥ä¸€æ®µå¦‚[em_5]ä¹‹ç±»çš„ä»£ç ï¼Œä»£è¡¨æ’å…¥çš„è¡¨æƒ…å›¾ç‰‡ï¼Œå®é™…åº”ç”¨ä¸­ï¼Œç‚¹æäº¤æŒ‰é’®ååº”è¯¥å°†è¿™æ®µè¡¨æƒ…ä»£ç è¿åŒå…¶ä»–å†…å®¹æ’å…¥åˆ°æ•°æ®è¡¨ä¸­ã€‚è€Œåœ¨é¡µé¢æ˜¾ç¤ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥å°†è¡¨æƒ…ä»£ç æ›¿æ¢æˆçœŸæ­£çš„å›¾ç‰‡æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚ä¸‹é¢çš„ä»£ç æ˜¯æ’å…¥è¡¨æƒ…å›¾ç‰‡åï¼Œç‚¹å‡»æäº¤æŒ‰é’®ï¼Œä½¿ç”¨javascriptè‡ªå®šä¹‰å‡½æ•°å°†è¡¨æƒ…ä»£ç æ›¿æ¢å¹¶æ˜¾ç¤ºï¼š 1 $(function(){ 2 ... 3 $(\".sub_btn\").click(function(){ 4 var str = $(\"#saytext\").val(); 5 $(\"#show\").html(replace_em(str)); 6 }); 7 }); 8 function replace_em(str){_ _9 str = str.replace(/\\g,'ï¼›'); 11 str = str.replace(/\\n/g,'ï¼›'); 12 str = str.replace(/[em_([0-9]*)]/g,''); 13 return str; 14 };'); str = str.replace(/\\n/g, ';'); str = str.replace(/[em_([0-9]*)]/g, ''); return str; }, //æäº¤èŠå¤©æ¶ˆæ¯å†…å®¹ submit: function () { var str = $(\"#Y_iSend_Input\").val(); $(\"#Y_iSend_Input\").val(CHAT.replace_em(str)); var message_text = d.getElementById(\"Y_iSend_Input\").value; } }","categories":[{"name":"å¼€å‘å·¥å…·","slug":"å¼€å‘å·¥å…·","permalink":"https://sensitivemix.github.io/categories/å¼€å‘å·¥å…·/"}],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://sensitivemix.github.io/tags/Javascript/"},{"name":"Jquery","slug":"Jquery","permalink":"https://sensitivemix.github.io/tags/Jquery/"}]},{"title":"websocket èŠå¤©å®¤","slug":"websocket èŠå¤©å®¤","date":"2017-06-11T14:25:57.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2017/06/11/websocket èŠå¤©å®¤/","link":"","permalink":"https://sensitivemix.github.io/2017/06/11/websocket èŠå¤©å®¤/","excerpt":"","text":"é‡‘è‚¡æ£’æ¶æ„åˆ†æä¸å‘å¸ƒåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€æ­¥æ­¥ç¼–å†™å‡ºæ¥èŠå¤©å®¤PCç«¯å’ŒAPPç«¯é‡æ–°åšä¸€æ¬¡æ¢³ç†ï¼Œä»¥åŠè¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼Œè®©æ•´ä¸ªé¡¹ç›®æ›´å®¹æ˜“ç†è§£å’Œæ‰©å±•ã€‚å…¶æ¬¡æˆ‘ä»¬è¿˜ä¼šä»‹ç»ä¸€äº›å‰ç«¯æµè¡Œçš„å·¥å…·ï¼Œå¸®åŠ©æˆ‘ä»¬æ„å»ºé¡¹ç›®ï¼Œä¾¿äºå‘å¸ƒã€‚ é¡¹ç›®ç»“æ„ç›®å‰PCç«¯å’ŒAPPç«¯é¡¹ç›®çš„æ¶æ„å¤§è‡´ç›¸ä¼¼ï¼Œå¦‚ä¸‹å›¾ï¼š ç®­å¤´ä»£è¡¨äº†è¯»å–æ•°æ®çš„æµå‘ï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åŸºæœ¬ä¸Šéƒ½åˆ†ä¸ºä¸‰å±‚ï¼š æœåŠ¡ç«¯ï¼šåœ¨MongoDBå’Œmongooseä¹‹ä¸Šï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€å±‚æ¨¡å‹çš„controllerï¼Œè¿™ä¸€å±‚ç›´æ¥å¤„ç†ä¸€äº›ä¸šåŠ¡ç›¸å…³çš„é€»è¾‘ï¼›åœ¨è¿™ä¹‹ä¸Šï¼Œæˆ‘ä»¬ç›´æ¥é€šè¿‡http APIæˆ–è€…socket.ioå°†æ‰€æä¾›çš„æ¥å£æš´éœ²å‡ºæ¥ï¼›è¿™ä¸€å—çš„ä»£ç å…¨éƒ¨å†™åœ¨äº†app.jsä¸­ï¼› å®¢æˆ·ç«¯ï¼šé’ˆå¯¹ä¸åŒçš„ç»„ä»¶æˆ–è€…é¡µé¢ï¼Œæˆ‘ä»¬å¯¹åº”äº†ä¸åŒçš„controllerï¼Œè€Œè¿™äº›controlleréƒ½æ˜¯é€šè¿‡$httpæˆ–è€…socket æœåŠ¡ç›´æ¥äºæœåŠ¡ç«¯é€šä¿¡çš„ï¼›å„ä¸ªcontrollerä¹‹é—´å…±äº«æ•°æ®å¾ˆå›°éš¾ã€‚ åŸºäºä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬åšå‡ºä»¥ä¸‹è°ƒæ•´ï¼š å°†æœåŠ¡ç«¯é€»è¾‘ä»app.jsåˆ†æ‹†ä¸ºhttpå’Œsocketä¸¤ä¸ªæœåŠ¡ä¸­ï¼› åœ¨å®¢æˆ·ç«¯æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ•°æ®æ¥å£å±‚ï¼Œå‘ä¸Šä¸ºcontrolleræä¾›æ•°æ®æœåŠ¡ï¼Œå‘ä¸‹å’ŒæœåŠ¡ç«¯é€šä¿¡ï¼ŒåŒæ­¥æ•°æ®ã€‚ æ–°çš„ç»“æ„åº”è¯¥åƒä¸‹é¢è¿™æ ·ï¼š åˆ†æ‹†httpå’ŒsocketæœåŠ¡é¦–å…ˆç®€åŒ–app.jsï¼š 123456789101112131415161718192021222324252627// ...var api = require(&apos;./services/api&apos;)var socketApi = require(&apos;./services/socketApi&apos;)// ...app.post(&apos;/api/login&apos;, api.login)app.get(&apos;/api/logout&apos;, api.logout)app.get(&apos;/api/validate&apos;, api.validate)// ...io.sockets.on(&apos;connection&apos;, function(socket) &#123; socketApi.connect(socket) socket.on(&apos;disconnect&apos;, function() &#123; socketApi.disconnect(socket) &#125;) socket.on(&apos;technode&apos;, function(request) &#123; socketApi[request.action](request.data, socket, io) &#125;)&#125;)// ... æˆ‘ä»¬æŠŠhttpå’Œsocketçš„å›è°ƒåˆ†åˆ«æ”¾åˆ°api.jså’ŒsocketApi.jsä¸­ï¼Œåœ¨socketé€šä¿¡æ–¹é¢åšäº†ç®€åŒ–ï¼Œä½¿ç”¨technodeä½œä¸ºç»Ÿä¸€çš„äº‹ä»¶åï¼Œè€Œéœ€è¦è°ƒç”¨çš„æ¥å£åï¼Œåˆ™ç”±è¯·æ±‚æ•°æ®ä¸­çš„actionæ¥å†³å®šã€‚æ¯ä¸ªsocketè¯·æ±‚éƒ½ä¼šå˜æˆä¸‹é¢è¿™æ ·ï¼š å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼š 123socket.emit(&apos;technode&apos;, &#123; action: &apos;getRoom&apos;&#125;) ä¸‹é¢æ˜¯æœåŠ¡ç«¯çš„è¿”å›ï¼š 1234567891011socket.emit(&apos;technode&apos;, &#123; &quot;action&quot;: &quot;getRoom&quot;, &quot;data&quot;: [&#123; &quot;name&quot;: &quot;Socket.IO&quot;, &quot;_id&quot;: &quot;52b0e5dd0a5e66fa26000001&quot;, &quot;__v&quot;: 0, &quot;createAt&quot;: &quot;2013-12-18T00:01:33.528Z&quot;, &quot;users&quot;: [], &quot;messages&quot;: [] &#125;]&#125;) å®¢æˆ·ç«¯åˆ™æ ¹æ®actionï¼Œè¿›è¡Œä¸åŒçš„å¤„ç†ï¼š 12345socket.on(&apos;technode&apos;, function (data) &#123; switch (data.action) &#123; // ... &#125;&#125;) è€Œæœ¬èº«api.jså’ŒsocketApi.jså†…çš„å¤„ç†ï¼Œä¸ç¬¬ä¸‰ç« çš„åŸºæœ¬æ— å¼‚ï¼Œä¸å†ç»†è¯´ã€‚ å®¢æˆ·ç«¯ç¼“å­˜ä¸ºä»€ä¹ˆéœ€è¦å®¢æˆ·ç«¯ç¼“å­˜ï¼Ÿæœ‰ä¸¤ç‚¹åŸå› ï¼š åœ¨ç¬¬ä¸‰ç« çš„å®ç°ä¸­ï¼Œåœ¨æˆ¿é—´åˆ—è¡¨å’Œæˆ¿é—´åˆ‡æ¢æ—¶ï¼Œcontrolleréƒ½ä¼šé€šè¿‡socketä»æœåŠ¡ç«¯é‡æ–°è·å–æˆ¿é—´åˆ—è¡¨æˆ–æˆ¿é—´ï¼› åœ¨ç¬¬ä¸‰ç« çš„å®ç°ä¸­ï¼Œæˆ‘ä»¬æ— æ³•åœ¨controllerä¹‹é—´å…±äº«æ•°æ®ï¼Œæ¯”å¦‚åœ¨LoginCtrlä¸­ï¼Œç”¨æˆ·ç™»å½•åï¼Œæˆ‘ä»¬éœ€è¦æ›´æ–°$rootScopeçš„ç”¨æˆ·ä¿¡æ¯ï¼Œé‡‡ç”¨äº†scopeäº‹ä»¶æœºåˆ¶æ¥å®ç°ã€‚ æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç¼“å­˜æ•°æ®å’Œå…±äº«æ•°æ®çš„ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶å°†æœåŠ¡ç«¯è¯·æ±‚æ¥çš„æ•°æ®ç¼“å­˜ä¸‹æ¥ï¼Œé¿å…é‡å¤çš„ä»æœåŠ¡ç«¯è¯·æ±‚ç›¸åŒçš„æ•°æ®ï¼Œå…¶æ¬¡æ˜¯å¯¹æ‰€æœ‰çš„controlleræä¾›æ¥å£ï¼Œè®©controlleré—´å¯ä»¥å…±äº«ï¼ˆè¯»å–ã€ä¿®æ”¹ï¼‰åŒä¸€ä»½æ•°æ®ã€‚ æˆ‘ä»¬æŠŠè¿™ä¸ªç»„ä»¶å‘½åä¸ºserverï¼Œä¸æœåŠ¡ç«¯é€šä¿¡å®Œå…¨é€šè¿‡è¿™ä¸ªç»„ä»¶ï¼Œæ•°æ®ç¼“å­˜åˆ°è¿™ä¸ªç»„ä»¶ä¹‹ä¸­ï¼Œcontrollerç›´æ¥ä¸å®ƒé€šä¿¡ï¼Œä¸å¿…å…³å¿ƒçœŸæ­£çš„æœåŠ¡å™¨æ˜¯ä»€ä¹ˆæ ·çš„ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839angular.module(&apos;techNodeApp&apos;).factory(&apos;server&apos;, [&apos;$cacheFactory&apos;, &apos;$q&apos;, &apos;$http&apos;, &apos;socket&apos;, function($cacheFactory, $q, $http, socket) &#123; var cache = window.cache = $cacheFactory(&apos;technode&apos;) socket.on(&apos;technode&apos;, function(data) &#123; switch (data.action) &#123; case &apos;getRoom&apos;: if (data._roomId) &#123; angular.extend(cache.get(data._roomId), data.data) &#125; else &#123; data.data.forEach(function (room) &#123; cache.get(&apos;rooms&apos;).push(room) &#125;) &#125; break // case something else // handle for socket events &#125; &#125;) socket.on(&apos;err&apos;, function (data) &#123; // handle server err &#125;) return &#123; validate: function() &#123; var deferred = $q.defer() $http(&#123; url: &apos;/api/validate&apos;, method: &apos;GET&apos; &#125;).success(function(user) &#123; angular.extend(cache.get(&apos;user&apos;), user) deferred.resolve() &#125;).error(function(data) &#123; deferred.reject() &#125;) return deferred.promise &#125; // more API &#125;&#125;]) åœ¨serverä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ä¸ªAngularæä¾›çš„ç»„ä»¶ï¼Œ$qå’Œ$cacheFactoryã€‚ $q$qæ˜¯Angularå¯¹JavaScriptå¼‚æ­¥ç¼–ç¨‹æ¨¡å¼Promiseçš„å®ç°ï¼Œå‚è€ƒäº†https://github.com/kriskowal/q ã€‚åœ¨TechNodeå¯¹å®ƒçš„ç”¨æ³•ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œä»…ä»…æ˜¯å°†Ajaxè¯·æ±‚éšè—èµ·æ¥ã€‚ä»¥server.validateä¸ºä¾‹ï¼š 12345678910111213validate: function() &#123; var deferred = $q.defer() $http(&#123; url: &apos;/api/validate&apos;, method: &apos;GET&apos; &#125;).success(function(user) &#123; angular.extend(cache.get(&apos;user&apos;), user) deferred.resolve() &#125;).error(function(data) &#123; deferred.reject() &#125;) return deferred.promise&#125; $q.defer()è·å–ä¸€ä¸ªdifferedï¼ˆæ¨è¿Ÿï¼‰å¯¹è±¡ï¼Œç„¶åreturn deferred.promiseå…ˆè¿”å›promiseï¼ˆæ‰¿è¯ºï¼‰ï¼Œåœ¨æœåŠ¡å™¨ç«¯æˆåŠŸè¿”å›åï¼Œresolveï¼ˆå…‘ç°ï¼‰æ‰¿è¯ºï¼Œæˆ–è€…é‡åˆ°é—®é¢˜ï¼Œrejectï¼ˆæ‹’ç»ï¼‰å…‘ç°ã€‚ åœ¨technode.jsä¸­æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨ï¼š 1234567server.validate().then(function() &#123; if ($location.path() === &apos;/login&apos;) &#123; $location.path(&apos;/rooms&apos;) &#125;&#125;, function() &#123; $location.path(&apos;/login&apos;)&#125;) server.validate()è·å–promiseï¼ˆæ‰¿è¯ºï¼‰å¯¹è±¡ï¼Œthen(resolvedCallback, rejectCallack)ï¼ˆç„¶åï¼‰æ ¹æ®æ‰¿è¯ºçš„å…‘ç°æƒ…å†µè¿›è¡Œä¸åŒçš„å¤„ç†ã€‚ æ¢å¥è¯è¯´ï¼Œtechnode.jsä¸­çš„techNodeAppé—®serverï¼Œç”¨æˆ·æ˜¯ä¸æ˜¯ç™»å½•äº†ï¼Œserverå¿…é¡»è°ƒç”¨æœåŠ¡ç«¯æ¥å£è¿›è¡ŒéªŒè¯ï¼Œå› æ­¤serverç»™techNodeAppè®¸è¯ºï¼ŒtechNodeAppåˆ™åªéœ€è¦é’ˆå¯¹è®¸è¯ºæ˜¯å¦å…‘ç°è¿›è¡Œå¤„ç†å°±å¥½äº†ã€‚ æ‰€æœ‰ä¸httpè¯·æ±‚ç›¸å…³çš„æ¥å£ï¼Œæˆ‘ä»¬éƒ½åšäº†ç›¸ä¼¼çš„å¤„ç†ã€‚ $cacheFactory$cacheFactoryæ˜¯Angularæä¾›çš„ç¼“å­˜ç»„ä»¶ï¼Œè¯¥ç»„ä»¶ç›´æ¥å°†æ•°æ®å­˜æ”¾åœ¨å†…å­˜ä¸­ã€‚ 123456789101112131415var cache = window.cache = $cacheFactory(&apos;technode&apos;)// ...cache.put(&apos;rooms&apos;, [])// ...cache.get(&apos;rooms&apos;) &amp;&amp; cache.get(&apos;rooms&apos;).forEach(function(room) &#123; if (room._id === _roomId) &#123; room.users = room.users.filter(function(user) &#123; return user._id !== _userId &#125;) &#125;&#125;) ç›´æ¥è°ƒç”¨$cacheFactoryï¼Œä¼ å…¥cacheIdï¼ŒAngularå°±ä¸ºæˆ‘æ„é€ å‡ºä¸€å—ç¼“å­˜åŒºåŸŸï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡getã€putç­‰ç­‰æ–¹æ³•æ¥å­˜å‚¨æˆ–è€…è·å–ç¼“å­˜æ•°æ®äº†ã€‚ $cacheFactoryè¿˜æä¾›äº†ä¸€ç§TechNodeä¸­æœªä½¿ç”¨çš„ç‰¹æ€§ï¼Œå³è¿™å—ç¼“å­˜å¯ä»¥æ˜¯LRUçš„ï¼Œä»€ä¹ˆæ˜¯LRUï¼Ÿå³è¿™å—ç¼“å­˜æ˜¯æœ‰å¤§å°çš„ï¼ˆé¿å…ç¼“å­˜å¼€é”€è¿‡å¤§ï¼Œå½±å“ç½‘æ˜“æ€§èƒ½ï¼‰ï¼Œå¹¶ä¸”è¿™å—ç¼“å­˜ä½¿ç”¨LRUç®—æ³•æ¥æ·˜æ±°é•¿æ—¶é—´æœªä½¿ç”¨çš„æ•°æ®ã€‚ controllerä¸serveræœ‰äº†serverï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹controlleræœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿè¿™æ˜¯åŸæ¥çš„RoomCtrlçš„ä»£ç ï¼š 12345678910111213141516171819202122angular.module(&apos;techNodeApp&apos;).controller(&apos;RoomCtrl&apos;, function($scope, $routeParams, $scope, socket) &#123; socket.on(&apos;rooms.read&apos; + $routeParams._roomId, function(room) &#123; $scope.room = room &#125;) socket.emit(&apos;rooms.read&apos;, &#123; _roomId: $routeParams._roomId &#125;) socket.on(&apos;messages.add&apos;, function(message) &#123; $scope.room.messages.push(message) &#125;) // ... socket.on(&apos;users.join&apos;, function (join) &#123; $scope.room.users.push(join.user) &#125;) socket.on(&apos;users.leave&apos;, function(leave) &#123; _userId = leave.user._id $scope.room.users = $scope.room.users.filter(function(user) &#123; return user._id != _userId &#125;) &#125;)&#125;) è¿™æ˜¯åŸºäºserverç»„ä»¶ä¿®æ”¹åçš„RoomCtrlï¼š 123456angular.module(&apos;techNodeApp&apos;).controller(&apos;RoomCtrl&apos;, [&apos;$scope&apos;, &apos;$routeParams&apos;, &apos;$scope&apos;, &apos;server&apos;, function($scope, $routeParams, $scope, server) &#123; $scope.room = server.getRoom($routeParams._roomId) // ...&#125;]) æˆ‘ä»¬å¯ä»¥å‘ç°å¦‚ä¸‹çš„å˜åŒ–ï¼š RoomCtrlä¸å†ç›´æ¥ä¸æœåŠ¡ç«¯é€šä¿¡è¯»å–å½“å‰çš„æˆ¿é—´ä¿¡æ¯ï¼› æ— éœ€ç›‘å¬ç”¨æˆ·è¿›å…¥ã€ç¦»å¼€æˆ–è€…æ–°æ¶ˆæ¯çš„äº‹ä»¶ã€‚ RoomCtrlåªéœ€è°ƒç”¨server.getRoomï¼Œä¼ å…¥æˆ¿é—´çš„idå³å¯ã€‚é‚£æˆ¿é—´ä¿¡æ¯ä¸æ˜¯éœ€è¦åˆ°æœåŠ¡ç«¯è¯»å–ä¹ˆï¼Ÿè¿™æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ è¿™å®Œå…¨å¾—ç›ŠäºAngularæ•°æ®ç»‘å®šç‰¹æ€§ï¼Œå³æ•°æ®å˜åŒ–ï¼Œè§†å›¾ä¹Ÿä¼šè·Ÿç€å˜åŒ–ï¼š 123456789101112131415getRoom: function(_roomId) &#123; if (!cache.get(_roomId)) &#123; cache.put(_roomId, &#123; users: [], messages: [] &#125;) socket.emit(&apos;technode&apos;, &#123; action: &apos;getRoom&apos;, data: &#123; _roomId: _roomId &#125; &#125;) &#125; return cache.get(_roomId)&#125; è¿™é‡Œçš„å¤„ç†æ–¹å¼ä¸promiseæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚getRoomæ–¹æ³•ï¼Œå¦‚æœåœ¨ç¼“å­˜ä¸­æ²¡æœ‰æ‰¾åˆ°æˆ¿é—´çš„æ•°æ®ï¼Œå°±å…ˆæ–°å»ºä¸€ä¸ªæˆ¿é—´å¯¹è±¡ï¼Œä¸è¿‡é‡Œé¢çš„æ•°æ®éƒ½æ˜¯ç©ºçš„ï¼ˆæ­¤æ—¶ï¼ŒRoomCtrlæ¸²æŸ“å‡ºæ¥çš„æ˜¯ä¸€ä¸ªç©ºçš„æˆ¿é—´è§†å›¾ï¼‰ï¼Œç„¶åé€šè¿‡socketå‘æœåŠ¡ç«¯è¯·æ±‚æˆ¿é—´æ•°æ®ï¼›å¦‚æœæ‰¾åˆ°å°±ç›´æ¥è¿”å›ä»ç¼“å­˜ä¸­è·å–çš„æˆ¿é—´æ•°æ®ï¼ŒRoomCtrlå°±å¯ä»¥æ¸²æŸ“å‡ºæ¥ä¸€ä¸ªæ­£å¸¸çš„æˆ¿é—´è§†å›¾ã€‚ è€Œåœ¨æœåŠ¡ç«¯è¿”å›æˆ¿é—´ä¿¡æ¯åï¼Œ 12345678case &apos;getRoom&apos;: if (data._roomId) &#123; angular.extend(cache.get(data._roomId), data.data) &#125; else &#123; data.data.forEach(function (room) &#123; cache.get(&apos;rooms&apos;).push(room) &#125;) &#125; æˆ‘ä»¬ä½¿ç”¨æœåŠ¡ç«¯çš„æ•°æ®å¡«å……åˆ°ç©ºæˆ¿é—´å³å¯ï¼ŒAngularå³æ ¹æ®æ•°æ®çš„å˜åŒ–ï¼Œæ¸²æŸ“å‡ºæ–°çš„æˆ¿é—´è§†å›¾ã€‚ æˆ‘ä»¬å¿…é¡»ä¿è¯æ›´æ–°çš„æˆ¿é—´å¯¹è±¡å¿…é¡»æ˜¯è§†å›¾ç»‘å®šçš„å¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬ä¸€å¼€å§‹å°±è¿”å›ä¸€ä¸ªæˆ¿é—´å¯¹è±¡ï¼Œåé¢åªæ˜¯ä¿®æ”¹è¿™ä¸ªå¯¹è±¡çš„å±æ€§ã€‚ åŒç†ï¼ŒRoomCtrlä¹Ÿæ— éœ€å‡ºæ¥ç”¨æˆ·è¿›å…¥æˆ–è€…ç¦»å¼€æˆ¿é—´ï¼Œæœ‰æ–°æ¶ˆæ¯è¿™ç±»äº‹ä»¶ï¼Œå› ä¸ºserverç»„ä»¶ä¼šè‡ªåŠ¨æ›´æ–°å¯¹åº”çš„æ•°æ®ï¼ŒRoomCtrlåªéœ€è¦æŒ‰ç…§æ•°æ®æ¸²æŸ“å³å¯ã€‚ å¥½äº†ï¼Œæˆ‘ä»¬åˆ©ç”¨å®¢æˆ·ç«¯ç¼“å­˜å’ŒAngularæ•°æ®ç»‘å®šç‰¹æ€§ï¼Œå¤§å¤§ç®€åŒ–äº†TechNodeæ§åˆ¶å™¨å±‚ã€‚åˆ°æ­¤ï¼Œæˆ‘ä»¬çš„å¼€å‘ä¹‹æ—…å·²ç»æ¥è¿‘å°¾å£°ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•å°†å‰ç«¯ç¨‹åºæ‰“åŒ…ï¼Œå‘å¸ƒï¼ ä½¿ç”¨Gruntæ‰“åŒ…TechNodeå¼€å‘æ—¶ï¼Œä¸ºäº†è§£è€¦å’Œä¾¿äºç»´æŠ¤ï¼Œæˆ‘ä»¬æŠŠä»£ç æ‹†æˆå•ç‹¬çš„æ–‡ä»¶ï¼ŒJavaScriptä»£ç ã€CSSä»£ç å’ŒHTMLéƒ½æ˜¯å•ç‹¬çš„ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™äº›åˆ†å¼€çš„æ–‡ä»¶åˆå¹¶åˆ°ä¸€èµ·ã€‚å¦‚æœä½ çš„ç½‘ç«™ä½¿ç”¨CDNçš„åŒ–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç»™æ¯ä¸ªç‰ˆæœ¬çš„æ–‡ä»¶ï¼Œæ·»åŠ ä¸Šå”¯ä¸€çš„æ ‡è¯†ï¼Œä¾¿äºç»´æŠ¤CDNçš„ç¼“å­˜ã€‚ Gruntæ˜¯ç›®å‰JavaScriptæœ€æµè¡Œçš„é¡¹ç›®è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ã€‚Gruntå®˜æ–¹æä¾›äº†å¾ˆå¤šæ’ä»¶ï¼Œä¹Ÿæœ‰å¤§é‡çš„ç¬¬ä¸‰æ–¹æ’ä»¶ã€‚æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°ä½¿ç”¨Gruntæ£€æŸ¥ã€å‹ç¼©åˆå¹¶ä»£ç ï¼Œç”šè‡³å‘å¸ƒåº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å°†åŸºäºgrunt-useminç­‰å‡ ä¸ªæµè¡Œçš„Gruntæ’ä»¶æ¥æ„å»ºTechNodeé¡¹ç›®ã€‚ é¦–å…ˆæˆ‘ä»¬éœ€è¦åšä¸€äº›å‡†å¤‡ï¼Œå®‰è£…Gruntå‘½ä»¤è¡Œå’Œè¿è¡Œæ—¶ï¼Œåœ¨TechNodeæ ¹ç›®å½•æ–°å»ºGruntfile.jsã€‚ 1npm install -g grunt-cli &amp;&amp; npm install grunt --save-dev &amp;&amp; touch Gruntfile.js ä¸ºäº†ä½¿ç”¨grunt-useminæ¥å‹ç¼©æˆ‘ä»¬çš„ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦åœ¨index.htmlæ·»åŠ ä¸€äº›ç‰¹æ®Šçš„æ³¨é‡Šæ¥æ¥å¸®åŠ©grunt-useminæ‰¾åˆ°éœ€è¦åˆå¹¶çš„æ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728&lt;!-- build:css /css/technode.css --&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/components/bootstrap/dist/css/bootstrap.min.css&quot;&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/styles/style.css&quot;&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/styles/login.css&quot;&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/styles/rooms.css&quot;&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/styles/room.css&quot;&gt;&lt;!-- endbuild --&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/socket.io/socket.io.js&quot;&gt;&lt;/script&gt;&lt;!-- build:js /script/technode.js --&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/components/jquery/jquery.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/components/bootstrap/dist/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/components/angular/angular.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/components/angular-route/angular-route.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/components/moment/moment.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/components/angular-moment/angular-moment.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/components/moment/lang/zh-cn.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/technode.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/services/socket.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/services/server.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/router.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/directives/auto-scroll-to-bottom.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/directives/ctrl-enter-break-line.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/controllers/login.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/controllers/rooms.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/controllers/room.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/controllers/message-creator.js&quot;&gt;&lt;/script&gt;&lt;!-- endbuild --&gt; æˆ‘ä»¬åˆ†åˆ«åœ¨csså’Œjavascriptçš„å¼•ç”¨å‘¨å›´åŠ ä¸Šäº†æ³¨é‡Šï¼Œ&lt;!-- build:css /css/technode.css --&gt;æ ‡æ˜æˆ‘ä»¬éœ€è¦æŠŠä¸‹é¢è¿™äº›csséƒ½åˆå¹¶åˆ°technode.cssè¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œjavascriptå…¨éƒ½åˆå¹¶åˆ°technode.jsä¸­ã€‚ æ³¨æ„ï¼Œsocket.io.jsè¿™ä¸ªæ–‡ä»¶å¹¶æ²¡æœ‰åŒ…å«è¿›æ¥ï¼Œå› ä¸ºå®ƒæ˜¯socket.ioè‡ªå·±è¾“å‡ºçš„ï¼Œå¹¶æ²¡æœ‰åœ¨æˆ‘ä»¬çš„è‡ªå·±çš„æºç ä¸­ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥æŠŠè¿™ä¸ªæ–‡ä»¶ä¿å­˜åˆ°æºç ä¸­ï¼Œè‡ªå·±å¼•ç”¨ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ é¦–å…ˆä½¿ç”¨grunt-contrib-copyå°†ä¸éœ€è¦æ‰“åŒ…å‹ç¼©çš„æ–‡ä»¶æ‹·è´åˆ°buildç›®å½•ä¸­ï¼Œä¿®æ”¹Gruntfile.js 123456789101112131415161718module.exports = function (grunt) &#123; grunt.initConfig(&#123; copy: &#123; main: &#123; files: [ &#123;expand: true, cwd: &apos;static/components/bootstrap/dist/fonts/&apos;, src: [&apos;**&apos;], dest: &apos;build/fonts&apos;&#125;, &#123;&apos;build/index.html&apos;: &apos;static/index.html&apos;&#125;, &#123;&apos;build/favicon.ico&apos;: &apos;static/favicon.ico&apos;&#125; ] &#125; &#125; &#125;) grunt.loadNpmTasks(&apos;grunt-contrib-copy&apos;) grunt.registerTask(&apos;default&apos;, [ &apos;copy&apos; ])&#125; grunt-useminä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªuseminPrepareçš„taskï¼Œè¿™ä¸ªtaskå°±æ˜¯åŸºäºæˆ‘ä»¬åœ¨index.htmlæ–‡ä»¶ä¸­çš„é…ç½®ï¼Œè‡ªåŠ¨ç”Ÿæˆåˆå¹¶å’Œå‹ç¼©ä»£ç çš„é…ç½®ï¼š 1234567891011121314151617181920212223242526module.exports = function (grunt) &#123; grunt.initConfig(&#123; copy: &#123; main: &#123; files: [ &#123;expand: true, cwd: &apos;static/components/bootstrap/dist/fonts/&apos;, src: [&apos;**&apos;], dest: &apos;build/fonts&apos;&#125;, &#123;&apos;build/index.html&apos;: &apos;static/index.html&apos;&#125;, &#123;&apos;build/favicon.ico&apos;: &apos;static/favicon.ico&apos;&#125; ] &#125; &#125;, useminPrepare: &#123; html: &apos;static/index.html&apos;, options: &#123; dest: &apos;build&apos; &#125; &#125; &#125;) grunt.loadNpmTasks(&apos;grunt-usemin&apos;) grunt.loadNpmTasks(&apos;grunt-contrib-copy&apos;) grunt.registerTask(&apos;default&apos;, [ &apos;copy&apos;, &apos;useminPrepare&apos; ])&#125; npm install grunt-usemin --save-devï¼Œè¿è¡Œgruntè¯•è¯•çœ‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647Running &quot;useminPrepare:html&quot; (useminPrepare) taskGoing through static/index.html to update the configLooking for build script HTML comment blocksConfiguration is now: concat: &#123; generated: &#123; files: [ &#123; dest: &apos;.tmp/concat/css/technode.css&apos;, src: [ &apos;static/components/bootstrap/dist/css/bootstrap.min.css&apos;, &apos;static/styles/style.css&apos;, &apos;static/styles/login.css&apos;, &apos;static/styles/rooms.css&apos;, &apos;static/styles/room.css&apos; ] &#125;, &#123; dest: &apos;.tmp/concat/script/technode.js&apos;, src: [ &apos;static/components/jquery/jquery.js&apos;, &apos;static/components/bootstrap/dist/js/bootstrap.min.js&apos;, &apos;static/components/angular/angular.js&apos;, &apos;static/components/angular-route/angular-route.js&apos;, &apos;static/components/moment/moment.js&apos;, &apos;static/components/angular-moment/angular-moment.js&apos;, &apos;static/components/moment/lang/zh-cn.js&apos;, &apos;static/technode.js&apos;, &apos;static/services/socket.js&apos;, &apos;static/services/server.js&apos;, &apos;static/router.js&apos;, &apos;static/directives/auto-scroll-to-bottom.js&apos;, &apos;static/directives/ctrl-enter-break-line.js&apos;, &apos;static/controllers/login.js&apos;, &apos;static/controllers/rooms.js&apos;, &apos;static/controllers/room.js&apos;, &apos;static/controllers/message-creator.js&apos; ] &#125; ] &#125; &#125; uglify: &#123; generated: &#123; files: [ &#123; dest: &apos;build/script/technode.js&apos;, src: [ &apos;.tmp/concat/script/technode.js&apos; ] &#125; ] &#125; &#125; cssmin: &#123; generated: &#123; files: [ &#123; dest: &apos;build/css/technode.css&apos;, src: [ &apos;.tmp/concat/css/technode.css&apos; ] &#125; ] &#125; &#125; å®ƒä¸ºæˆ‘ä»¬ç”Ÿæˆäº†æœ¬æ¥éœ€è¦æ‰‹åŠ¨ç¼–å†™çš„å…¶ä»–taskçš„é…ç½®ï¼Œæ¥ä¸‹æ¥ï¼Œå®‰è£…å…¶ä»–å‡ ä¸ªéœ€è¦çš„grunt taskï¼Œç»§ç»­ä¿®æ”¹Gruntfile.jsï¼š 1234567891011121314151617181920212223242526272829303132module.exports = function (grunt) &#123; grunt.initConfig(&#123; copy: &#123; main: &#123; files: [ &#123;expand: true, cwd: &apos;static/components/bootstrap/dist/fonts/&apos;, src: [&apos;**&apos;], dest: &apos;build/fonts&apos;&#125;, &#123;&apos;build/index.html&apos;: &apos;static/index.html&apos;&#125;, &#123;&apos;build/favicon.ico&apos;: &apos;static/favicon.ico&apos;&#125; ] &#125; &#125;, useminPrepare: &#123; html: &apos;static/index.html&apos;, options: &#123; dest: &apos;build&apos; &#125; &#125; &#125;) grunt.loadNpmTasks(&apos;grunt-usemin&apos;) grunt.loadNpmTasks(&apos;grunt-contrib-copy&apos;) grunt.loadNpmTasks(&apos;grunt-contrib-concat&apos;) grunt.loadNpmTasks(&apos;grunt-contrib-uglify&apos;) grunt.loadNpmTasks(&apos;grunt-contrib-cssmin&apos;) grunt.registerTask(&apos;default&apos;, [ &apos;copy&apos;, &apos;useminPrepare&apos;, &apos;concat&apos;, &apos;uglify&apos;, &apos;cssmin&apos; ])&#125; å®‰è£…å¥½æ–°çš„ä¾èµ–ï¼Œå†è¿è¡Œgruntè¯•è¯•çœ‹ã€‚é¦–å…ˆconcatæ ¹æ®useminPrepareç”Ÿæˆçš„é…ç½®ï¼Œå°†csså’Œjsåˆ†åˆ«åˆå¹¶åˆ°.tmp/concat/css/technode.csså’Œ.tmp/concat/script/technode.jsä¸­ï¼›ç„¶åuglifyå’Œcssminåˆ†åˆ«å°†è¿™ä¸¤ä¸ªæ–‡ä»¶å‹ç¼©æˆäº†build/css/technode.csså’Œbuild/script/technode.jsï¼Œæˆ‘ä»¬çš„cssæ–‡ä»¶å’Œjsæ–‡ä»¶å°±æ‰“åŒ…å‹ç¼©å¥½äº†ã€‚ é™¤æ­¤ä¹‹å¤–æˆ‘ä»¬è¿˜éœ€è¦æŠŠpagesä¸­çš„htmlå†…è”åˆ°index.htmlä¸­ã€‚åœ¨Angularä¸­ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥å°†æ¨¡æ¿æ–‡ä»¶å•ç‹¬æ”¾åœ¨ä¸åŒçš„htmlæ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥åƒä¸‹é¢è¿™æ ·ï¼Œå†…è”åœ¨htmlä¸­ï¼š 123456789&lt;script type=&quot;text/ng-template&quot; id=&quot;/pages/login.html&quot;&gt;&lt;form class=&quot;form-inline form-login&quot; ng-submit=&quot;login()&quot;&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label class=&quot;sr-only&quot;&gt;Gmail&lt;/label&gt; &lt;input type=&quot;email&quot; required class=&quot;form-control&quot; ng-model=&quot;email&quot; placeholder=&quot;Gmailè´¦å·&quot; /&gt; &lt;/div&gt; &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary btn-enter&quot;&gt;è¿›å…¥&lt;/button&gt;&lt;/form&gt;&lt;/script&gt; grunt-inline-angular-templateså°±å¯ä»¥å®ç°è¿™æ ·çš„éœ€æ±‚ï¼š 1234567891011inline_angular_templates: &#123; dist: &#123; options: &#123; base: &apos;static/&apos;, prefix: &apos;/&apos; &#125;, files: &#123; &apos;build/index.html&apos;: [&apos;static/pages/*.html&apos;] &#125; &#125;&#125; ä½¿ç”¨grunt-revï¼Œä¸ºé™æ€æ–‡ä»¶åŠ ä¸Šå”¯ä¸€æ ‡è¯†ï¼Œä½¿ç”¨grunt-contrib-cleanåœ¨æ¯æ¬¡æ‰“åŒ…å¼€å§‹æ—¶ï¼Œæ¸…é™¤.tmpå’Œbuildé‡Œçš„å†…å®¹ï¼š 1234567891011121314151617rev: &#123; options: &#123; encoding: &apos;utf8&apos;, algorithm: &apos;md5&apos;, length: 8 &#125;, assets: &#123; files: [&#123; src: [ &apos;build/**/*.&#123;jpg,jpeg,gif,png,js,css,eot,svg,ttf,woff&#125;&apos; ] &#125;] &#125;&#125;,clean: &#123; main:[&apos;.tmp&apos;, &apos;build&apos;]&#125; æœ€åï¼Œä½¿ç”¨grunt-useminæä¾›çš„task useminï¼Œå°†htmlä¸­æ ‡è®°çš„åˆå¹¶åŒºå—å·²ç»cssä¸­çš„å­—ä½“å¼•ç”¨ä½¿ç”¨buildç›®å½•ä¸­å¯¹åº”çš„å‹ç¼©åšäº†å”¯ä¸€æ ‡è®°çš„æ–‡ä»¶åæ›¿æ¢æ‰ï¼š 1234567891011grunt.registerTask(&apos;default&apos;, [ &apos;clean&apos;, &apos;copy&apos;, &apos;useminPrepare&apos;, &apos;concat&apos;, &apos;uglify&apos;, &apos;cssmin&apos;, &apos;rev&apos;, &apos;usemin&apos;, &apos;inline_angular_templates&apos;]) äºæ˜¯æˆ‘ä»¬æ•´ä¸ªæ„å»ºçš„è¿‡ç¨‹ç»“æŸäº†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½æŒ‰ç…§æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼å¤„ç†å¥½äº†ã€‚ æˆ‘ä»¬å†æ¥å›é¡¾ä¸€ä¸‹æ‰“åŒ…çš„è¿‡ç¨‹ï¼Œå¼€å§‹é‚£ä¹ˆå¤šçš„jsï¼Œé¦–å…ˆè¢«concatåˆ°äº†tmp/concat/technode.jsä¸­ï¼Œç„¶åaglifyå‹ç¼©åˆ°build/script/tecnhode.jsä¸­ï¼Œæ¥ç€revæ ¹æ®æ–‡ä»¶å†…å®¹ä¸ºå…¶ç”Ÿæˆäº†å”¯ä¸€çš„æ ‡ç¤º7add9650.technode.jsï¼Œæœ€åï¼Œuseminå†æŠŠbuild/index.htmlä¸­çš„jsåŒºå—æ¢æˆäº†&lt;script src=&quot;/script/7add9650.technode.js&quot;&gt;&lt;/script&gt;ã€‚è¿™å°±æ˜¯æˆ‘ä»¬é‡‡ç”¨çš„æ•´ä¸ªæ‰“åŒ…å‹ç¼©è¿‡ç¨‹ã€‚åŒç†cssä¹Ÿæ˜¯å¦‚æ­¤ã€‚ å‘å¸ƒTechNodeå‘å¸ƒä¹‹å‰æˆ‘ä»¬è¿˜éœ€è¦åšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦è®©ç”Ÿäº§ç¯å¢ƒä¸­è®¿é—®çš„æ˜¯æ‰“åŒ…å‹ç¼©è¿‡çš„é™æ€æ–‡ä»¶ï¼Œexpressä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„æ–¹å¼ï¼š 123456789app.configure(&apos;development&apos;, function () &#123; app.set(&apos;staticPath&apos;, &apos;/static&apos;)&#125;)app.configure(&apos;production&apos;, function () &#123; app.set(&apos;staticPath&apos;, &apos;/build&apos;)&#125;)app.use(express.static(__dirname + app.get(&apos;staticPath&apos;))) å¦‚æœæˆ‘ä»¬è¿è¡Œnode app.js expressé»˜è®¤é‡‡ç”¨çš„æ˜¯developmentç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨NODE_ENV=production node app.jsæ¥å¯ç”¨ç”Ÿäº§ç¯å¢ƒçš„é…ç½®ï¼Œæˆ‘ä»¬è¿™é‡Œçš„åšæ³•å¾ˆç®€å•ï¼Œå°†é™æ€æ–‡ä»¶çš„è·¯å¾„æŒ‡å®šåˆ°ç¼–è¯‘åçš„/buildç›®å½•å³å¯ã€‚ ä¿®æ”¹config.jsä¸­çš„MongoDBé…ç½®ï¼Œä¿®æ”¹æˆå¯¹åº”çš„ä½ åœ¨MongoHQçš„æ•°æ®åº“ï¼Œä¾‹å¦‚ï¼šmongodb://technode:technode@troup.mongohq.com:10046/technode ä¿®æ”¹å¼€å‘ç¯å¢ƒå¯¹åº”çš„Procfileæ–‡ä»¶ï¼Œæ·»åŠ web: NODE_ENV=production node app.jsï¼Œè®©TechNodeä»¥ç”Ÿäº§æ¨¡å¼å¯åŠ¨ã€‚","categories":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://sensitivemix.github.io/categories/å¼€å‘/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"https://sensitivemix.github.io/tags/Node-js/"},{"name":"Socket.io","slug":"Socket-io","permalink":"https://sensitivemix.github.io/tags/Socket-io/"}]},{"title":"å¦‚ä½•ç”¨ Node.js Clusterï¼Œç›‘å¬å¼‚å¸¸çš„é‚®ä»¶æé†’æœåŠ¡","slug":"å¦‚ä½•ç”¨ Node.js Clusterï¼Œç›‘å¬å¼‚å¸¸çš„é‚®ä»¶æé†’æœåŠ¡","date":"2017-06-11T14:24:57.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2017/06/11/å¦‚ä½•ç”¨ Node.js Clusterï¼Œç›‘å¬å¼‚å¸¸çš„é‚®ä»¶æé†’æœåŠ¡/","link":"","permalink":"https://sensitivemix.github.io/2017/06/11/å¦‚ä½•ç”¨ Node.js Clusterï¼Œç›‘å¬å¼‚å¸¸çš„é‚®ä»¶æé†’æœåŠ¡/","excerpt":"","text":"12345 __ __ __ _ __ ____ ____ ____/ /__ _____/ /_ _______/ /____ _____ ___ ____ ___ ____ _(_) / / __ \\/ __ \\/ __ / _ \\______/ ___/ / / / / ___/ __/ _ \\/ ___/_____/ _ \\/ __ `__ \\/ __ `/ / / / / / / /_/ / /_/ / __/_____/ /__/ / /_/ (__ ) /_/ __/ / /_____/ __/ / / / / / /_/ / / //_/ /_/\\____/\\__,_/\\___/ \\___/_/\\__,_/____/\\__/\\___/_/ \\___/_/ /_/ /_/\\__,_/_/_/ A module for taking advantage of the built-in cluster module in node v0.8 and above.send email if cluster exception,you will recieve a detail email about worker exception. Installation1npm install https://github.com/sunNode/node-cluster-email UsageInitialize mail plugin with the given email(s), with the given options. Options: from sender email timeout sendmail timeout in milliseconds subject defaulting to â€œcluster({worker}) exception: {message}â€ template function called with local variables (usually jade / ejs template etc) Example12345678910111213141516171819202122232425262728const cluster = require('cluster')const cpu = require ('os').cpus().lengthconst mail = require('node-cluster-mail')/** * [if description] * @param &#123;[type]&#125; cluster.isMaster [description] * @return &#123;[type]&#125; [description] */if (cluster.isMaster) &#123; // Fork workers. for (let i = 0; i &lt; cpu; i++) &#123; cluster.fork(); &#125; cluster.on('exit', function(worker, code, signal) &#123; mail('phonenix@gmail.com',&#123;'from':'phonenix-test@gmail.com','cc':'phonenix-test2@gmail.com'&#125;) console.log('worker ' + worker.process.pid + ' died'); &#125;); cluster.on('fork', function(worker) &#123; console.log(`workers: $&#123;worker.id&#125; worker.process.pid :$&#123;worker.process.pid&#125;`)&#125;);&#125; else &#123; // Workers can share any TCP connection // In this service its a restify server require('./app')&#125; Referencenode-cluster-email","categories":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://sensitivemix.github.io/categories/å¼€å‘/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"https://sensitivemix.github.io/tags/Node-js/"},{"name":"Cluster","slug":"Cluster","permalink":"https://sensitivemix.github.io/tags/Cluster/"}]},{"title":"åŸºäº Node.js æ„å»ºå¾®æœåŠ¡ä¸­çš„ MockService","slug":"åŸºäº Node.js æ„å»ºå¾®æœåŠ¡ä¸­çš„ MockService","date":"2017-06-11T14:23:55.000Z","updated":"2019-04-14T02:29:42.000Z","comments":true,"path":"2017/06/11/åŸºäº Node.js æ„å»ºå¾®æœåŠ¡ä¸­çš„ MockService/","link":"","permalink":"https://sensitivemix.github.io/2017/06/11/åŸºäº Node.js æ„å»ºå¾®æœåŠ¡ä¸­çš„ MockService/","excerpt":"","text":"ç¼˜èµ·ç”±äºç°åœ¨å¾®æœåŠ¡è¶Šæ¥è¶Šç«äº†ï¼Œè¶Šæ¥è¶Šå¤šçš„å¾®æœåŠ¡èå…¥åˆ°äº†æ—¥å¸¸å¼€å‘å½“ä¸­ã€‚åœ¨å¼€å‘å¾®æœåŠ¡çš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ç”±äºä¾èµ–äºå…¶ä»–æœåŠ¡ï¼Œå¯¼è‡´ä½ çš„è¿›åº¦å—åˆ°é˜»ç¢ã€‚ä½¿ä½ ä¸å¾—ä¸å…ˆmockå‡ºä½ æœŸæœ›è°ƒç”¨ä¾èµ–æœåŠ¡çš„è¾“å‡ºï¼Œæ¥ç»§ç»­è¿­ä»£å¼€å‘ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹æˆ‘ä»¬å†™åœ¨æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡ä¸­ï¼Œå› ä¸ºè¿™æ ·æ–¹ä¾¿çœäº‹ï¼Œä½†æ˜¯éšç€éœ€è¦mockçš„æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œä¼šå‘ç°è¶Šæ¥è¶Šéš¾ç®¡ç†ï¼Œå¼€å‘é‡æ„æˆæœ¬å˜é«˜ï¼Œäºæ˜¯åœ¨æ­¤åŸºç¡€ä¸Šå°è£…äº†ä¸€ä¸ªåŸºäºNode.jså¯ä»¥æ ¹æ®é…ç½®æ–‡ä»¶ç”ŸæˆMockæœåŠ¡ã€‚ ç¼˜ç”Ÿä¸ºäº†æ–¹ä¾¿æ·»åŠ å’Œåˆ é™¤ä¸åŒçš„mockæœåŠ¡ï¼Œå°†æ‰€æœ‰çš„mockæœåŠ¡å†™å…¥äº†é…ç½®æ–‡ä»¶ï¼Œä½ å¯ä»¥æ ¹æ®ä½ æ‰€å®šä¹‰çš„é…ç½®æ–‡ä»¶ç”ŸæˆmockæœåŠ¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314151617181920212223242526&#123; 'PATH':'./src/mocks', 'PORT':'9001', \"SERVICES\":[ &#123; \"name\": \"authorization\", \"Handlers\": [ &#123; \"method\": \"GET\", \"resHeader\": \"HTTP/1.1 200 OK\", \"resContent\": \"&#123; succeed: true,msg: ok &#125;\" &#125;, &#123; \"method\": \"POST\", \"resHeader\": \"HTTP/1.1 200 OK\", \"resContent\": \"&#123; succeed: true,msg: ok &#125;\" &#125;, &#123; \"method\": \"GET--a=b.mock\", \"resHeader\": \"HTTP/1.1 200 OK\", \"resContent\": \"&#123; succeed: true,msg: ok &#125;\" &#125; ] &#125; ]&#125; Options: method Request Method GET--a=b.mock Request GET /hello?a=b resHeader Response Header resContent Response Content npm run mock Generate Mock Server npm run clean Clean Mock Server é…ç½®æ–‡ä»¶ä¸­çš„PATHæ˜¯ä½ å­˜æ”¾çš„æ‰€æœ‰mockæœåŠ¡æ–‡ä»¶å¤¹ï¼Œå¡«å…¥è¯·æ±‚çš„æ–¹å¼ï¼Œä»¥åŠæœŸæœ›çš„è®¿é—®çš„HTTPçŠ¶æ€å’Œè¿”å›å€¼ã€‚å¯åŠ¨mockæœåŠ¡å™¨ï¼Œä¸€ä¸ªç®€å•çš„mockæœåŠ¡å°±ç”Ÿæˆäº†ã€‚ä¿®æ”¹æ–‡ä»¶é…ç½®ä»¥åï¼Œå¯ä»¥æ¸…ç†ç”Ÿæˆçš„mockæœåŠ¡é‡æ–°ç”Ÿæˆã€‚ é¡¹ç›®ç»“æ„ å¯åŠ¨æˆªå›¾ ç”ŸæˆæˆåŠŸ æ¸…ç†æˆªå›¾ é¡¹ç›®åœ°å€ node-mock-factory","categories":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://sensitivemix.github.io/categories/å¼€å‘/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"https://sensitivemix.github.io/tags/Node-js/"},{"name":"MockService","slug":"MockService","permalink":"https://sensitivemix.github.io/tags/MockService/"}]}]}